<!DOCTYPE html>
<html lang="en">
  <head>
    <title>115714 &ndash; NullPointerException in Hashtable caused by FileBufferModelManager releaseModel</title>

      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<link href="https://bugs.eclipse.org/bugs/data/assets/03c4bb46b12126a79867f9a9f5323634.css?1593441374" rel="stylesheet" type="text/css">



    
<script type="text/javascript" src="https://bugs.eclipse.org/bugs/data/assets/a7c2f3a028f17a9aa60f56dc9d6e732d.js?1593441374"></script>

    <script type="text/javascript">
    <!--
        YAHOO.namespace('bugzilla');
        YAHOO.util.Event.addListener = function (el, sType, fn, obj, overrideContext) {
               if ( ("onpagehide" in window || YAHOO.env.ua.gecko) && sType === "unload") { sType = "pagehide"; };
               var capture = ((sType == "focusin" || sType == "focusout") && !YAHOO.env.ua.ie) ? true : false;
               return this._addListener(el, this._getType(sType), fn, obj, overrideContext, capture);
         };
        if ( "onpagehide" in window || YAHOO.env.ua.gecko) {
            YAHOO.util.Event._simpleRemove(window, "unload", 
                                           YAHOO.util.Event._unload);
        }
        
        function unhide_language_selector() { 
            YAHOO.util.Dom.removeClass(
                'lang_links_container', 'bz_default_hidden'
            ); 
        } 
        YAHOO.util.Event.onDOMReady(unhide_language_selector);

        
        var BUGZILLA = {
            param: {
                cookiepath: '\/bugs',
                maxusermatches: 10
            },
            constant: {
                COMMENT_COLS: 80
            },
            string: {
                

                attach_desc_required:
                    "You must enter a Description for this attachment.",
                component_required:
                    "You must select a Component for this bug.",
                description_required:
                    "You must enter a Description for this bug.",
                short_desc_required:
                    "You must enter a Summary for this bug.",
                version_required:
                    "You must select a Version for this bug."
            }
              , api_token: ''
        };

    if (history && history.replaceState) {
      if(!document.location.href.match(/show_bug\.cgi/)) {
        history.replaceState( null,
                             "115714 – NullPointerException in Hashtable caused by FileBufferModelManager releaseModel",
                             "show_bug.cgi?id=115714" );
        document.title = "115714 – NullPointerException in Hashtable caused by FileBufferModelManager releaseModel";
      }
      if (document.location.href.match(/show_bug\.cgi\?.*list_id=/)) {
        var href = document.location.href;
        href = href.replace(/[\?&]+list_id=(\d+|cookie)/, '');
        history.replaceState(null, "115714 – NullPointerException in Hashtable caused by FileBufferModelManager releaseModel", href);
      }
    }
    YAHOO.util.Event.onDOMReady(function() {
      initDirtyFieldTracking();

    });
    // -->
    </script>
<script type="text/javascript" src="https://bugs.eclipse.org/bugs/data/assets/daf5e0fb6826e6a35280e622913f0c4a.js?1593441374"></script>

    

    
    <link rel="search" type="application/opensearchdescription+xml"
                       title="Bugzilla" href="./search_plugin.cgi">
    <link rel="shortcut icon" href="images/favicon.ico">
  </head>

  <body 
        class="bugs-eclipse-org-bugs
                 bz_bug
                 bz_status_RESOLVED
                 bz_product_WTP_Source_Editing
                 bz_component_wst.sse
                 bz_bug_115714 yui-skin-sam">

  <div id="header"><!-- 1.0@bugzilla.org -->





<!--  START OF SOLSTICE HEADER -->
 <link rel="stylesheet" type="text/css" href="https://www.eclipse.org/eclipse.org-common/themes/solstice/public/stylesheets/vendor/cookieconsent/cookieconsent.min.css" />
 <script src="https://www.eclipse.org/eclipse.org-common/themes/solstice/public/javascript/vendor/cookieconsent/default.min.js"></script>
 <style type="text/css">
    @import url('https://www.eclipse.org/eclipse.org-common/themes/solstice/public/stylesheets/barebone.min.css')
    </style>
    <script
      src="https://www.eclipse.org/eclipse.org-common/themes/solstice/public/javascript/barebone.min.js">
    </script><header role="banner" class="barebone-layout thin-header padding-top-5 padding-bottom-5"  id="header-wrapper">
  <div class="container-fluid reset">
    <div class="row-fluid" id="header-row">
            <div class="col-sm-8 col-md-6 col-lg-4" id="header-left">
        <div class="wrapper-logo-default"><a href="https://www.eclipse.org/"><img class="logo-eclipse-default img-responsive hidden-xs" alt="logo" src="https://bugs.eclipse.org/eclipse.org-common/themes/solstice/public/images/logo/eclipse-426x100.png"/></a></div>
      </div>            <div class="col-sm-16 col-md-18 col-lg-20" id="main-menu-wrapper">
  <div class="navbar yamm" id="main-menu">
    <div id="navbar-collapse-1" class="navbar-collapse collapse">
      <ul class="nav navbar-nav navbar-right">
        <li class="visible-thin"><a href="https://www.eclipse.org/downloads/" target="_self">Download</a></li><li><a href="https://www.eclipse.org/users/" target="_self">Getting Started</a></li><li><a href="https://www.eclipse.org/membership/" target="_self">Members</a></li><li><a href="https://www.eclipse.org/projects/" target="_self">Projects</a></li>                  <li class="dropdown visible-xs"><a href="#" data-toggle="dropdown" class="dropdown-toggle">Community <b class="caret"></b></a><ul class="dropdown-menu"><li><a href="http://marketplace.eclipse.org">Marketplace</a></li><li><a href="http://events.eclipse.org">Events</a></li><li><a href="http://www.planeteclipse.org/">Planet Eclipse</a></li><li><a href="https://www.eclipse.org/community/eclipse_newsletter/">Newsletter</a></li><li><a href="https://www.youtube.com/user/EclipseFdn">Videos</a></li></ul></li><li class="dropdown visible-xs"><a href="#" data-toggle="dropdown" class="dropdown-toggle">Participate <b class="caret"></b></a><ul class="dropdown-menu"><li><a href="https://bugs.eclipse.org/bugs/">Report a Bug</a></li><li><a href="https://www.eclipse.org/forums/">Forums</a></li><li><a href="https://www.eclipse.org/mail/">Mailing Lists</a></li><li><a href="https://wiki.eclipse.org/">Wiki</a></li><li><a href="https://wiki.eclipse.org/IRC">IRC</a></li><li><a href="https://www.eclipse.org/contribute/">How to Contribute</a></li></ul></li><li class="dropdown visible-xs"><a href="#" data-toggle="dropdown" class="dropdown-toggle">Working Groups <b class="caret"></b></a><ul class="dropdown-menu"><li><a href="http://wiki.eclipse.org/Auto_IWG">Automotive</a></li><li><a href="http://iot.eclipse.org">Internet of Things</a></li><li><a href="http://locationtech.org">LocationTech</a></li><li><a href="http://lts.eclipse.org">Long-Term Support</a></li><li><a href="http://polarsys.org">PolarSys</a></li><li><a href="http://science.eclipse.org">Science</a></li><li><a href="http://www.openmdm.org">OpenMDM</a></li></ul></li>          <!-- More -->
          <li class="dropdown eclipse-more hidden-xs">
            <a data-toggle="dropdown" class="dropdown-toggle">More<b class="caret"></b></a>
            <ul class="dropdown-menu">
              <li>
                <!-- Content container to add padding -->
                <div class="yamm-content">
                  <div class="row">
                    <ul class="col-sm-8 list-unstyled"><li><p><strong>Community</strong></p></li><li><a href="http://marketplace.eclipse.org">Marketplace</a></li><li><a href="http://events.eclipse.org">Events</a></li><li><a href="http://www.planeteclipse.org/">Planet Eclipse</a></li><li><a href="https://www.eclipse.org/community/eclipse_newsletter/">Newsletter</a></li><li><a href="https://www.youtube.com/user/EclipseFdn">Videos</a></li></ul><ul class="col-sm-8 list-unstyled"><li><p><strong>Participate</strong></p></li><li><a href="https://bugs.eclipse.org/bugs/">Report a Bug</a></li><li><a href="https://www.eclipse.org/forums/">Forums</a></li><li><a href="https://www.eclipse.org/mail/">Mailing Lists</a></li><li><a href="https://wiki.eclipse.org/">Wiki</a></li><li><a href="https://wiki.eclipse.org/IRC">IRC</a></li><li><a href="https://www.eclipse.org/contribute/">How to Contribute</a></li></ul><ul class="col-sm-8 list-unstyled"><li><p><strong>Working Groups</strong></p></li><li><a href="http://wiki.eclipse.org/Auto_IWG">Automotive</a></li><li><a href="http://iot.eclipse.org">Internet of Things</a></li><li><a href="http://locationtech.org">LocationTech</a></li><li><a href="http://lts.eclipse.org">Long-Term Support</a></li><li><a href="http://polarsys.org">PolarSys</a></li><li><a href="http://science.eclipse.org">Science</a></li><li><a href="http://www.openmdm.org">OpenMDM</a></li></ul>                  </div>
                </div>
              </li>
            </ul>
          </li>
              </ul>
    </div>
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar-collapse-1">
      <span class="sr-only">Toggle navigation</span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      </button>
      <div class="wrapper-logo-mobile"><a class="navbar-brand visible-xs" href="https://www.eclipse.org/"><img class="logo-eclipse-default-mobile img-responsive" alt="logo" src="https://bugs.eclipse.org/eclipse.org-common/themes/solstice/public/images/logo/eclipse-800x188.png"/></a></div>    </div>
  </div>
</div>
    </div>
  </div>
</header>
<!--  END OF SOLSTICE HEADER -->

    <div id="titles">
      <span id="title">Bugzilla &ndash; Bug&nbsp;115714</span>

        <span id="subtitle" class="subheader">NullPointerException in Hashtable caused by FileBufferModelManager releaseModel</span>

        <span id="information" class="header_addl_info">Last modified: 2009-04-19 23:32:31 EDT</span>
    </div>


    <div id="common_links"><ul class="links">
  <li><a href="./">Home</a></li>
  <li><span class="separator">| </span><a href="enter_bug.cgi">New</a></li>
  <li><span class="separator">| </span><a href="describecomponents.cgi">Browse</a></li>
  <li><span class="separator">| </span><a href="query.cgi">Search</a></li>

  <li class="form">
    <span class="separator">| </span>
    <form action="buglist.cgi" method="get"
        onsubmit="if (this.quicksearch.value == '')
                  { alert('Please enter one or more search terms first.');
                    return false; } return true;">
    <input type="hidden" id="no_redirect_top" name="no_redirect" value="0">
    <script type="text/javascript">
      if (history && history.replaceState) {
        var no_redirect = document.getElementById("no_redirect_top");
        no_redirect.value = 1;
      }
    </script>
    <input class="txt" type="text" id="quicksearch_top" name="quicksearch" 
           title="Quick Search" value="">
    <input class="btn" type="submit" value="Search" 
           id="find_top"></form>
  <a href="page.cgi?id=quicksearch.html" title="Quicksearch Help">[?]</a></li>

  <li><span class="separator">| </span><a href="report.cgi">Reports</a></li>

  <li>
      <span class="separator">| </span>
        <a href="request.cgi">Requests</a></li>


  <li>
        <span class="separator">| </span>
        <a href="https://bugzilla.readthedocs.org/en/5.0/using/understanding.html" target="_blank">Help</a>
      </li>
    

    <li id="mini_login_container_top">
  <span class="separator">| </span>
  <a id="login_link_top" href="show_bug.cgi?id=115714&amp;GoAheadAndLogIn=1"
     onclick="return show_mini_login_form('_top')">Log In</a>

  <form action="show_bug.cgi?id=115714" method="POST"
        class="mini_login bz_default_hidden"
        id="mini_login_top">
    <input id="Bugzilla_login_top" required
           name="Bugzilla_login" class="bz_login"
        placeholder="Login">
    <input class="bz_password" name="Bugzilla_password" type="password"
           id="Bugzilla_password_top" required
           placeholder="Password">
    <input type="hidden" name="Bugzilla_login_token"
           value="">
    <input type="submit" name="GoAheadAndLogIn" value="Log in"
            id="log_in_top">
    <a href="#" onclick="return hide_mini_login_form('_top')">[x]</a>
  </form>
</li>
  <span class="separator">| </span>
  <li><a href="http://www.eclipse.org/legal/termsofuse.php">Terms of Use</a></li>
  <span class="separator">| </span>
  <li><a href="http://www.eclipse.org/legal/copyright.php">Copyright Agent</a></li>
</ul>
    </div>
  </div>

  <div id="bugzilla-body">


<script type="text/javascript">
<!--

//-->
</script>

<form name="changeform" id="changeform" method="post" action="process_bug.cgi">

  <input type="hidden" name="delta_ts" value="2009-04-19 23:32:31">
  <input type="hidden" name="id" value="115714">
  <input type="hidden" name="token" value="1629864285-_uITWbtsn-HI-x_F7GWmmsRourkJX8fLP1ekoQJ0lVY">
<div class="bz_short_desc_container edit_form">
     <a href="show_bug.cgi?id=115714"><b>Bug&nbsp;115714</b></a> <span id="summary_container" class="bz_default_hidden">
      - <span id="short_desc_nonedit_display">NullPointerException in Hashtable caused by FileBufferModelManager releaseModel</span>
     </span>

    <div id="summary_input"><span class="field_label "
    id="field_label_short_desc">


  <a 
      title="The bug summary is a short sentence which succinctly describes what the bug is about."
      class="field_help_link"
      href="page.cgi?id=fields.html#short_desc"
  >Summary:</a>

</span>NullPointerException in Hashtable caused by FileBufferModelManager releaseModel
    </div>
  </div>
  <script type="text/javascript">
    hideEditableField('summary_container',
                      'summary_input',
                      'summary_edit_action',
                      'short_desc',
                      'NullPointerException in Hashtable caused by FileBufferModelManager releaseModel' );
  </script>
  <table class="edit_form">
    <tr>
      
      <td id="bz_show_bug_column_1" class="bz_show_bug_column">     
        <table>
          <tr>
    <th class="field_label">
      <a href="page.cgi?id=fields.html#bug_status">Status</a>:
    </th>
    <td id="bz_field_status">
      <span id="static_bug_status">RESOLVED
          WORKSFORME
      </span>
    </td>
  </tr>
<tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
<tr><th class="field_label "
    id="field_label_alias">


  <a 
      title="A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla."
      class="field_help_link"
      href="page.cgi?id=fields.html#alias"
  >Alias:</a>

</th>
    <td>
        None
    </td>
  </tr>
<tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
<tr><th class="field_label "
    id="field_label_product">


  <a 
      title="Bugs are categorised into Products and Components. Select a Classification to narrow down this list."
      class="field_help_link"
      href="describecomponents.cgi"
  >Product:</a>

</th>
  <td class="field_value "
      id="field_container_product" >WTP Source Editing

</td>
    </tr>

    
    <tr class="bz_default_hidden"><th class="field_label "
    id="field_label_classification">


  <a 
      title="Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation."
      class="field_help_link"
      href="page.cgi?id=fields.html#classification"
  >Classification:</a>

</th>
  <td class="field_value "
      id="field_container_classification" >WebTools

</td>
    </tr>
        
    
    
    <tr><th class="field_label "
    id="field_label_component">


  <a 
      title="Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list."
      class="field_help_link"
      href="describecomponents.cgi?product=WTP Source Editing"
  >Component:</a>

</th>
  <td class="field_value "
      id="field_container_component" >wst.sse

  (<a href="buglist.cgi?component=wst.sse&amp;product=WTP%20Source%20Editing&amp;bug_status=__open__"
      target="_blank">show other bugs</a>)
</td>
    </tr>
    <tr><th class="field_label "
    id="field_label_version">


  <a 
      title="The version field defines the version of the software the bug was found in."
      class="field_help_link"
      href="page.cgi?id=fields.html#version"
  >Version:</a>

</th>

      <td>0.7 &#160; <a href="https://dev.eclipse.org/committers/bugs/bugz_manager.php"><img src="//dev.eclipse.org/small_icons/apps/accessories-text-editor.png" alt="Edit" title="Edit these values" /></a></td>
    </tr>
        
    
        
    <tr><th class="field_label "
    id="field_label_rep_platform">


  <a 
      title="The hardware platform the bug was observed on. Note: When searching, selecting the option &quot;All&quot; only finds bugs whose value for this field is literally the word &quot;All&quot;."
      class="field_help_link"
      href="page.cgi?id=fields.html#rep_platform"
  >Hardware:</a>

</th>
      <td class="field_value">PC
        Windows XP
      </td>
    </tr>
          <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
          
          <tr>
      <th class="field_label">
        <label  accesskey="i">
          <a href="page.cgi?id=fields.html#importance"><u>I</u>mportance</a></label>:
      </th>
      <td>P3
       major<span id="votes_container">
    (<a href="page.cgi?id=voting/user.html&amp;bug_id=115714#vote_115714">vote</a>)
  </span>
      </td>
    </tr>

      <tr><th class="field_label "
    id="field_label_target_milestone">


  <a 
      title="The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it."
      class="field_help_link"
      href="page.cgi?id=fields.html#target_milestone"
  >Target Milestone:</a>

</th>
        <td>--- &#160; <a href="https://dev.eclipse.org/committers/bugs/bugz_manager.php"><img src="//dev.eclipse.org/small_icons/apps/accessories-text-editor.png" alt="Edit" title="Edit these values" /></a></td>
      </tr>
          
          <tr><th class="field_label "
    id="field_label_assigned_to">


  <a 
      title="The person in charge of resolving the bug."
      class="field_help_link"
      href="page.cgi?id=fields.html#assigned_to"
  >Assignee:</a>

</th>
      <td><span class="vcard"><span class="fn">Nitin Dahyabhai</span> <a href="http://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=thatnitind&#64;gmail.com" alt="CLA" title="Eclipse Contributor Agreement" /></a> <a href="https://eclipse.org/donate/"><img class="cla_dec" src="//www.eclipse.org/donate/web-api/friends_decorator.php?email=thatnitind&#64;gmail.com" alt="Friend" title="Friend of Eclipse" /></a>
</span>
      </td>
    </tr>

    <tr><th class="field_label "
    id="field_label_qa_contact">


  <a 
      title="The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved."
      class="field_help_link"
      href="page.cgi?id=fields.html#qa_contact"
  >QA Contact:</a>

</th>
      <td><span class="vcard">
</span>
      </td>
    </tr>
    <script type="text/javascript">
      assignToDefaultOnChange(['product', 'component'],
        'wst.sse-inbox\x40eclipse.org',
        'thatnitind\x40gmail.com');
    </script>
          <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
          <tr><th class="field_label "
    id="field_label_bug_file_loc">


  <a 
      title="Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen."
      class="field_help_link"
      href="page.cgi?id=fields.html#bug_file_loc"
  >URL:</a>

</th>
    <td>
      <span id="bz_url_input_area">
      </span>
    </td>
  </tr>

    <tr><th class="field_label "
    id="field_label_status_whiteboard">


  <a 
      title="Each bug has a free-form single line text entry box for adding tags and status information."
      class="field_help_link"
      href="page.cgi?id=fields.html#status_whiteboard"
  >Whiteboard:</a>

</th><td>  
  </td>
    </tr>

    <tr><th class="field_label "
    id="field_label_keywords">


  <a 
      title="You can add keywords from a defined list to bugs, in order to easily identify and group them."
      class="field_help_link"
      href="describekeywords.cgi"
  >Keywords:</a>

</th>
  <td class="field_value "
      id="field_container_keywords" >helpwanted

</td>
    </tr>
          <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>

          <tr>
    <th class="field_label">
      <label>Duplicates (1)</label>:
    </th>
    <td class="field_value">
      <span id="duplicates"><a class="bz_bug_link 
          bz_status_CLOSED  bz_closed"
   title="CLOSED DUPLICATE - release being called without get?"
   href="show_bug.cgi?id=102223">102223</a> 
      </span>
      (<a href="buglist.cgi?bug_id=102223">view as bug list</a>)
    </td>
  </tr>
<tr><th class="field_label "
    id="field_label_dependson">


  <a 
      title="The bugs listed here must be resolved before this bug can be resolved."
      class="field_help_link"
      href="page.cgi?id=fields.html#dependson"
  >Depends on:</a>

</th>

  <td>
    <span id="dependson_input_area">
    </span>

  </td>
  </tr>
  
  <tr><th class="field_label "
    id="field_label_blocked">


  <a 
      title="This bug must be resolved before the bugs listed in this field can be resolved."
      class="field_help_link"
      href="page.cgi?id=fields.html#blocked"
  >Blocks:</a>

</th>

  <td>
    <span id="blocked_input_area">
    </span>

  </td>
  </tr>
          
        </table>
      </td>
      <td>
        <div class="bz_column_spacer">&nbsp;</div>
      </td>
      
      <td id="bz_show_bug_column_2" class="bz_show_bug_column">
        <table>
        <tr>
    <th class="field_label">
      Reported:
    </th>
    <td>2005-11-09 17:37 EST by <span class="vcard"><span class="fn">Scott Ellis</span> <a href="http://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=sellis&#64;bea.com" alt="CLA" title="Eclipse Contributor Agreement" /></a> <a href="https://eclipse.org/donate/"><img class="cla_dec" src="//www.eclipse.org/donate/web-api/friends_decorator.php?email=sellis&#64;bea.com" alt="Friend" title="Friend of Eclipse" /></a>
</span>
    </td>
  </tr>
  
  <tr>
    <th class="field_label">
      Modified:
    </th>
    <td>2009-04-19 23:32 EDT
      (<a href="show_activity.cgi?id=115714">History</a>)
    </td>
  
  </tr>
<tr>
      <th class="field_label">
        <label  accesskey="a">
          CC List:
        </label>
      </th>
      <td>4 
          users
          <span id="cc_edit_area_showhide_container" class="bz_default_hidden">
            (<a href="#" id="cc_edit_area_showhide">show</a>)
          </span>
        <div id="cc_edit_area">
          <br>
            <select id="cc" multiple="multiple" size="5" >
                <option value="david_williams">david_williams</option>
                <option value="jhouston.mail">jhouston.mail</option>
                <option value="stammt">stammt</option>
                <option value="thatnitind">thatnitind</option>
            </select>
        </div>
          <script type="text/javascript">
            hideEditableField( 'cc_edit_area_showhide_container', 
                               'cc_edit_area', 
                               'cc_edit_area_showhide', 
                               '', 
                               '');  
          </script>
      </td>
    </tr>

<tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
<tr><th class="field_label "
    id="field_label_see_also">


  <a 
      title="This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields."
      class="field_help_link"
      href="page.cgi?id=fields.html#see_also"
  >See Also:</a>

</th>
  <td class="field_value "
      id="field_container_see_also" >

</td>
    </tr> 

<tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>



        </table>
      </td>
    </tr>
    <tr>
      <td colspan="3">
          <hr id="bz_top_half_spacer">
      </td>
    </tr>
  </table>

  <table id="bz_big_form_parts">
  <tr>
  <td>

    
<script type="text/javascript">
<!--
function toggle_display(link) {
    var table = document.getElementById("attachment_table");
    var view_all = document.getElementById("view_all");
    var hide_obsolete_url_parameter = "&hide_obsolete=1";
    // Store current height for scrolling later
    var originalHeight = table.offsetHeight;
    var rows = YAHOO.util.Dom.getElementsByClassName(
        'bz_tr_obsolete', 'tr', table);

    for (var i = 0; i < rows.length; i++) {
        bz_toggleClass(rows[i], 'bz_default_hidden');
    }

    if (YAHOO.util.Dom.hasClass(rows[0], 'bz_default_hidden')) {
        link.innerHTML = "Show Obsolete";
        view_all.href = view_all.href + hide_obsolete_url_parameter 
    }
    else {
        link.innerHTML = "Hide Obsolete";
        view_all.href = view_all.href.replace(hide_obsolete_url_parameter,"");
    }

    var newHeight = table.offsetHeight;
    // This scrolling makes the window appear to not move at all.
    window.scrollBy(0, newHeight - originalHeight);

    return false;
}
//-->
</script>

<br>
<table id="attachment_table">
  <tr id="a0">
    <th colspan="3" class="left">
      Attachments
    </th>
  </tr>



  <tr class="bz_attach_footer">
    <td colspan="3">
        <a href="attachment.cgi?bugid=115714&amp;action=enter">Add an attachment</a>
        (proposed patch, testcase, etc.)
    </td>
  </tr>
</table>
<br>
<div id="add_comment" class="bz_section_additional_comments">
      <table>
        <tr>
          <td>
            <fieldset>
              <legend>Note</legend>
              You need to
              <a href="show_bug.cgi?id=115714&amp;GoAheadAndLogIn=1">log in</a>
              before you can comment on or make changes to this bug.
            </fieldset>
          </td>
        </tr> 
      </table>
  </div>
  </td>
  <td>
  </td>
  </tr></table>

  
  <div id="comments"><script src="https://bugs.eclipse.org/bugs/js/comments.js?1463425338" type="text/javascript">
</script>

<script type="text/javascript">
<!--
  /* Adds the reply text to the 'comment' textarea */
  function replyToComment(id, real_id, name) {
      var prefix = "(In reply to " + name + " from comment #" + id + ")\n";
      var replytext = "";
        /* pre id="comment_name_N" */
        var text_elem = document.getElementById('comment_text_'+id);
        var text = getText(text_elem);
        replytext = prefix + wrapReplyText(text);


      /* <textarea id="comment"> */
      var textarea = document.getElementById('comment');
      if (textarea.value != replytext) {
          textarea.value += replytext;
      }

      textarea.focus();
  } 
//-->
</script>


<!-- This auto-sizes the comments and positions the collapse/expand links 
     to the right. -->
<table class="bz_comment_table">
<tr>
<td>
<div id="c0" class="bz_comment bz_first_comment">

      <div class="bz_first_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=115714#c0">Description</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Scott Ellis</span> <a href="http://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=sellis&#64;bea.com" alt="CLA" title="Eclipse Contributor Agreement" /></a> <a href="https://eclipse.org/donate/"><img class="cla_dec" src="//www.eclipse.org/donate/web-api/friends_decorator.php?email=sellis&#64;bea.com" alt="Friend" title="Friend of Eclipse" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2005-11-09 17:37:48 EST
        </span>

      </div>




<pre class="bz_comment_text">We saw the following NPE during a run of bea internal tests.



     [java] !ENTRY org.eclipse.jst.jsp.core 4 4 2005-11-09 12:48:45.469
     [java] !MESSAGE JSPIndexer problem
indexing:/customerCareWebProject/web/customerManagementPageFlow/customers.jsp
     [java] !STACK 0
     [java] java.lang.NullPointerException
     [java] 	at
java.util.Hashtable.get(Ljava.lang.Object;)Ljava.lang.Object;(Unknown Source)
     [java] 	at
org.eclipse.wst.sse.core.internal.FileBufferModelManager.releaseModel(FileBufferModelManager.java:597)
     [java] 	at
org.eclipse.wst.sse.core.internal.model.ModelManagerImpl.discardModel(ModelManagerImpl.java:1370)
     [java] 	at
org.eclipse.wst.sse.core.internal.model.ModelManagerImpl.releaseFromRead(ModelManagerImpl.java:1397)
     [java] 	at
org.eclipse.wst.sse.core.internal.model.AbstractStructuredModel.releaseFromRead(AbstractStructuredModel.java:1067)
     [java] 	at
org.eclipse.wst.xml.core.internal.document.DOMModelImpl.releaseFromRead(DOMModelImpl.java:806)
     [java] 	at
org.eclipse.wst.html.core.internal.document.DOMStyleModelImpl.releaseFromRead(DOMStyleModelImpl.java:44)
     [java] 	at
org.eclipse.jst.jsp.core.internal.java.search.JSPSearchDocument.getJSPTranslation(JSPSearchDocument.java:128)
     [java] 	at
org.eclipse.jst.jsp.core.internal.java.search.JSPSearchDocument.getPath(JSPSearchDocument.java:149)
     [java] 	at
org.eclipse.jst.jsp.core.internal.java.search.JavaSearchDocumentDelegate.&lt;init&gt;(JavaSearchDocumentDelegate.java:30)
     [java] 	at
org.eclipse.jst.jsp.core.internal.java.search.JSPSearchSupport.createSearchDocument(JSPSearchSupport.java:426)
     [java] 	at
org.eclipse.jst.jsp.core.internal.java.search.JSPSearchSupport.addJspFile(JSPSearchSupport.java:320)
     [java] 	at
org.eclipse.jst.jsp.core.internal.java.search.JSPIndexManager$ProcessFilesJob.run(JSPIndexManager.java:251)
     [java] 	at org.eclipse.core.internal.jobs.Worker.run(Worker.java:76)</pre>
    </div>

    <div id="c1" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=115714#c1">Comment 1</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Nitin Dahyabhai</span> <a href="http://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=thatnitind&#64;gmail.com" alt="CLA" title="Eclipse Contributor Agreement" /></a> <a href="https://eclipse.org/donate/"><img class="cla_dec" src="//www.eclipse.org/donate/web-api/friends_decorator.php?email=thatnitind&#64;gmail.com" alt="Friend" title="Friend of Eclipse" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2005-11-10 00:57:29 EST
        </span>

      </div>




<pre class="bz_comment_text">Were there other files or Jobs running?  Does it happen consistently?  Is this
reproducable with the latest integration build?</pre>
    </div>

    <div id="c2" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=115714#c2">Comment 2</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Scott Ellis</span> <a href="http://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=sellis&#64;bea.com" alt="CLA" title="Eclipse Contributor Agreement" /></a> <a href="https://eclipse.org/donate/"><img class="cla_dec" src="//www.eclipse.org/donate/web-api/friends_decorator.php?email=sellis&#64;bea.com" alt="Friend" title="Friend of Eclipse" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2005-11-10 13:59:17 EST
        </span>

      </div>




<pre class="bz_comment_text">1. Were there other files or Jobs running?  
Sorry, we don't know

2. Does it happen consistently?  
No.

3. Is this reproducable with the latest integration build?
Again sorry, we don't know yet



After the initial NPE, there were all sorts of other problems, probably all
related to the first NPE. However for completeness I will list them all here:

first the npe:
     [java] !ENTRY org.eclipse.jst.jsp.core 4 4 2005-11-09 12:48:45.469
     [java] !MESSAGE JSPIndexer problem
indexing:/customerCareWebProject/web/customerManagementPageFlow/customers.jsp
     [java] !STACK 0
     [java] java.lang.NullPointerException
     [java]     at
java.util.Hashtable.get(Ljava.lang.Object;)Ljava.lang.Object;(Unknown Source)
     [java]     at
org.eclipse.wst.sse.core.internal.FileBufferModelManager.releaseModel(FileBufferModelManager.java:597)
     [java]     at
org.eclipse.wst.sse.core.internal.model.ModelManagerImpl.discardModel(ModelManagerImpl.java:1370)
     [java]     at
org.eclipse.wst.sse.core.internal.model.ModelManagerImpl.releaseFromRead(ModelManagerImpl.java:1397)
     [java]     at
org.eclipse.wst.sse.core.internal.model.AbstractStructuredModel.releaseFromRead(AbstractStructuredModel.java:1067)
     [java]     at
org.eclipse.wst.xml.core.internal.document.DOMModelImpl.releaseFromRead(DOMModelImpl.java:806)
     [java]     at
org.eclipse.wst.html.core.internal.document.DOMStyleModelImpl.releaseFromRead(DOMStyleModelImpl.java:44)
     [java]     at
org.eclipse.jst.jsp.core.internal.java.search.JSPSearchDocument.getJSPTranslation(JSPSearchDocument.java:128)
     [java]     at
org.eclipse.jst.jsp.core.internal.java.search.JSPSearchDocument.getPath(JSPSearchDocument.java:149)
     [java]     at
org.eclipse.jst.jsp.core.internal.java.search.JavaSearchDocumentDelegate.&lt;init&gt;(JavaSearchDocumentDelegate.java:30)
     [java]     at
org.eclipse.jst.jsp.core.internal.java.search.JSPSearchSupport.createSearchDocument(JSPSearchSupport.java:426)
     [java]     at
org.eclipse.jst.jsp.core.internal.java.search.JSPSearchSupport.addJspFile(JSPSearchSupport.java:320)
     [java]     at
org.eclipse.jst.jsp.core.internal.java.search.JSPIndexManager$ProcessFilesJob.run(JSPIndexManager.java:251)
     [java]     at org.eclipse.core.internal.jobs.Worker.run(Worker.java:76)

Then the same NPE but coming from a different caller:

     [java] !ENTRY org.eclipse.core.runtime 4 2 2005-11-09 12:48:45.531
     [java] !MESSAGE An internal error occurred during: &quot;Model structure
builder: PageModel:
/customerCareWebProject/web/customerManagementPageFlow/customers.jsp&quot;.
     [java] !STACK 0
     [java] java.lang.NullPointerException
     [java]     at
java.util.Hashtable.get(Ljava.lang.Object;)Ljava.lang.Object;(Unknown Source)
     [java]     at
org.eclipse.wst.sse.core.internal.FileBufferModelManager.releaseModel(FileBufferModelManager.java:597)
     [java]     at
org.eclipse.wst.sse.core.internal.model.ModelManagerImpl.discardModel(ModelManagerImpl.java:1370)
     [java]     at
org.eclipse.wst.sse.core.internal.model.ModelManagerImpl.releaseFromRead(ModelManagerImpl.java:1397)
     [java]     at
org.eclipse.wst.sse.core.internal.model.AbstractStructuredModel.releaseFromRead(AbstractStructuredModel.java:1067)
     [java]     at
org.eclipse.wst.xml.core.internal.document.DOMModelImpl.releaseFromRead(DOMModelImpl.java:806)
     [java]     at
org.eclipse.wst.html.core.internal.document.DOMStyleModelImpl.releaseFromRead(DOMStyleModelImpl.java:44)
     [java]     at
com.bea.wlw.netui.core.page.structure.PageStructureBuilder.build(PageStructureBuilder.java:152)
     [java]     at
com.bea.wlw.common.core.model.AbstractExternalEventAdapter$StructureBuilderJob.run(AbstractExternalEventAdapter.java:285)
     [java]     at org.eclipse.core.internal.jobs.Worker.run(Worker.java:76)

Then the following assert:

     [java] !ENTRY org.eclipse.wst.sse.ui 4 4 2005-11-09 12:48:56.641
     [java] !MESSAGE problem with as-you-type validation
     [java] !STACK 0
     [java] org.eclipse.jface.text.Assert$AssertionFailedException: Assertion
failed: wrong model
     [java]     at org.eclipse.jface.text.Assert.isTrue(Assert.java:189)
     [java]     at
org.eclipse.jst.jsp.ui.internal.reconcile.ReconcileStepForJava.reconcileModel(ReconcileStepForJava.java:81)
     [java]     at
org.eclipse.jface.text.reconciler.AbstractReconcileStep.reconcile(AbstractReconcileStep.java:96)
     [java]     at
org.eclipse.jface.text.reconciler.AbstractReconcileStep.reconcile(AbstractReconcileStep.java:99)
     [java]     at
org.eclipse.wst.sse.ui.internal.reconcile.AbstractStructuredTextReconcilingStrategy.reconcile(AbstractStructuredTextReconcilingStrategy.java:368)
     [java]     at
org.eclipse.jst.jsp.ui.internal.reconcile.StructuredTextReconcilingStrategyForJSP.reconcile(StructuredTextReconcilingStrategyForJSP.java:149)
     [java]     at
org.eclipse.wst.sse.ui.internal.reconcile.StructuredRegionProcessor.process(StructuredRegionProcessor.java:170)
     [java]     at
org.eclipse.wst.sse.ui.internal.reconcile.DirtyRegionProcessor.run(DirtyRegionProcessor.java:412)
     [java]     at org.eclipse.core.internal.jobs.Worker.run(Worker.java:76)

Then the following NPE:

     [java] !ENTRY org.eclipse.core.filebuffers 4 2 2005-11-09 12:49:57.547
     [java] !MESSAGE Problems occurred when invoking code from plug-in:
&quot;org.eclipse.core.filebuffers&quot;.
     [java] !STACK 0
     [java] java.lang.NullPointerException
     [java]     at
org.eclipse.wst.sse.core.internal.model.AbstractStructuredModel.setDirtyState(AbstractStructuredModel.java:1337)
     [java]     at
org.eclipse.wst.sse.core.internal.FileBufferModelManager$FileBufferMapper.dirtyStateChanged(FileBufferModelManager.java:282)
     [java]     at
org.eclipse.core.internal.filebuffers.TextFileBufferManager$3.run(TextFileBufferManager.java:374)
     [java]     at
org.eclipse.core.internal.runtime.InternalPlatform.run(InternalPlatform.java:1044)
     [java]     at org.eclipse.core.runtime.Platform.run(Platform.java:783)
     [java]     at
org.eclipse.core.internal.filebuffers.TextFileBufferManager.fireDirtyStateChanged(TextFileBufferManager.java:372)
     [java]     at
org.eclipse.core.internal.filebuffers.ResourceFileBuffer.commit(ResourceFileBuffer.java:327)
     [java]     at
com.bea.wlw.template.textinserter.TextInserter.insertText(TextInserter.java:75)
     [java]     at
com.bea.wlw.jsp.core.commands.GenericTagCommand.performInsert(GenericTagCommand.java:189)
     [java]     at
com.bea.wlw.jsp.core.commands.GenericTagCommand.execute(GenericTagCommand.java:118)
     [java]     at
com.bea.wlw.netui.ui.jsp.commands.BaseDialogCommand.execute(BaseDialogCommand.java:53)
     [java]     at
org.eclipse.ui.internal.handlers.HandlerProxy.execute(HandlerProxy.java:151)
     [java]     at org.eclipse.core.commands.Command.execute(Command.java:311)
     [java]     at
com.bea.wlw.netui.ui.jsp.commands.DataPaletteTagCommand.execute(DataPaletteTagCommand.java:120)
     [java]     at
org.eclipse.ui.internal.handlers.HandlerProxy.execute(HandlerProxy.java:151)
     [java]     at org.eclipse.core.commands.Command.execute(Command.java:311)
     [java]     at
com.bea.wlw.common.ui.palette.dnd.DelegatingCommandDropAction.execute(DelegatingCommandDropAction.java:97)
     [java]     at
com.bea.wlw.common.ui.palette.design.DelegatingCommandDropActionAdapter.execute(DelegatingCommandDropActionAdapter.java:50)
     [java]     at
com.bea.wlw.common.ui.palette.design.DesignPalette$InsertMouseListener.mouseDoubleClick(DesignPalette.java:586)
     [java]     at
org.eclipse.swt.widgets.TypedListener.handleEvent(TypedListener.java:141)
     [java]     at org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:66)
     [java]     at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:843)
     [java]     at
org.eclipse.swt.widgets.Display.runDeferredEvents(Display.java:3080)
     [java]     at
org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:2713)
     [java]     at abbot.swt.Robot.delay(Robot.java:232)
     [java]     at abbot.tester.swt.Robot.delay(Robot.java:387)
     [java]     at abbot.tester.swt.Robot.wait(Robot.java:1447)
     [java]     at
com.bea.test.common.testers.AbstractDialogTester.runDialog(AbstractDialogTester.java:402)
     [java]     at
com.bea.test.wlw.netui.ui.jsp.testers.PageInputsDataGridDialogTester.invokeDialog(PageInputsDataGridDialogTester.java:57)
     [java]     at
com.bea.test.common.testers.AbstractDialogTester.runDialog(AbstractDialogTester.java:392)
     [java]     at
com.bea.test.wlw.scenario.tests.BasicDataScenarioDRT.addCustomerGrid(BasicDataScenarioDRT.java:678)
     [java]     at
com.bea.test.wlw.scenario.tests.BasicDataScenarioDRT.testBasicDataScenario(BasicDataScenarioDRT.java:212)

Then this one:

     [java] !ENTRY org.eclipse.jst.jsp.core 4 4 2005-11-09 12:49:57.562
     [java] !MESSAGE JSPIndexer problem
indexing:/customerCareWebProject/web/customerManagementPageFlow/customers.jsp
     [java] !STACK 0
     [java] java.lang.NullPointerException
     [java]     at
org.eclipse.jst.jsp.core.internal.java.JSPTranslator.reset(JSPTranslator.java:324)
     [java]     at
org.eclipse.jst.jsp.core.internal.java.JSPTranslationAdapter.getTranslator(JSPTranslationAdapter.java:171)
     [java]     at
org.eclipse.jst.jsp.core.internal.java.JSPTranslationAdapter.getJSPTranslation(JSPTranslationAdapter.java:130)
     [java]     at
org.eclipse.jst.jsp.core.internal.java.search.JSPSearchDocument.getJSPTranslation(JSPSearchDocument.java:112)
     [java]     at
org.eclipse.jst.jsp.core.internal.java.search.JSPSearchDocument.getPath(JSPSearchDocument.java:149)
     [java]     at
org.eclipse.jst.jsp.core.internal.java.search.JavaSearchDocumentDelegate.&lt;init&gt;(JavaSearchDocumentDelegate.java:30)
     [java]     at
org.eclipse.jst.jsp.core.internal.java.search.JSPSearchSupport.createSearchDocument(JSPSearchSupport.java:426)
     [java]     at
org.eclipse.jst.jsp.core.internal.java.search.JSPSearchSupport.addJspFile(JSPSearchSupport.java:320)
     [java]     at
org.eclipse.jst.jsp.core.internal.java.search.JSPIndexManager$ProcessFilesJob.run(JSPIndexManager.java:251)
     [java]     at org.eclipse.core.internal.jobs.Worker.run(Worker.java:76)</pre>
    </div>

    <div id="c3" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=115714#c3">Comment 3</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">David Williams</span> <a href="http://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=david_williams&#64;acm.org" alt="CLA" title="Eclipse Contributor Agreement" /></a> <a href="https://eclipse.org/donate/"><img class="cla_dec" src="//www.eclipse.org/donate/web-api/friends_decorator.php?email=david_williams&#64;acm.org" alt="Friend" title="Friend of Eclipse" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2005-11-12 01:57:06 EST
        </span>

      </div>




<pre class="bz_comment_text">There's many possiblities of error here. 

Other than the flaky stuff I know about, an intersting part of this use case 
is this part of the stack trace: 

org.eclipse.core.internal.filebuffers.ResourceFileBuffer.commit(ResourceFileBuffer.java:327)
     [java]     at
com.bea.wlw.template.textinserter.TextInserter.insertText(TextInserter.java:75)
     [java]     at
com.bea.wlw.jsp.core.commands.GenericTagCommand.performInsert(GenericTagCommand.java:189)
     [java]     at
com.bea.wlw.jsp.core.commands.GenericTagCommand.execute(GenericTagCommand.java:118)
     [java]     at
com.bea.wlw.netui.ui.jsp.commands.BaseDialogCommand.execute(BaseDialogCommand.java:53)

Its not that this part causes the problem per se, but hints that some previous
use of ResouceBuffer, Document, and/or Model (actually, their interactions) that
may have left things in a bad state. 

Ironically, this appears to be using as we intend ... but ... we do not do so
much, in this way, at this point, and there's likely thread coordination issues
we have planned, but have not put in place. 

So, here's some off hand questions on the general case ... 
Do the resource being used exist ahead of time, or is it sometimes completely
new? (You'll be more likely to see problems for completely new resources,
especially if the are saved, and then processed some more. (There's some issues
where the &quot;ID&quot; we use internally is miscomputed, some would say, for completely
new resources, and some parts of the &quot;system&quot; thinks there's two documents, when
there's really just one. 

Do you directly use our model or Document *and* the resouce buffer ... or just
the buffer? (and model and document just used indirectly? ) 


</pre>
    </div>

    <div id="c4" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=115714#c4">Comment 4</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Tom Stamm</span> <a href="http://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=stammt&#64;bea.com" alt="CLA" title="Eclipse Contributor Agreement" /></a> <a href="https://eclipse.org/donate/"><img class="cla_dec" src="//www.eclipse.org/donate/web-api/friends_decorator.php?email=stammt&#64;bea.com" alt="Friend" title="Friend of Eclipse" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2005-11-19 11:27:19 EST
        </span>

      </div>




<pre class="bz_comment_text">What our code is doing here is inserting a tag based on a drag/drop gesture from
a design palette. The tag itself is generated from a template, and inserted as
text into the file buffer, at the current caret offset in the editor. The
TextInserter code gets an ITextFileBuffer from the buffer manager, connects to
it, gets the buffer's IDocument, then creates and applies an InsertEdit. After
applying the edit, if the buffer was not previously dirty, it calls commit on
the buffer.

Right before doing the text insert, we do access the structured model to look
for taglib imports of the tag we are generating, so that we can use the right
prefix. We do this by calling
StructuredModelManager.getModelManager().getModelForRead( jspFile ) where
jspFile is the IFile, to get the IStructureModel, then get a DOM by calling
structuredModel.getAdapter( Document.class ), and iterating through the import
tags until we find one with the right uri. We call releaseFromRead on the
structured model in a finally block.

One thing I just noticed while looking back through the code is that we get the
Element for the taglib import, release the model from read, and then get the
prefix attribute from that element. It happens after the model's been released,
but before the text insertion. I'm not sure if that could be a problem...?

After we do the text insert, if we couldn't find an import for the tag, we get
the structured model again by calling getModelForEdit(), and then create and
insert the taglib nodes (but that hasn't happened by the time this NPE hit). It
is done in this order because we found that if we added the nodes to the DOM
before doing the text insert, sometimes one or the other would get &quot;lost&quot;, as if
the text insert and the DOM node insert were applied to different internal
instances, and one would &quot;win&quot; over the other when the actual text buffer was
updated.

I hope that wasn't too much detail :-)</pre>
    </div>

    <div id="c5" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=115714#c5">Comment 5</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">David Williams</span> <a href="http://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=david_williams&#64;acm.org" alt="CLA" title="Eclipse Contributor Agreement" /></a> <a href="https://eclipse.org/donate/"><img class="cla_dec" src="//www.eclipse.org/donate/web-api/friends_decorator.php?email=david_williams&#64;acm.org" alt="Friend" title="Friend of Eclipse" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2005-11-19 18:41:08 EST
        </span>

      </div>




<pre class="bz_comment_text">Definitly not too much detail! In fact, with that much detail, sounds like
you're close to providing a standalone JUnit test :) 

There are a large number of issues going on here, and while I don't
know/understand them all ... I'll post notes as I gain understanding, and
perhaps that will at least keep progress moving forward. 

<span class="quote">&gt;What our code is doing here is inserting a tag based on a drag/drop gesture from
&gt;a design palette. The tag itself is generated from a template, and inserted as
&gt;text into the file buffer, at the current caret offset in the editor. The
&gt;TextInserter code gets an ITextFileBuffer from the buffer manager, connects to
&gt;it, gets the buffer's IDocument, then creates and applies an InsertEdit. After
&gt;applying the edit, if the buffer was not previously dirty, it calls commit on
&gt;the buffer.</span >

The thing that stands out here is the end: &quot;calls commit on the buffer&quot;. 
If you call commit directly on the buffer, do you first get (compute) the
commitSchedulingRule? Even if you &quot;might&quot; commit, 
you should get that scheduling rule first and, I think, before any part of the
operations in this paragraph! Granted, this may cause some cases, such as if
autobuild is in progress, there the drag/drop from pallette will cause a dialog
to pop up that says &quot;user operation is blocked by backgroud job&quot; ... but ..
that's the idea to gaurd data. And, improvements in this &quot;user experience&quot; will
take some deeper work. 
[I'm not sure this is the cause of this particular bug ... I'm just trying to 
outline &quot;correct client behavior&quot; ... just in case]. 


<span class="quote">&gt;One thing I just noticed while looking back through the code is that we get the
&gt;Element for the taglib import, release the model from read, and then get the
&gt;prefix attribute from that element. It happens after the model's been released,
&gt;but before the text insertion. I'm not sure if that could be a problem...?</span >

In general, yes, this is incorrrect client behavior ... once released, nothing
should be done with any part of the model. [Again, not sure if this is cause of
this bug, but could be related]. 




I'm (still) guessing part of this bug is due to the &quot;new file vs. existing file&quot;
bugs that are resulting due to some behavior in text buffer manager we did not
well anticipate ... and related to bugs <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED FIXED - IStructuredModel#save(IFile) for SaveAs causes a ghost file"
   href="show_bug.cgi?id=107311">107311</a>, <a class="bz_bug_link 
          bz_status_CLOSED  bz_closed"
   title="CLOSED FIXED - Different id is generated by IModelManager#calculateId() for IFile"
   href="show_bug.cgi?id=107316">107316</a>, and 107320 .... so I'll
take a look at those this weekend. 

I expect, however, in the complex case you've detailed, it will take a fair
amount of work to track down and fix all the scheduling and thread issues. 
</pre>
    </div>

    <div id="c6" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=115714#c6">Comment 6</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Tom Stamm</span> <a href="http://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=stammt&#64;bea.com" alt="CLA" title="Eclipse Contributor Agreement" /></a> <a href="https://eclipse.org/donate/"><img class="cla_dec" src="//www.eclipse.org/donate/web-api/friends_decorator.php?email=stammt&#64;bea.com" alt="Friend" title="Friend of Eclipse" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2005-11-19 18:50:30 EST
        </span>

      </div>




<pre class="bz_comment_text">Interesting! I don't think we are getting the commit scheduling rule, I'll look
into that; and to keeping the DOM element after releasing the model.

I forgot one of your original questions - in this case, the file was already
existing. This didn't happen while creating a new file.

Also, as far as I know, this particular NPE was only reported once; and these
tests are run continuously every day. So it's definitely much less common than
some of the other threading issues we've run into. (mostly involving usage of EMF)</pre>
    </div>

    <div id="c7" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=115714#c7">Comment 7</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Nitin Dahyabhai</span> <a href="http://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=thatnitind&#64;gmail.com" alt="CLA" title="Eclipse Contributor Agreement" /></a> <a href="https://eclipse.org/donate/"><img class="cla_dec" src="//www.eclipse.org/donate/web-api/friends_decorator.php?email=thatnitind&#64;gmail.com" alt="Friend" title="Friend of Eclipse" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2006-04-20 16:48:30 EDT
        </span>

      </div>




<pre class="bz_comment_text">*** <a class="bz_bug_link 
          bz_status_CLOSED  bz_closed"
   title="CLOSED DUPLICATE - release being called without get?"
   href="show_bug.cgi?id=102223">Bug 102223</a> has been marked as a duplicate of this bug. ***</pre>
    </div>

    <div id="c8" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=115714#c8">Comment 8</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Nitin Dahyabhai</span> <a href="http://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=thatnitind&#64;gmail.com" alt="CLA" title="Eclipse Contributor Agreement" /></a> <a href="https://eclipse.org/donate/"><img class="cla_dec" src="//www.eclipse.org/donate/web-api/friends_decorator.php?email=thatnitind&#64;gmail.com" alt="Friend" title="Friend of Eclipse" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2006-06-01 13:03:46 EDT
        </span>

      </div>




<pre class="bz_comment_text">Decreasing priority.  If anyone is able to consistently reproduce this and/or has a JUnit test for it, we'll bump it back up.</pre>
    </div>

    <div id="c9" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=115714#c9">Comment 9</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Nitin Dahyabhai</span> <a href="http://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=thatnitind&#64;gmail.com" alt="CLA" title="Eclipse Contributor Agreement" /></a> <a href="https://eclipse.org/donate/"><img class="cla_dec" src="//www.eclipse.org/donate/web-api/friends_decorator.php?email=thatnitind&#64;gmail.com" alt="Friend" title="Friend of Eclipse" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2009-04-19 23:32:31 EDT
        </span>

      </div>




<pre class="bz_comment_text">Closing as worksforme.  The model's document can become null when it's released completely and discarded, which could lead to a &quot;null&quot; document being sent to the FileBufferModelManager's releaseModel method.  Could also have been related to <a class="bz_bug_link 
          bz_status_VERIFIED  bz_closed"
   title="VERIFIED FIXED - Content assist fails when editing web.xml or faces-config.xml in XML Editor"
   href="show_bug.cgi?id=205733">bug 205733</a>.  Please reopen if you run across it again so we can renew the investigation on something more current.</pre>
    </div>


  

</td>
<td>
</td>
</tr></table>
  </div>
        

</form>

<hr>
<ul class="related_actions">
    <li><a href="show_bug.cgi?format=multiple&amp;id=115714">Format For Printing</a></li>
    <li>&nbsp;-&nbsp;<a href="show_bug.cgi?ctype=xml&amp;id=115714">XML</a></li>
    <li>&nbsp;-&nbsp;<a href="enter_bug.cgi?cloned_bug_id=115714">Clone This Bug</a></li>
    
    <li>&nbsp;-&nbsp;<a href="#">Top of page </a></li>
    </ul>

<br>
</div>

    <div id="footer">
      <div class="intro"></div>
<ul id="useful-links">
  <li id="links-actions"><ul class="links">
  <li><a href="./">Home</a></li>
  <li><span class="separator">| </span><a href="enter_bug.cgi">New</a></li>
  <li><span class="separator">| </span><a href="describecomponents.cgi">Browse</a></li>
  <li><span class="separator">| </span><a href="query.cgi">Search</a></li>

  <li class="form">
    <span class="separator">| </span>
    <form action="buglist.cgi" method="get"
        onsubmit="if (this.quicksearch.value == '')
                  { alert('Please enter one or more search terms first.');
                    return false; } return true;">
    <input type="hidden" id="no_redirect_bottom" name="no_redirect" value="0">
    <script type="text/javascript">
      if (history && history.replaceState) {
        var no_redirect = document.getElementById("no_redirect_bottom");
        no_redirect.value = 1;
      }
    </script>
    <input class="txt" type="text" id="quicksearch_bottom" name="quicksearch" 
           title="Quick Search" value="">
    <input class="btn" type="submit" value="Search" 
           id="find_bottom"></form>
  <a href="page.cgi?id=quicksearch.html" title="Quicksearch Help">[?]</a></li>

  <li><span class="separator">| </span><a href="report.cgi">Reports</a></li>

  <li>
      <span class="separator">| </span>
        <a href="request.cgi">Requests</a></li>


  <li>
        <span class="separator">| </span>
        <a href="https://bugzilla.readthedocs.org/en/5.0/using/understanding.html" target="_blank">Help</a>
      </li>
    

    <li id="mini_login_container_bottom">
  <span class="separator">| </span>
  <a id="login_link_bottom" href="show_bug.cgi?id=115714&amp;GoAheadAndLogIn=1"
     onclick="return show_mini_login_form('_bottom')">Log In</a>

  <form action="show_bug.cgi?id=115714" method="POST"
        class="mini_login bz_default_hidden"
        id="mini_login_bottom">
    <input id="Bugzilla_login_bottom" required
           name="Bugzilla_login" class="bz_login"
        placeholder="Login">
    <input class="bz_password" name="Bugzilla_password" type="password"
           id="Bugzilla_password_bottom" required
           placeholder="Password">
    <input type="hidden" name="Bugzilla_login_token"
           value="">
    <input type="submit" name="GoAheadAndLogIn" value="Log in"
            id="log_in_bottom">
    <a href="#" onclick="return hide_mini_login_form('_bottom')">[x]</a>
  </form>
</li>
  <span class="separator">| </span>
  <li><a href="http://www.eclipse.org/legal/termsofuse.php">Terms of Use</a></li>
  <span class="separator">| </span>
  <li><a href="http://www.eclipse.org/legal/copyright.php">Copyright Agent</a></li>
</ul>
  </li>

  




  
</ul>

      <div class="outro"></div>
    </div>

  </body>
</html>
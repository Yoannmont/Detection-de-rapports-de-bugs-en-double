<!DOCTYPE html>
<html lang="en">
  <head>
    <title>193269 &ndash; NullP.Ex. in java.util.zip.Inflater.ensureOpen when opening InputStream to JAR in Bundle</title>

      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<link href="https://bugs.eclipse.org/bugs/data/assets/03c4bb46b12126a79867f9a9f5323634.css?1593441374" rel="stylesheet" type="text/css">



    
<script type="text/javascript" src="https://bugs.eclipse.org/bugs/data/assets/a7c2f3a028f17a9aa60f56dc9d6e732d.js?1593441374"></script>

    <script type="text/javascript">
    <!--
        YAHOO.namespace('bugzilla');
        YAHOO.util.Event.addListener = function (el, sType, fn, obj, overrideContext) {
               if ( ("onpagehide" in window || YAHOO.env.ua.gecko) && sType === "unload") { sType = "pagehide"; };
               var capture = ((sType == "focusin" || sType == "focusout") && !YAHOO.env.ua.ie) ? true : false;
               return this._addListener(el, this._getType(sType), fn, obj, overrideContext, capture);
         };
        if ( "onpagehide" in window || YAHOO.env.ua.gecko) {
            YAHOO.util.Event._simpleRemove(window, "unload", 
                                           YAHOO.util.Event._unload);
        }
        
        function unhide_language_selector() { 
            YAHOO.util.Dom.removeClass(
                'lang_links_container', 'bz_default_hidden'
            ); 
        } 
        YAHOO.util.Event.onDOMReady(unhide_language_selector);

        
        var BUGZILLA = {
            param: {
                cookiepath: '\/bugs',
                maxusermatches: 10
            },
            constant: {
                COMMENT_COLS: 80
            },
            string: {
                

                attach_desc_required:
                    "You must enter a Description for this attachment.",
                component_required:
                    "You must select a Component for this bug.",
                description_required:
                    "You must enter a Description for this bug.",
                short_desc_required:
                    "You must enter a Summary for this bug.",
                version_required:
                    "You must select a Version for this bug."
            }
              , api_token: ''
        };

    if (history && history.replaceState) {
      if(!document.location.href.match(/show_bug\.cgi/)) {
        history.replaceState( null,
                             "193269 – NullP.Ex. in java.util.zip.Inflater.ensureOpen when opening InputStream to JAR in Bundle",
                             "show_bug.cgi?id=193269" );
        document.title = "193269 – NullP.Ex. in java.util.zip.Inflater.ensureOpen when opening InputStream to JAR in Bundle";
      }
      if (document.location.href.match(/show_bug\.cgi\?.*list_id=/)) {
        var href = document.location.href;
        href = href.replace(/[\?&]+list_id=(\d+|cookie)/, '');
        history.replaceState(null, "193269 – NullP.Ex. in java.util.zip.Inflater.ensureOpen when opening InputStream to JAR in Bundle", href);
      }
    }
    YAHOO.util.Event.onDOMReady(function() {
      initDirtyFieldTracking();

    });
    // -->
    </script>
<script type="text/javascript" src="https://bugs.eclipse.org/bugs/data/assets/daf5e0fb6826e6a35280e622913f0c4a.js?1593441374"></script>

    

    
    <link rel="search" type="application/opensearchdescription+xml"
                       title="Bugzilla" href="./search_plugin.cgi">
    <link rel="shortcut icon" href="images/favicon.ico">
  </head>

  <body 
        class="bugs-eclipse-org-bugs
                 bz_bug
                 bz_status_RESOLVED
                 bz_product_Equinox
                 bz_component_Framework
                 bz_bug_193269 yui-skin-sam">

  <div id="header"><!-- 1.0@bugzilla.org -->





<!--  START OF SOLSTICE HEADER -->
 <link rel="stylesheet" type="text/css" href="https://www.eclipse.org/eclipse.org-common/themes/solstice/public/stylesheets/vendor/cookieconsent/cookieconsent.min.css" />
 <script src="https://www.eclipse.org/eclipse.org-common/themes/solstice/public/javascript/vendor/cookieconsent/default.min.js"></script>
 <style type="text/css">
    @import url('https://www.eclipse.org/eclipse.org-common/themes/solstice/public/stylesheets/barebone.min.css')
    </style>
    <script
      src="https://www.eclipse.org/eclipse.org-common/themes/solstice/public/javascript/barebone.min.js">
    </script><header role="banner" class="barebone-layout thin-header padding-top-5 padding-bottom-5"  id="header-wrapper">
  <div class="container-fluid reset">
    <div class="row-fluid" id="header-row">
            <div class="col-sm-8 col-md-6 col-lg-4" id="header-left">
        <div class="wrapper-logo-default"><a href="https://www.eclipse.org/"><img class="logo-eclipse-default img-responsive hidden-xs" alt="logo" src="https://bugs.eclipse.org/eclipse.org-common/themes/solstice/public/images/logo/eclipse-426x100.png"/></a></div>
      </div>            <div class="col-sm-16 col-md-18 col-lg-20" id="main-menu-wrapper">
  <div class="navbar yamm" id="main-menu">
    <div id="navbar-collapse-1" class="navbar-collapse collapse">
      <ul class="nav navbar-nav navbar-right">
        <li class="visible-thin"><a href="https://www.eclipse.org/downloads/" target="_self">Download</a></li><li><a href="https://www.eclipse.org/users/" target="_self">Getting Started</a></li><li><a href="https://www.eclipse.org/membership/" target="_self">Members</a></li><li><a href="https://www.eclipse.org/projects/" target="_self">Projects</a></li>                  <li class="dropdown visible-xs"><a href="#" data-toggle="dropdown" class="dropdown-toggle">Community <b class="caret"></b></a><ul class="dropdown-menu"><li><a href="http://marketplace.eclipse.org">Marketplace</a></li><li><a href="http://events.eclipse.org">Events</a></li><li><a href="http://www.planeteclipse.org/">Planet Eclipse</a></li><li><a href="https://www.eclipse.org/community/eclipse_newsletter/">Newsletter</a></li><li><a href="https://www.youtube.com/user/EclipseFdn">Videos</a></li></ul></li><li class="dropdown visible-xs"><a href="#" data-toggle="dropdown" class="dropdown-toggle">Participate <b class="caret"></b></a><ul class="dropdown-menu"><li><a href="https://bugs.eclipse.org/bugs/">Report a Bug</a></li><li><a href="https://www.eclipse.org/forums/">Forums</a></li><li><a href="https://www.eclipse.org/mail/">Mailing Lists</a></li><li><a href="https://wiki.eclipse.org/">Wiki</a></li><li><a href="https://wiki.eclipse.org/IRC">IRC</a></li><li><a href="https://www.eclipse.org/contribute/">How to Contribute</a></li></ul></li><li class="dropdown visible-xs"><a href="#" data-toggle="dropdown" class="dropdown-toggle">Working Groups <b class="caret"></b></a><ul class="dropdown-menu"><li><a href="http://wiki.eclipse.org/Auto_IWG">Automotive</a></li><li><a href="http://iot.eclipse.org">Internet of Things</a></li><li><a href="http://locationtech.org">LocationTech</a></li><li><a href="http://lts.eclipse.org">Long-Term Support</a></li><li><a href="http://polarsys.org">PolarSys</a></li><li><a href="http://science.eclipse.org">Science</a></li><li><a href="http://www.openmdm.org">OpenMDM</a></li></ul></li>          <!-- More -->
          <li class="dropdown eclipse-more hidden-xs">
            <a data-toggle="dropdown" class="dropdown-toggle">More<b class="caret"></b></a>
            <ul class="dropdown-menu">
              <li>
                <!-- Content container to add padding -->
                <div class="yamm-content">
                  <div class="row">
                    <ul class="col-sm-8 list-unstyled"><li><p><strong>Community</strong></p></li><li><a href="http://marketplace.eclipse.org">Marketplace</a></li><li><a href="http://events.eclipse.org">Events</a></li><li><a href="http://www.planeteclipse.org/">Planet Eclipse</a></li><li><a href="https://www.eclipse.org/community/eclipse_newsletter/">Newsletter</a></li><li><a href="https://www.youtube.com/user/EclipseFdn">Videos</a></li></ul><ul class="col-sm-8 list-unstyled"><li><p><strong>Participate</strong></p></li><li><a href="https://bugs.eclipse.org/bugs/">Report a Bug</a></li><li><a href="https://www.eclipse.org/forums/">Forums</a></li><li><a href="https://www.eclipse.org/mail/">Mailing Lists</a></li><li><a href="https://wiki.eclipse.org/">Wiki</a></li><li><a href="https://wiki.eclipse.org/IRC">IRC</a></li><li><a href="https://www.eclipse.org/contribute/">How to Contribute</a></li></ul><ul class="col-sm-8 list-unstyled"><li><p><strong>Working Groups</strong></p></li><li><a href="http://wiki.eclipse.org/Auto_IWG">Automotive</a></li><li><a href="http://iot.eclipse.org">Internet of Things</a></li><li><a href="http://locationtech.org">LocationTech</a></li><li><a href="http://lts.eclipse.org">Long-Term Support</a></li><li><a href="http://polarsys.org">PolarSys</a></li><li><a href="http://science.eclipse.org">Science</a></li><li><a href="http://www.openmdm.org">OpenMDM</a></li></ul>                  </div>
                </div>
              </li>
            </ul>
          </li>
              </ul>
    </div>
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar-collapse-1">
      <span class="sr-only">Toggle navigation</span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      </button>
      <div class="wrapper-logo-mobile"><a class="navbar-brand visible-xs" href="https://www.eclipse.org/"><img class="logo-eclipse-default-mobile img-responsive" alt="logo" src="https://bugs.eclipse.org/eclipse.org-common/themes/solstice/public/images/logo/eclipse-800x188.png"/></a></div>    </div>
  </div>
</div>
    </div>
  </div>
</header>
<!--  END OF SOLSTICE HEADER -->

    <div id="titles">
      <span id="title">Bugzilla &ndash; Bug&nbsp;193269</span>

        <span id="subtitle" class="subheader">NullP.Ex. in java.util.zip.Inflater.ensureOpen when opening InputStream to JAR in Bundle</span>

        <span id="information" class="header_addl_info">Last modified: 2020-02-07 16:02:30 EST</span>
    </div>


    <div id="common_links"><ul class="links">
  <li><a href="./">Home</a></li>
  <li><span class="separator">| </span><a href="enter_bug.cgi">New</a></li>
  <li><span class="separator">| </span><a href="describecomponents.cgi">Browse</a></li>
  <li><span class="separator">| </span><a href="query.cgi">Search</a></li>

  <li class="form">
    <span class="separator">| </span>
    <form action="buglist.cgi" method="get"
        onsubmit="if (this.quicksearch.value == '')
                  { alert('Please enter one or more search terms first.');
                    return false; } return true;">
    <input type="hidden" id="no_redirect_top" name="no_redirect" value="0">
    <script type="text/javascript">
      if (history && history.replaceState) {
        var no_redirect = document.getElementById("no_redirect_top");
        no_redirect.value = 1;
      }
    </script>
    <input class="txt" type="text" id="quicksearch_top" name="quicksearch" 
           title="Quick Search" value="">
    <input class="btn" type="submit" value="Search" 
           id="find_top"></form>
  <a href="page.cgi?id=quicksearch.html" title="Quicksearch Help">[?]</a></li>

  <li><span class="separator">| </span><a href="report.cgi">Reports</a></li>

  <li>
      <span class="separator">| </span>
        <a href="request.cgi">Requests</a></li>


  <li>
        <span class="separator">| </span>
        <a href="https://bugzilla.readthedocs.org/en/5.0/using/understanding.html" target="_blank">Help</a>
      </li>
    

    <li id="mini_login_container_top">
  <span class="separator">| </span>
  <a id="login_link_top" href="show_bug.cgi?id=193269&amp;GoAheadAndLogIn=1"
     onclick="return show_mini_login_form('_top')">Log In</a>

  <form action="show_bug.cgi?id=193269" method="POST"
        class="mini_login bz_default_hidden"
        id="mini_login_top">
    <input id="Bugzilla_login_top" required
           name="Bugzilla_login" class="bz_login"
        placeholder="Login">
    <input class="bz_password" name="Bugzilla_password" type="password"
           id="Bugzilla_password_top" required
           placeholder="Password">
    <input type="hidden" name="Bugzilla_login_token"
           value="">
    <input type="submit" name="GoAheadAndLogIn" value="Log in"
            id="log_in_top">
    <a href="#" onclick="return hide_mini_login_form('_top')">[x]</a>
  </form>
</li>
  <span class="separator">| </span>
  <li><a href="http://www.eclipse.org/legal/termsofuse.php">Terms of Use</a></li>
  <span class="separator">| </span>
  <li><a href="http://www.eclipse.org/legal/copyright.php">Copyright Agent</a></li>
</ul>
    </div>
  </div>

  <div id="bugzilla-body">


<script type="text/javascript">
<!--

//-->
</script>

<form name="changeform" id="changeform" method="post" action="process_bug.cgi">

  <input type="hidden" name="delta_ts" value="2020-02-07 16:02:30">
  <input type="hidden" name="id" value="193269">
  <input type="hidden" name="token" value="1629852924-yUR_myajh29gi0cidhODtXArHJBtlCia9gHlZkTsUWU">
<div class="bz_short_desc_container edit_form">
     <a href="show_bug.cgi?id=193269"><b>Bug&nbsp;193269</b></a> <span id="summary_container" class="bz_default_hidden">
      - <span id="short_desc_nonedit_display">NullP.Ex. in java.util.zip.Inflater.ensureOpen when opening InputStream to JAR in Bundle</span>
     </span>

    <div id="summary_input"><span class="field_label "
    id="field_label_short_desc">


  <a 
      title="The bug summary is a short sentence which succinctly describes what the bug is about."
      class="field_help_link"
      href="page.cgi?id=fields.html#short_desc"
  >Summary:</a>

</span><span title="NullP.Ex. in java.util.zip.Inflater.ensureOpen when opening InputStream to JAR in Bundle">NullP.Ex. in java.util.zip.Inflater.ensureOpen when opening InputStream to JA...
        </span>
    </div>
  </div>
  <script type="text/javascript">
    hideEditableField('summary_container',
                      'summary_input',
                      'summary_edit_action',
                      'short_desc',
                      'NullP.Ex. in java.util.zip.Inflater.ensureOpen when opening InputStream to JAR in Bundle' );
  </script>
  <table class="edit_form">
    <tr>
      
      <td id="bz_show_bug_column_1" class="bz_show_bug_column">     
        <table>
          <tr>
    <th class="field_label">
      <a href="page.cgi?id=fields.html#bug_status">Status</a>:
    </th>
    <td id="bz_field_status">
      <span id="static_bug_status">RESOLVED
          WORKSFORME
      </span>
    </td>
  </tr>
<tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
<tr><th class="field_label "
    id="field_label_alias">


  <a 
      title="A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla."
      class="field_help_link"
      href="page.cgi?id=fields.html#alias"
  >Alias:</a>

</th>
    <td>
        None
    </td>
  </tr>
<tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
<tr><th class="field_label "
    id="field_label_product">


  <a 
      title="Bugs are categorised into Products and Components. Select a Classification to narrow down this list."
      class="field_help_link"
      href="describecomponents.cgi"
  >Product:</a>

</th>
  <td class="field_value "
      id="field_container_product" >Equinox

</td>
    </tr>

    
    <tr class="bz_default_hidden"><th class="field_label "
    id="field_label_classification">


  <a 
      title="Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation."
      class="field_help_link"
      href="page.cgi?id=fields.html#classification"
  >Classification:</a>

</th>
  <td class="field_value "
      id="field_container_classification" >Eclipse Project

</td>
    </tr>
        
    
    
    <tr><th class="field_label "
    id="field_label_component">


  <a 
      title="Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list."
      class="field_help_link"
      href="describecomponents.cgi?product=Equinox"
  >Component:</a>

</th>
  <td class="field_value "
      id="field_container_component" >Framework

  (<a href="buglist.cgi?component=Framework&amp;product=Equinox&amp;bug_status=__open__"
      target="_blank">show other bugs</a>)
</td>
    </tr>
    <tr><th class="field_label "
    id="field_label_version">


  <a 
      title="The version field defines the version of the software the bug was found in."
      class="field_help_link"
      href="page.cgi?id=fields.html#version"
  >Version:</a>

</th>

      <td>3.2.2 &#160; <a href="https://dev.eclipse.org/committers/bugs/bugz_manager.php"><img src="//dev.eclipse.org/small_icons/apps/accessories-text-editor.png" alt="Edit" title="Edit these values" /></a></td>
    </tr>
        
    
        
    <tr><th class="field_label "
    id="field_label_rep_platform">


  <a 
      title="The hardware platform the bug was observed on. Note: When searching, selecting the option &quot;All&quot; only finds bugs whose value for this field is literally the word &quot;All&quot;."
      class="field_help_link"
      href="page.cgi?id=fields.html#rep_platform"
  >Hardware:</a>

</th>
      <td class="field_value">PC
        Linux
      </td>
    </tr>
          <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
          
          <tr>
      <th class="field_label">
        <label  accesskey="i">
          <a href="page.cgi?id=fields.html#importance"><u>I</u>mportance</a></label>:
      </th>
      <td>P3
       normal<span id="votes_container">
    (<a href="page.cgi?id=voting/user.html&amp;bug_id=193269#vote_193269">vote</a>)
  </span>
      </td>
    </tr>

      <tr><th class="field_label "
    id="field_label_target_milestone">


  <a 
      title="The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it."
      class="field_help_link"
      href="page.cgi?id=fields.html#target_milestone"
  >Target Milestone:</a>

</th>
        <td>--- &#160; <a href="https://dev.eclipse.org/committers/bugs/bugz_manager.php"><img src="//dev.eclipse.org/small_icons/apps/accessories-text-editor.png" alt="Edit" title="Edit these values" /></a></td>
      </tr>
          
          <tr><th class="field_label "
    id="field_label_assigned_to">


  <a 
      title="The person in charge of resolving the bug."
      class="field_help_link"
      href="page.cgi?id=fields.html#assigned_to"
  >Assignee:</a>

</th>
      <td><span class="vcard"><span class="fn">equinox.framework-inbox</span> <a href="http://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=equinox.framework-inbox&#64;eclipse.org" alt="CLA" title="Eclipse Contributor Agreement" /></a> <a href="https://eclipse.org/donate/"><img class="cla_dec" src="//www.eclipse.org/donate/web-api/friends_decorator.php?email=equinox.framework-inbox&#64;eclipse.org" alt="Friend" title="Friend of Eclipse" /></a>
</span>
      </td>
    </tr>

    <tr><th class="field_label "
    id="field_label_qa_contact">


  <a 
      title="The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved."
      class="field_help_link"
      href="page.cgi?id=fields.html#qa_contact"
  >QA Contact:</a>

</th>
      <td><span class="vcard">
</span>
      </td>
    </tr>
    <script type="text/javascript">
      assignToDefaultOnChange(['product', 'component'],
        'equinox.framework-inbox\x40eclipse.org',
        '');
    </script>
          <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
          <tr><th class="field_label "
    id="field_label_bug_file_loc">


  <a 
      title="Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen."
      class="field_help_link"
      href="page.cgi?id=fields.html#bug_file_loc"
  >URL:</a>

</th>
    <td>
      <span id="bz_url_input_area">
      </span>
    </td>
  </tr>

    <tr><th class="field_label "
    id="field_label_status_whiteboard">


  <a 
      title="Each bug has a free-form single line text entry box for adding tags and status information."
      class="field_help_link"
      href="page.cgi?id=fields.html#status_whiteboard"
  >Whiteboard:</a>

</th><td>  
  </td>
    </tr>

    <tr><th class="field_label "
    id="field_label_keywords">


  <a 
      title="You can add keywords from a defined list to bugs, in order to easily identify and group them."
      class="field_help_link"
      href="describekeywords.cgi"
  >Keywords:</a>

</th>
  <td class="field_value "
      id="field_container_keywords" >needinfo

</td>
    </tr>
          <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>

          
<tr><th class="field_label "
    id="field_label_dependson">


  <a 
      title="The bugs listed here must be resolved before this bug can be resolved."
      class="field_help_link"
      href="page.cgi?id=fields.html#dependson"
  >Depends on:</a>

</th>

  <td>
    <span id="dependson_input_area">
    </span>

  </td>
  </tr>
  
  <tr><th class="field_label "
    id="field_label_blocked">


  <a 
      title="This bug must be resolved before the bugs listed in this field can be resolved."
      class="field_help_link"
      href="page.cgi?id=fields.html#blocked"
  >Blocks:</a>

</th>

  <td>
    <span id="blocked_input_area">
    </span>

  </td>
  </tr>
          
        </table>
      </td>
      <td>
        <div class="bz_column_spacer">&nbsp;</div>
      </td>
      
      <td id="bz_show_bug_column_2" class="bz_show_bug_column">
        <table>
        <tr>
    <th class="field_label">
      Reported:
    </th>
    <td>2007-06-19 03:32 EDT by <span class="vcard"><span class="fn">Michael Mangeng</span> <a href="http://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=mm&#64;vis.at" alt="CLA" title="Eclipse Contributor Agreement" /></a> <a href="https://eclipse.org/donate/"><img class="cla_dec" src="//www.eclipse.org/donate/web-api/friends_decorator.php?email=mm&#64;vis.at" alt="Friend" title="Friend of Eclipse" /></a>
</span>
    </td>
  </tr>
  
  <tr>
    <th class="field_label">
      Modified:
    </th>
    <td>2020-02-07 16:02 EST
      (<a href="show_activity.cgi?id=193269">History</a>)
    </td>
  
  </tr>
<tr>
      <th class="field_label">
        <label  accesskey="a">
          CC List:
        </label>
      </th>
      <td>5 
          users
          <span id="cc_edit_area_showhide_container" class="bz_default_hidden">
            (<a href="#" id="cc_edit_area_showhide">show</a>)
          </span>
        <div id="cc_edit_area">
          <br>
            <select id="cc" multiple="multiple" size="5" >
                <option value="csnyder">csnyder</option>
                <option value="lfbayer">lfbayer</option>
                <option value="martin">martin</option>
                <option value="rjefts">rjefts</option>
                <option value="tjwatson">tjwatson</option>
            </select>
        </div>
          <script type="text/javascript">
            hideEditableField( 'cc_edit_area_showhide_container', 
                               'cc_edit_area', 
                               'cc_edit_area_showhide', 
                               '', 
                               '');  
          </script>
      </td>
    </tr>

<tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
<tr><th class="field_label "
    id="field_label_see_also">


  <a 
      title="This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields."
      class="field_help_link"
      href="page.cgi?id=fields.html#see_also"
  >See Also:</a>

</th>
  <td class="field_value "
      id="field_container_see_also" >

</td>
    </tr> 

<tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>



        </table>
      </td>
    </tr>
    <tr>
      <td colspan="3">
          <hr id="bz_top_half_spacer">
      </td>
    </tr>
  </table>

  <table id="bz_big_form_parts">
  <tr>
  <td>

    
<script type="text/javascript">
<!--
function toggle_display(link) {
    var table = document.getElementById("attachment_table");
    var view_all = document.getElementById("view_all");
    var hide_obsolete_url_parameter = "&hide_obsolete=1";
    // Store current height for scrolling later
    var originalHeight = table.offsetHeight;
    var rows = YAHOO.util.Dom.getElementsByClassName(
        'bz_tr_obsolete', 'tr', table);

    for (var i = 0; i < rows.length; i++) {
        bz_toggleClass(rows[i], 'bz_default_hidden');
    }

    if (YAHOO.util.Dom.hasClass(rows[0], 'bz_default_hidden')) {
        link.innerHTML = "Show Obsolete";
        view_all.href = view_all.href + hide_obsolete_url_parameter 
    }
    else {
        link.innerHTML = "Hide Obsolete";
        view_all.href = view_all.href.replace(hide_obsolete_url_parameter,"");
    }

    var newHeight = table.offsetHeight;
    // This scrolling makes the window appear to not move at all.
    window.scrollBy(0, newHeight - originalHeight);

    return false;
}
//-->
</script>

<br>
<table id="attachment_table">
  <tr id="a0">
    <th colspan="3" class="left">
      Attachments
    </th>
  </tr>



  <tr class="bz_attach_footer">
    <td colspan="3">
        <a href="attachment.cgi?bugid=193269&amp;action=enter">Add an attachment</a>
        (proposed patch, testcase, etc.)
    </td>
  </tr>
</table>
<br>
<div id="add_comment" class="bz_section_additional_comments">
      <table>
        <tr>
          <td>
            <fieldset>
              <legend>Note</legend>
              You need to
              <a href="show_bug.cgi?id=193269&amp;GoAheadAndLogIn=1">log in</a>
              before you can comment on or make changes to this bug.
            </fieldset>
          </td>
        </tr> 
      </table>
  </div>
  </td>
  <td>
  </td>
  </tr></table>

  
  <div id="comments"><script src="https://bugs.eclipse.org/bugs/js/comments.js?1463425338" type="text/javascript">
</script>

<script type="text/javascript">
<!--
  /* Adds the reply text to the 'comment' textarea */
  function replyToComment(id, real_id, name) {
      var prefix = "(In reply to " + name + " from comment #" + id + ")\n";
      var replytext = "";
        /* pre id="comment_name_N" */
        var text_elem = document.getElementById('comment_text_'+id);
        var text = getText(text_elem);
        replytext = prefix + wrapReplyText(text);


      /* <textarea id="comment"> */
      var textarea = document.getElementById('comment');
      if (textarea.value != replytext) {
          textarea.value += replytext;
      }

      textarea.focus();
  } 
//-->
</script>


<!-- This auto-sizes the comments and positions the collapse/expand links 
     to the right. -->
<table class="bz_comment_table">
<tr>
<td>
<div id="c0" class="bz_comment bz_first_comment">

      <div class="bz_first_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=193269#c0">Description</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Michael Mangeng</span> <a href="http://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=mm&#64;vis.at" alt="CLA" title="Eclipse Contributor Agreement" /></a> <a href="https://eclipse.org/donate/"><img class="cla_dec" src="//www.eclipse.org/donate/web-api/friends_decorator.php?email=mm&#64;vis.at" alt="Friend" title="Friend of Eclipse" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2007-06-19 03:32:29 EDT
        </span>

      </div>




<pre class="bz_comment_text">I occasionally(!) get a strange NullPointerException in java.util.zip.Inflator.ensureOpen when i try to open a stream to a bundleentry. I retrieve the URLs via bundle.findEntries(...). Currently the exception is only reproduceable if the bundle is exported as jar.

Here comes the method which produces the exception:

The exception-line is:
InputStream entryIS = entry.openStream();

-------
private void writeBundle(NodeDesc nd, OutputStream outputStream, BundleContext context) {
    ZipOutputStream zos = new ZipOutputStream(outputStream);
    Enumeration bundleEntries = context.getBundle().findEntries(&quot;/jarcontent&quot;, &quot;*&quot;, true);
    try {
        byte[] copyBuf = new byte[512];
        while(bundleEntries.hasMoreElements()) {
            java.net.URL entry = (java.net.URL)bundleEntries.nextElement(); 
            InputStream entryIS = entry.openStream(); //THIS LINE PRODUCE THE EXCEPTION
				
            [... the method copy the entries from entryIS to the zipoutputstream- but this code is not reached if the exceptionoccurs ...]
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
-------
(The method searches all files in /jarcontent which contain template files for a dynamically created bundle. Then it iterates the entries, modifys them if needed, and copy them into the new jar.)

The interesting part is that the exception only occours occasionally. But after the start of the osgi framework i can (nearly) always reproduce it for 1 time. If i trigger the method again, no execption occurs. I also get this exception in 2 other bundles which contain war files for a webapp container.

Tested with JDKs:
+ 1.5.0_10-b03
+ 1.6.0-b105


Here the Exception:
java.lang.NullPointerException
        at java.util.zip.Inflater.ensureOpen(Inflater.java:325)
        at java.util.zip.Inflater.reset(Inflater.java:294)
        at java.util.zip.ZipFile.getInflater(ZipFile.java:372)
        at java.util.zip.ZipFile.getInputStream(ZipFile.java:320)
        at java.util.zip.ZipFile.getInputStream(ZipFile.java:286)
        at org.eclipse.osgi.baseadaptor.bundlefile.ZipBundleEntry.getInputStream(ZipBundleEntry.java:51)
        at org.eclipse.osgi.framework.internal.core.BundleURLConnection.connect(BundleURLConnection.java:53)
        at org.eclipse.osgi.framework.internal.core.BundleURLConnection.getInputStream(BundleURLConnection.java:99)
        at java.net.URL.openStream(URL.java:1007)
        at com.v8tech.mmc.adminsupport.newwizard.AdminPluginGeneratorServlet.writeBundle(AdminPluginGeneratorServlet.java:79)
        at com.v8tech.mmc.adminsupport.newwizard.AdminPluginGeneratorServlet.process(AdminPluginGeneratorServlet.java:55)</pre>
    </div>

    <div id="c1" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=193269#c1">Comment 1</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Thomas Watson</span> <a href="http://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=tjwatson&#64;us.ibm.com" alt="CLA" title="Eclipse Contributor Agreement" /></a> <a href="https://eclipse.org/donate/"><img class="cla_dec" src="//www.eclipse.org/donate/web-api/friends_decorator.php?email=tjwatson&#64;us.ibm.com" alt="Friend" title="Friend of Eclipse" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2007-06-19 10:19:49 EDT
        </span>

      </div>




<pre class="bz_comment_text">Is the configuration setting osgi.bundlefile.limit set?  I think this can happen if the zipfile is closed while you are reading from it.  That may happen if the osgi.bundlefile.limit is set to low and we are thrashing the zip open/close operations.

Or are is the bundle being uninstalled while you are reading from it?  That would close the zipfile also.</pre>
    </div>

    <div id="c2" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=193269#c2">Comment 2</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Michael Mangeng</span> <a href="http://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=mm&#64;vis.at" alt="CLA" title="Eclipse Contributor Agreement" /></a> <a href="https://eclipse.org/donate/"><img class="cla_dec" src="//www.eclipse.org/donate/web-api/friends_decorator.php?email=mm&#64;vis.at" alt="Friend" title="Friend of Eclipse" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2007-06-19 11:59:26 EDT
        </span>

      </div>




<pre class="bz_comment_text">No, osgi.bundlefile.limit is not set. I´ve set it to 1000 to test, but there is no difference (I set it with -Dosgi... - hope this is correct).

The bundle is also not being uninstalled.

Currently my test procedure is the following:
+ Export my project as feature of my server
+ Start the osgi framework
+ Make the first request in the browser =&gt; Exception
+ Make the second request in the browser =&gt; No exception
+ ... all following invokations return the correct result.


If i make the first request with the browser, the exception occurs. On the second request the data is created correctly.


(In reply to <a href="show_bug.cgi?id=193269#c1">comment #1</a>)
<span class="quote">&gt; Is the configuration setting osgi.bundlefile.limit set?  I think this can
&gt; happen if the zipfile is closed while you are reading from it.  That may happen
&gt; if the osgi.bundlefile.limit is set to low and we are thrashing the zip
&gt; open/close operations.
&gt; 
&gt; Or are is the bundle being uninstalled while you are reading from it?  That
&gt; would close the zipfile also.
&gt; </span >

</pre>
    </div>

    <div id="c3" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=193269#c3">Comment 3</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Thomas Watson</span> <a href="http://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=tjwatson&#64;us.ibm.com" alt="CLA" title="Eclipse Contributor Agreement" /></a> <a href="https://eclipse.org/donate/"><img class="cla_dec" src="//www.eclipse.org/donate/web-api/friends_decorator.php?email=tjwatson&#64;us.ibm.com" alt="Friend" title="Friend of Eclipse" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2007-06-20 09:14:20 EDT
        </span>

      </div>




<pre class="bz_comment_text">How many bundles do you have in your target?  Do you reproduce when launching from PDE or only when launching externally as a built product.  Can you attach a test bundle with a set of steps to reproduce.  If osgi.bundlefile.limit is not set then I do not know what is going on.  

It appears that someone is closing the zipfile but nothing should do that unless a bundle is uninstalled or a refresh packages is occurring.  Do you see anything in your log file when this occurs?  Please attach the log if so.  Thanks.</pre>
    </div>

    <div id="c4" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=193269#c4">Comment 4</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Michael Mangeng</span> <a href="http://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=mm&#64;vis.at" alt="CLA" title="Eclipse Contributor Agreement" /></a> <a href="https://eclipse.org/donate/"><img class="cla_dec" src="//www.eclipse.org/donate/web-api/friends_decorator.php?email=mm&#64;vis.at" alt="Friend" title="Friend of Eclipse" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2007-06-26 10:42:45 EDT
        </span>

      </div>




<pre class="bz_comment_text">I´ve only tested after i exported the application. I´ve never launched the app within the PDE.
After a few other tests i was also able to reproduce the problem within the knopflerfish framework. Maybe my code causes the bug but as you can see, its very trivial.

Currently it looks like that the exception does only occur if:
+ The bundle is exported as jar
+ The URL to a bundleentry must be retrieved via Bundle.findEntries(...) or Bundle.getEntry(...).
+ The thread invoking url.openConnection is NOT the osgi-thread which invokes the life-cycle methods start() or stop() of the BundleActivator. In my case, its a thread from the webserver. If i try to access the data within this thread, it works in all cases. (And no - my bundle is not stopped before the other thread tries to access the data :-))

Another interesting point is that the exception only occurs on the first request of url.openConnection(). On the second request, the entry is returned correctly.

I´ll do further investigations and I´ll try to create a setup with which you can reproduce the bug.

</pre>
    </div>

    <div id="c5" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=193269#c5">Comment 5</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Thomas Watson</span> <a href="http://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=tjwatson&#64;us.ibm.com" alt="CLA" title="Eclipse Contributor Agreement" /></a> <a href="https://eclipse.org/donate/"><img class="cla_dec" src="//www.eclipse.org/donate/web-api/friends_decorator.php?email=tjwatson&#64;us.ibm.com" alt="Friend" title="Friend of Eclipse" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2007-06-27 08:06:25 EDT
        </span>

      </div>




<pre class="bz_comment_text">You mention multiple threads.  Is one of the threads installing the bundles for the first time? or does this happen from a cached install when accessing the bundle data for the first time in an instance of the framework?</pre>
    </div>

    <div id="c6" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=193269#c6">Comment 6</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Michael Mangeng</span> <a href="http://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=mm&#64;vis.at" alt="CLA" title="Eclipse Contributor Agreement" /></a> <a href="https://eclipse.org/donate/"><img class="cla_dec" src="//www.eclipse.org/donate/web-api/friends_decorator.php?email=mm&#64;vis.at" alt="Friend" title="Friend of Eclipse" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2007-06-27 08:35:59 EDT
        </span>

      </div>




<pre class="bz_comment_text">The exception occurs regardless of weather it´s a cached launch or not. (Deleting all in datadir except config.ini).

The thread accessing the bundle content has nothing to do with the deployment of the bundle. The bundle is deployed via the osgi.bundles property in config.ini.

After the full framework launch I use a browser to do a request on the servlet which uses Activator.getInstance().getBundleContext() and tries to retrieve bundledata. Then the exception occurs (The first time). The second request (hitting F5 to the browser) is ok. Also the time between the startup of the framework and the request with the browser has no effect on the bug.
</pre>
    </div>

    <div id="c7" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=193269#c7">Comment 7</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Thomas Watson</span> <a href="http://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=tjwatson&#64;us.ibm.com" alt="CLA" title="Eclipse Contributor Agreement" /></a> <a href="https://eclipse.org/donate/"><img class="cla_dec" src="//www.eclipse.org/donate/web-api/friends_decorator.php?email=tjwatson&#64;us.ibm.com" alt="Friend" title="Friend of Eclipse" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2007-07-30 12:01:38 EDT
        </span>

      </div>




<pre class="bz_comment_text">Any chance you could attach an example we can use to reproduce?  Also is this only reproduced on Linux or does it happen on other OS's</pre>
    </div>

    <div id="c8" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=193269#c8">Comment 8</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Richie Jefts</span> <a href="http://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=rjefts&#64;gmail.com" alt="CLA" title="Eclipse Contributor Agreement" /></a> <a href="https://eclipse.org/donate/"><img class="cla_dec" src="//www.eclipse.org/donate/web-api/friends_decorator.php?email=rjefts&#64;gmail.com" alt="Friend" title="Friend of Eclipse" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2007-08-15 14:58:18 EDT
        </span>

      </div>




<pre class="bz_comment_text">I have seen the same exception under similar circumstances. A web server thread is trying to load a resource through Bundle.getResource(). In my case it occurs on Linux and Windows. I have not yet been able to produce a small test case.</pre>
    </div>

    <div id="c9" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=193269#c9">Comment 9</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">John DiCamillo</span> <a href="http://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=milod&#64;cox.net" alt="CLA" title="Eclipse Contributor Agreement" /></a> <a href="https://eclipse.org/donate/"><img class="cla_dec" src="//www.eclipse.org/donate/web-api/friends_decorator.php?email=milod&#64;cox.net" alt="Friend" title="Friend of Eclipse" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2008-01-05 16:34:19 EST
        </span>

      </div>




<pre class="bz_comment_text">I can reproduce this exception 100% of the time on Windows using Java 6 JDK (update 3).  I am trying to integrate OSGi, Jetty 6.1.6, and Glassfish JSP compiler as an embedded web server in a desktop application.  I am trying to package the web resources in an OSGi bundle.  Jetty is able to serve static content from the bundle just fine, but when I try to access a JSP file, one or more of the resources will result in this NullPointerException.

This is obviously not a small test case, as it requires more than a dozen bundles.

I have instrumented org.eclipse.osgi.baseadaptor.bundlefile.ZipBundleFile and
org.eclipse.osgi.baseadaptor.bundlefile.ZipBundleEntry in a local version of the OSGi core.  I am catching the NPE in ZipBundleEntry and dumping the state of the MRU Zip Bundle File cache:


Caught Exeption: java.lang.NullPointerException
ZIP Entry:       web/WEB-INF/lib/jstl-1.1.1.jar
Bundle File:     ZipBundleFile [H:\...\milo.web_1.0.0.jar ] 103

MRU Bundle File List: 14 open files out of 100
INDEX   MRU    BUNDLE
-----  -----   -----------------------------------------------------
   0:    675 - ZipBundleFile [H:\...\org.eclipse.osgi_3.4.0.milo.jar ] 551
   1:    694 - ZipBundleFile [H:\...\milo.shell_1.0.0.jar ] 159
   2:   1857 - ZipBundleFile [H:\...\milo.web_1.0.0.jar ] 103
   3:   1053 - ZipBundleFile [H:\...\milo.net_1.0.0.jar ] 182
   4:   1651 - ZipBundleFile [H:\...\org.getahead.dwr_2.0.1.jar ] 362
   5:   1767 - ZipBundleFile [H:\...\org.mortbay.jetty_6.1.6.jar ] 246
   6:   1765 - ZipBundleFile [H:\...\org.mortbay.jetty.util_6.1.6.jar ] 97
   7:   1695 - ZipBundleFile [H:\...\javax.servlet_2.5.0.jar ] 78
   8:    950 - ZipBundleFile [H:\...\milo.platform_1.0.0.jar ] 29
   9:    677 - ZipBundleFile [H:\...\milo.parser_1.0.0.jar ] 24
  10:   1849 - ZipBundleFile [H:\...\org.mortbay.jetty.jsp_6.1.6.jar ] 2759
  11:    684 - ZipBundleFile [H:\...\org.apache.commons_1.0.0.jar ] 585
  12:    792 - ZipBundleFile [H:\...\org.apache.log4j_1.0.0.jar ] 274
  13:    686 - ZipBundleFile [H:\...\org.apache.xerces_2.8.0.jar ] 1323

java.lang.NullPointerException
        at java.util.zip.Inflater.ensureOpen(Unknown Source)
        at java.util.zip.Inflater.reset(Unknown Source)
        at java.util.zip.ZipFile.getInflater(Unknown Source)
        at java.util.zip.ZipFile.getInputStream(Unknown Source)
        at java.util.zip.ZipFile.getInputStream(Unknown Source)
(etc.)

In the above printout, the number at the end of each line indicates the number of entries in the zip file associated with the ZipBundleFile.  The fact that I can print those out after the exception has occurred suggests that the ZIP file has NOT been closed.  The Inflater must have been invalidated by some other means, which admittedly sounds impossible.

I've been trying to find a way to &quot;see inside&quot; the java.util.ZipFile and its private vector of Inflaters, but no luck so far.</pre>
    </div>

    <div id="c10" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=193269#c10">Comment 10</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">John DiCamillo</span> <a href="http://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=milod&#64;cox.net" alt="CLA" title="Eclipse Contributor Agreement" /></a> <a href="https://eclipse.org/donate/"><img class="cla_dec" src="//www.eclipse.org/donate/web-api/friends_decorator.php?email=milod&#64;cox.net" alt="Friend" title="Friend of Eclipse" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2008-01-05 18:05:19 EST
        </span>

      </div>




<pre class="bz_comment_text">Followup:  I used reflection to hack into the ZipFile object, and found that several of its Inflaters had been returned to the cache in an invalid state.  Still no idea how they are being closed, but there it is.

Is there any way to debug an Equinox application in Eclipse such that the code is loaded from the bundle jars?  Whenever I try to debug my app, Eclipse seems to unpack everything and use DirBundles instead of ZipBundles.  It kind of defeats the purpose in this case.

Workaround (i.e. Grotesque hack that gets around the bug):

public class ZipBundleFile {

    protected synchronized ZipFile getZipFile() throws IOException {
        if (closed) {
            mruList.add(this);
            zipFile = basicOpen();
            closed = false;
        } else {
            mruList.use(this);
            cleanZipInflaterPool(); // &lt;== NEW LINE
        }
        return zipFile;
    }

    // SERIOUSLY MAJOR HACK!
    synchronized void cleanZipInflaterPool() {
        try {
            Class zipClass = java.util.zip.ZipFile.class;
            Class infClass = java.util.zip.Inflater.class;

            Field fieldInflaters = zipClass.getDeclaredField(&quot;inflaters&quot;);
            fieldInflaters.setAccessible(true);

            Field fieldStrm = infClass.getDeclaredField(&quot;strm&quot;);
            fieldStrm.setAccessible(true);

            Vector inflaters = (Vector) fieldInflaters.get(zipFile);
            synchronized (inflaters) {
                for (int i = inflaters.size() - 1; i &gt;= 0; i--) {
                    Object inf = inflaters.elementAt(i);
                    if (fieldStrm.getLong(inf) == 0L) {
                        // this inflater is invalid, 
                        // remove it from the list!
                        inflaters.remove(i);
                    }
                }
            }
        } catch (Exception ignored) { }
    }
</pre>
    </div>

    <div id="c11" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=193269#c11">Comment 11</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">csnyder&#64;mvpsoft.com</span> <a href="http://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=csnyder&#64;mvpsoft.com" alt="CLA" title="Eclipse Contributor Agreement" /></a> <a href="https://eclipse.org/donate/"><img class="cla_dec" src="//www.eclipse.org/donate/web-api/friends_decorator.php?email=csnyder&#64;mvpsoft.com" alt="Friend" title="Friend of Eclipse" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2008-03-28 17:38:27 EDT
        </span>

      </div>




<pre class="bz_comment_text">I'm encountering this bug as well. Configuration info:

64-bit Sun Java 1.6.0_03-b05 VM

Linux 2.6.22 (Ubuntu 7.10 distribution)

Equinox 3.3.2.R33x_v20080105

The bundles that are giving me problems are being deployed dynamically by the dirdeployer bundle from Knopflerfish. When I unzip the bundles (and give the resulting directories .jar extensions to trick dirdeployer into deploying them) they work fine.</pre>
    </div>

    <div id="c12" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=193269#c12">Comment 12</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Martin</span> <a href="http://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=martin&#64;zdila.sk" alt="CLA" title="Eclipse Contributor Agreement" /></a> <a href="https://eclipse.org/donate/"><img class="cla_dec" src="//www.eclipse.org/donate/web-api/friends_decorator.php?email=martin&#64;zdila.sk" alt="Friend" title="Friend of Eclipse" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2009-05-13 12:27:51 EDT
        </span>

      </div>




<pre class="bz_comment_text">please check the very simmilar issue in the Apache Felix 1.6.1: <a href="https://issues.apache.org/jira/browse/FELIX-1032">https://issues.apache.org/jira/browse/FELIX-1032</a></pre>
    </div>

    <div id="c13" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=193269#c13">Comment 13</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Thomas Watson</span> <a href="http://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=tjwatson&#64;us.ibm.com" alt="CLA" title="Eclipse Contributor Agreement" /></a> <a href="https://eclipse.org/donate/"><img class="cla_dec" src="//www.eclipse.org/donate/web-api/friends_decorator.php?email=tjwatson&#64;us.ibm.com" alt="Friend" title="Friend of Eclipse" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2009-06-25 17:34:44 EDT
        </span>

      </div>




<pre class="bz_comment_text">Richard Hall from felix discussed this issue more with me in great detail.  It appears someone is wrapping the input stream from a bundle resource which ends up being a stream from ZipFile.getInputStream.  This wrapper object then has a finalize method that ends up closing the wrappered stream.

This appears to also cause finalize to be called transitively on all objects referenced by the wrapper object.  This ends up including the Inflater object.  What appears to happen is that the close() operation on the input stream makes the Inflater available for reuse but then the Inflator has its finalize method called by the GC which invalidates it.  In the case Richard saw the class org.mortbay.resource.URLResource wrapped the input stream and called close on it during URLResource.finalize().  It appears somewhere there is a potential bug where a resource is not properly closed and it they is depending on GC to clean up the and close the stream.  Unfortunately this practice seems to expose this issue.

</pre>
    </div>

    <div id="c14" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=193269#c14">Comment 14</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Thomas Watson</span> <a href="http://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=tjwatson&#64;us.ibm.com" alt="CLA" title="Eclipse Contributor Agreement" /></a> <a href="https://eclipse.org/donate/"><img class="cla_dec" src="//www.eclipse.org/donate/web-api/friends_decorator.php?email=tjwatson&#64;us.ibm.com" alt="Friend" title="Friend of Eclipse" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2009-06-25 17:46:26 EDT
        </span>

      </div>




<pre class="bz_comment_text">Here are some more details from Richard:

I investigated this bug rather thoroughly and have come to the conclusion that it is a JRE bug. This is what is happening:

ZipFile.getInputStream() returns an instance of an anonymous subclass of InflaterInputStream.

InflaterInputStream is constructed with an Inflater instance coming from a pool of inflaters in ZipFile.

The InflaterInputStream subclass inserts the Inflater back into the ZipFile inflater pool on close(); note that InflaterInputStream subclass instance is does not call close() on itself in its finalizer.

So, if this InflaterInputStream is wrapped in another InputStream and/or object that does call close() on it from the wrapper's finalizer(), then we run into a potential issue.

What I am seeing is there is no reference to the wrapper, then the garbage collector is trying to finalize the wrapper, the InflaterInputStream subclass, and the Inflater inside it. In this case, the wrapper's finalizer() calls close() on the InflaterInputStream subclass which inserts a reference of its Inflater back into the ZipFile's inflater pool. Then the garbage collector continues to call finalize() on the other objects. In particular, Inflater.finalize() calls end() on itself, which invalidates the Inflater for future use.

This the crux of the issue, since we now have an invalid Inflater in the ZipFile's inflater pool.

Since it is not uncommon for people to close() in finalizers, I think the JRE should not have side effects like this in close. The JRE should be modified such that ZipFile does not simply remove Inflater instances from its &quot;unused&quot; pool when creating InflaterInputStreams, it should also insert them into another &quot;used&quot; pool to keep a hard reference to them. That way it won't get GC'd in the above scenario and end() won't be called on it to invalidate it.

Until that happens, the work around it to explicitly call close() on all input streams rather than doing it in the finalizer.

In this particular cases, it looks like mortbay was not explicitly closing a resource input stream, since I saw this stack trace snippet:

!!! Thread[Finalizer,8,system] RELEASING INFLATER java.util.zip.Inflater&#64;f96093
!!! Thread[Finalizer,8,system] java.lang.Thread.getStackTrace(Thread.java:1436)
!!! Thread[Finalizer,8,system] java.util.zip.ZipFile.releaseInflater(ZipFile.java:280)
!!! Thread[Finalizer,8,system] java.util.zip.ZipFile.access$000(ZipFile.java:29)
!!! Thread[Finalizer,8,system] java.util.zip.ZipFile$1.close(ZipFile.java:217)
!!! Thread[Finalizer,8,system] org.mortbay.resource.URLResource.release(URLResource.java:82)</pre>
    </div>

    <div id="c15" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=193269#c15">Comment 15</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Eclipse Webmaster</span> <a href="http://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=webmaster&#64;eclipse.org" alt="CLA" title="Eclipse Contributor Agreement" /></a> <a href="https://eclipse.org/donate/"><img class="cla_dec" src="//www.eclipse.org/donate/web-api/friends_decorator.php?email=webmaster&#64;eclipse.org" alt="Friend" title="Friend of Eclipse" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2019-09-06 15:30:07 EDT
        </span>

      </div>




<pre class="bz_comment_text">This bug hasn't had any activity in quite some time. Maybe the problem got resolved, was a duplicate of something else, or became less pressing for some reason - or maybe it's still relevant but just hasn't been looked at yet.

If you have further information on the current state of the bug, please add it. The information can be, for example, that the problem still occurs, that you still want the feature, that more information is needed, or that the bug is (for whatever reason) no longer relevant.</pre>
    </div>

    <div id="c16" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=193269#c16">Comment 16</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Thomas Watson</span> <a href="http://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=tjwatson&#64;us.ibm.com" alt="CLA" title="Eclipse Contributor Agreement" /></a> <a href="https://eclipse.org/donate/"><img class="cla_dec" src="//www.eclipse.org/donate/web-api/friends_decorator.php?email=tjwatson&#64;us.ibm.com" alt="Friend" title="Friend of Eclipse" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2020-02-07 16:02:30 EST
        </span>

      </div>




<pre class="bz_comment_text">I think with modern versions of the JVM this is no longer an issue.</pre>
    </div>


  

</td>
<td>
</td>
</tr></table>
  </div>
        

</form>

<hr>
<ul class="related_actions">
    <li><a href="show_bug.cgi?format=multiple&amp;id=193269">Format For Printing</a></li>
    <li>&nbsp;-&nbsp;<a href="show_bug.cgi?ctype=xml&amp;id=193269">XML</a></li>
    <li>&nbsp;-&nbsp;<a href="enter_bug.cgi?cloned_bug_id=193269">Clone This Bug</a></li>
    
    <li>&nbsp;-&nbsp;<a href="#">Top of page </a></li>
    </ul>

<br>
</div>

    <div id="footer">
      <div class="intro"></div>
<ul id="useful-links">
  <li id="links-actions"><ul class="links">
  <li><a href="./">Home</a></li>
  <li><span class="separator">| </span><a href="enter_bug.cgi">New</a></li>
  <li><span class="separator">| </span><a href="describecomponents.cgi">Browse</a></li>
  <li><span class="separator">| </span><a href="query.cgi">Search</a></li>

  <li class="form">
    <span class="separator">| </span>
    <form action="buglist.cgi" method="get"
        onsubmit="if (this.quicksearch.value == '')
                  { alert('Please enter one or more search terms first.');
                    return false; } return true;">
    <input type="hidden" id="no_redirect_bottom" name="no_redirect" value="0">
    <script type="text/javascript">
      if (history && history.replaceState) {
        var no_redirect = document.getElementById("no_redirect_bottom");
        no_redirect.value = 1;
      }
    </script>
    <input class="txt" type="text" id="quicksearch_bottom" name="quicksearch" 
           title="Quick Search" value="">
    <input class="btn" type="submit" value="Search" 
           id="find_bottom"></form>
  <a href="page.cgi?id=quicksearch.html" title="Quicksearch Help">[?]</a></li>

  <li><span class="separator">| </span><a href="report.cgi">Reports</a></li>

  <li>
      <span class="separator">| </span>
        <a href="request.cgi">Requests</a></li>


  <li>
        <span class="separator">| </span>
        <a href="https://bugzilla.readthedocs.org/en/5.0/using/understanding.html" target="_blank">Help</a>
      </li>
    

    <li id="mini_login_container_bottom">
  <span class="separator">| </span>
  <a id="login_link_bottom" href="show_bug.cgi?id=193269&amp;GoAheadAndLogIn=1"
     onclick="return show_mini_login_form('_bottom')">Log In</a>

  <form action="show_bug.cgi?id=193269" method="POST"
        class="mini_login bz_default_hidden"
        id="mini_login_bottom">
    <input id="Bugzilla_login_bottom" required
           name="Bugzilla_login" class="bz_login"
        placeholder="Login">
    <input class="bz_password" name="Bugzilla_password" type="password"
           id="Bugzilla_password_bottom" required
           placeholder="Password">
    <input type="hidden" name="Bugzilla_login_token"
           value="">
    <input type="submit" name="GoAheadAndLogIn" value="Log in"
            id="log_in_bottom">
    <a href="#" onclick="return hide_mini_login_form('_bottom')">[x]</a>
  </form>
</li>
  <span class="separator">| </span>
  <li><a href="http://www.eclipse.org/legal/termsofuse.php">Terms of Use</a></li>
  <span class="separator">| </span>
  <li><a href="http://www.eclipse.org/legal/copyright.php">Copyright Agent</a></li>
</ul>
  </li>

  




  
</ul>

      <div class="outro"></div>
    </div>

  </body>
</html>
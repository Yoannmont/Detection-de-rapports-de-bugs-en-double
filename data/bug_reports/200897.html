<!DOCTYPE html>
<html lang="en">
  <head>
    <title>200897 &ndash; [variables] MIVariableManager needs to manage children of other variables.</title>

      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<link href="https://bugs.eclipse.org/bugs/data/assets/03c4bb46b12126a79867f9a9f5323634.css?1593441374" rel="stylesheet" type="text/css">



    
<script type="text/javascript" src="https://bugs.eclipse.org/bugs/data/assets/a7c2f3a028f17a9aa60f56dc9d6e732d.js?1593441374"></script>

    <script type="text/javascript">
    <!--
        YAHOO.namespace('bugzilla');
        YAHOO.util.Event.addListener = function (el, sType, fn, obj, overrideContext) {
               if ( ("onpagehide" in window || YAHOO.env.ua.gecko) && sType === "unload") { sType = "pagehide"; };
               var capture = ((sType == "focusin" || sType == "focusout") && !YAHOO.env.ua.ie) ? true : false;
               return this._addListener(el, this._getType(sType), fn, obj, overrideContext, capture);
         };
        if ( "onpagehide" in window || YAHOO.env.ua.gecko) {
            YAHOO.util.Event._simpleRemove(window, "unload", 
                                           YAHOO.util.Event._unload);
        }
        
        function unhide_language_selector() { 
            YAHOO.util.Dom.removeClass(
                'lang_links_container', 'bz_default_hidden'
            ); 
        } 
        YAHOO.util.Event.onDOMReady(unhide_language_selector);

        
        var BUGZILLA = {
            param: {
                cookiepath: '\/bugs',
                maxusermatches: 10
            },
            constant: {
                COMMENT_COLS: 80
            },
            string: {
                

                attach_desc_required:
                    "You must enter a Description for this attachment.",
                component_required:
                    "You must select a Component for this bug.",
                description_required:
                    "You must enter a Description for this bug.",
                short_desc_required:
                    "You must enter a Summary for this bug.",
                version_required:
                    "You must select a Version for this bug."
            }
              , api_token: ''
        };

    if (history && history.replaceState) {
      if(!document.location.href.match(/show_bug\.cgi/)) {
        history.replaceState( null,
                             "200897 – [variables] MIVariableManager needs to manage children of other variables.",
                             "show_bug.cgi?id=200897" );
        document.title = "200897 – [variables] MIVariableManager needs to manage children of other variables.";
      }
      if (document.location.href.match(/show_bug\.cgi\?.*list_id=/)) {
        var href = document.location.href;
        href = href.replace(/[\?&]+list_id=(\d+|cookie)/, '');
        history.replaceState(null, "200897 – [variables] MIVariableManager needs to manage children of other variables.", href);
      }
    }
    YAHOO.util.Event.onDOMReady(function() {
      initDirtyFieldTracking();

    });
    // -->
    </script>
<script type="text/javascript" src="https://bugs.eclipse.org/bugs/data/assets/daf5e0fb6826e6a35280e622913f0c4a.js?1593441374"></script>

    

    
    <link rel="search" type="application/opensearchdescription+xml"
                       title="Bugzilla" href="./search_plugin.cgi">
    <link rel="shortcut icon" href="images/favicon.ico">
  </head>

  <body 
        class="bugs-eclipse-org-bugs
                 bz_bug
                 bz_status_CLOSED
                 bz_product_CDT
                 bz_component_cdt-debug-dsf-gdb
                 bz_bug_200897 yui-skin-sam">

  <div id="header"><!-- 1.0@bugzilla.org -->





<!--  START OF SOLSTICE HEADER -->
 <link rel="stylesheet" type="text/css" href="https://www.eclipse.org/eclipse.org-common/themes/solstice/public/stylesheets/vendor/cookieconsent/cookieconsent.min.css" />
 <script src="https://www.eclipse.org/eclipse.org-common/themes/solstice/public/javascript/vendor/cookieconsent/default.min.js"></script>
 <style type="text/css">
    @import url('https://www.eclipse.org/eclipse.org-common/themes/solstice/public/stylesheets/barebone.min.css')
    </style>
    <script
      src="https://www.eclipse.org/eclipse.org-common/themes/solstice/public/javascript/barebone.min.js">
    </script><header role="banner" class="barebone-layout thin-header padding-top-5 padding-bottom-5"  id="header-wrapper">
  <div class="container-fluid reset">
    <div class="row-fluid" id="header-row">
            <div class="col-sm-8 col-md-6 col-lg-4" id="header-left">
        <div class="wrapper-logo-default"><a href="https://www.eclipse.org/"><img class="logo-eclipse-default img-responsive hidden-xs" alt="logo" src="https://bugs.eclipse.org/eclipse.org-common/themes/solstice/public/images/logo/eclipse-426x100.png"/></a></div>
      </div>            <div class="col-sm-16 col-md-18 col-lg-20" id="main-menu-wrapper">
  <div class="navbar yamm" id="main-menu">
    <div id="navbar-collapse-1" class="navbar-collapse collapse">
      <ul class="nav navbar-nav navbar-right">
        <li class="visible-thin"><a href="https://www.eclipse.org/downloads/" target="_self">Download</a></li><li><a href="https://www.eclipse.org/users/" target="_self">Getting Started</a></li><li><a href="https://www.eclipse.org/membership/" target="_self">Members</a></li><li><a href="https://www.eclipse.org/projects/" target="_self">Projects</a></li>                  <li class="dropdown visible-xs"><a href="#" data-toggle="dropdown" class="dropdown-toggle">Community <b class="caret"></b></a><ul class="dropdown-menu"><li><a href="http://marketplace.eclipse.org">Marketplace</a></li><li><a href="http://events.eclipse.org">Events</a></li><li><a href="http://www.planeteclipse.org/">Planet Eclipse</a></li><li><a href="https://www.eclipse.org/community/eclipse_newsletter/">Newsletter</a></li><li><a href="https://www.youtube.com/user/EclipseFdn">Videos</a></li></ul></li><li class="dropdown visible-xs"><a href="#" data-toggle="dropdown" class="dropdown-toggle">Participate <b class="caret"></b></a><ul class="dropdown-menu"><li><a href="https://bugs.eclipse.org/bugs/">Report a Bug</a></li><li><a href="https://www.eclipse.org/forums/">Forums</a></li><li><a href="https://www.eclipse.org/mail/">Mailing Lists</a></li><li><a href="https://wiki.eclipse.org/">Wiki</a></li><li><a href="https://wiki.eclipse.org/IRC">IRC</a></li><li><a href="https://www.eclipse.org/contribute/">How to Contribute</a></li></ul></li><li class="dropdown visible-xs"><a href="#" data-toggle="dropdown" class="dropdown-toggle">Working Groups <b class="caret"></b></a><ul class="dropdown-menu"><li><a href="http://wiki.eclipse.org/Auto_IWG">Automotive</a></li><li><a href="http://iot.eclipse.org">Internet of Things</a></li><li><a href="http://locationtech.org">LocationTech</a></li><li><a href="http://lts.eclipse.org">Long-Term Support</a></li><li><a href="http://polarsys.org">PolarSys</a></li><li><a href="http://science.eclipse.org">Science</a></li><li><a href="http://www.openmdm.org">OpenMDM</a></li></ul></li>          <!-- More -->
          <li class="dropdown eclipse-more hidden-xs">
            <a data-toggle="dropdown" class="dropdown-toggle">More<b class="caret"></b></a>
            <ul class="dropdown-menu">
              <li>
                <!-- Content container to add padding -->
                <div class="yamm-content">
                  <div class="row">
                    <ul class="col-sm-8 list-unstyled"><li><p><strong>Community</strong></p></li><li><a href="http://marketplace.eclipse.org">Marketplace</a></li><li><a href="http://events.eclipse.org">Events</a></li><li><a href="http://www.planeteclipse.org/">Planet Eclipse</a></li><li><a href="https://www.eclipse.org/community/eclipse_newsletter/">Newsletter</a></li><li><a href="https://www.youtube.com/user/EclipseFdn">Videos</a></li></ul><ul class="col-sm-8 list-unstyled"><li><p><strong>Participate</strong></p></li><li><a href="https://bugs.eclipse.org/bugs/">Report a Bug</a></li><li><a href="https://www.eclipse.org/forums/">Forums</a></li><li><a href="https://www.eclipse.org/mail/">Mailing Lists</a></li><li><a href="https://wiki.eclipse.org/">Wiki</a></li><li><a href="https://wiki.eclipse.org/IRC">IRC</a></li><li><a href="https://www.eclipse.org/contribute/">How to Contribute</a></li></ul><ul class="col-sm-8 list-unstyled"><li><p><strong>Working Groups</strong></p></li><li><a href="http://wiki.eclipse.org/Auto_IWG">Automotive</a></li><li><a href="http://iot.eclipse.org">Internet of Things</a></li><li><a href="http://locationtech.org">LocationTech</a></li><li><a href="http://lts.eclipse.org">Long-Term Support</a></li><li><a href="http://polarsys.org">PolarSys</a></li><li><a href="http://science.eclipse.org">Science</a></li><li><a href="http://www.openmdm.org">OpenMDM</a></li></ul>                  </div>
                </div>
              </li>
            </ul>
          </li>
              </ul>
    </div>
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar-collapse-1">
      <span class="sr-only">Toggle navigation</span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      </button>
      <div class="wrapper-logo-mobile"><a class="navbar-brand visible-xs" href="https://www.eclipse.org/"><img class="logo-eclipse-default-mobile img-responsive" alt="logo" src="https://bugs.eclipse.org/eclipse.org-common/themes/solstice/public/images/logo/eclipse-800x188.png"/></a></div>    </div>
  </div>
</div>
    </div>
  </div>
</header>
<!--  END OF SOLSTICE HEADER -->

    <div id="titles">
      <span id="title">Bugzilla &ndash; Bug&nbsp;200897</span>

        <span id="subtitle" class="subheader">[variables] MIVariableManager needs to manage children of other variables.</span>

        <span id="information" class="header_addl_info">Last modified: 2014-01-29 20:20:34 EST</span>
    </div>


    <div id="common_links"><ul class="links">
  <li><a href="./">Home</a></li>
  <li><span class="separator">| </span><a href="enter_bug.cgi">New</a></li>
  <li><span class="separator">| </span><a href="describecomponents.cgi">Browse</a></li>
  <li><span class="separator">| </span><a href="query.cgi">Search</a></li>

  <li class="form">
    <span class="separator">| </span>
    <form action="buglist.cgi" method="get"
        onsubmit="if (this.quicksearch.value == '')
                  { alert('Please enter one or more search terms first.');
                    return false; } return true;">
    <input type="hidden" id="no_redirect_top" name="no_redirect" value="0">
    <script type="text/javascript">
      if (history && history.replaceState) {
        var no_redirect = document.getElementById("no_redirect_top");
        no_redirect.value = 1;
      }
    </script>
    <input class="txt" type="text" id="quicksearch_top" name="quicksearch" 
           title="Quick Search" value="">
    <input class="btn" type="submit" value="Search" 
           id="find_top"></form>
  <a href="page.cgi?id=quicksearch.html" title="Quicksearch Help">[?]</a></li>

  <li><span class="separator">| </span><a href="report.cgi">Reports</a></li>

  <li>
      <span class="separator">| </span>
        <a href="request.cgi">Requests</a></li>


  <li>
        <span class="separator">| </span>
        <a href="https://bugzilla.readthedocs.org/en/5.0/using/understanding.html" target="_blank">Help</a>
      </li>
    

    <li id="mini_login_container_top">
  <span class="separator">| </span>
  <a id="login_link_top" href="show_bug.cgi?id=200897&amp;GoAheadAndLogIn=1"
     onclick="return show_mini_login_form('_top')">Log In</a>

  <form action="show_bug.cgi?id=200897" method="POST"
        class="mini_login bz_default_hidden"
        id="mini_login_top">
    <input id="Bugzilla_login_top" required
           name="Bugzilla_login" class="bz_login"
        placeholder="Login">
    <input class="bz_password" name="Bugzilla_password" type="password"
           id="Bugzilla_password_top" required
           placeholder="Password">
    <input type="hidden" name="Bugzilla_login_token"
           value="">
    <input type="submit" name="GoAheadAndLogIn" value="Log in"
            id="log_in_top">
    <a href="#" onclick="return hide_mini_login_form('_top')">[x]</a>
  </form>
</li>
  <span class="separator">| </span>
  <li><a href="http://www.eclipse.org/legal/termsofuse.php">Terms of Use</a></li>
  <span class="separator">| </span>
  <li><a href="http://www.eclipse.org/legal/copyright.php">Copyright Agent</a></li>
</ul>
    </div>
  </div>

  <div id="bugzilla-body">


<script type="text/javascript">
<!--

//-->
</script>

<form name="changeform" id="changeform" method="post" action="process_bug.cgi">

  <input type="hidden" name="delta_ts" value="2014-01-29 20:20:34">
  <input type="hidden" name="id" value="200897">
  <input type="hidden" name="token" value="1629862489-_WJssi2RA5uWXV9oYquLxlaJ3TaVCaFI0XQ5NugyHV8">
<div class="bz_short_desc_container edit_form">
     <a href="show_bug.cgi?id=200897"><b>Bug&nbsp;200897</b></a> <span id="summary_container" class="bz_default_hidden">
      - <span id="short_desc_nonedit_display">[variables] MIVariableManager needs to manage children of other variables.</span>
     </span>

    <div id="summary_input"><span class="field_label "
    id="field_label_short_desc">


  <a 
      title="The bug summary is a short sentence which succinctly describes what the bug is about."
      class="field_help_link"
      href="page.cgi?id=fields.html#short_desc"
  >Summary:</a>

</span>[variables] MIVariableManager needs to manage children of other variables.
    </div>
  </div>
  <script type="text/javascript">
    hideEditableField('summary_container',
                      'summary_input',
                      'summary_edit_action',
                      'short_desc',
                      '[variables] MIVariableManager needs to manage children of other variables.' );
  </script>
  <table class="edit_form">
    <tr>
      
      <td id="bz_show_bug_column_1" class="bz_show_bug_column">     
        <table>
          <tr>
    <th class="field_label">
      <a href="page.cgi?id=fields.html#bug_status">Status</a>:
    </th>
    <td id="bz_field_status">
      <span id="static_bug_status">CLOSED
          FIXED
      </span>
    </td>
  </tr>
<tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
<tr><th class="field_label "
    id="field_label_alias">


  <a 
      title="A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla."
      class="field_help_link"
      href="page.cgi?id=fields.html#alias"
  >Alias:</a>

</th>
    <td>
        None
    </td>
  </tr>
<tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
<tr><th class="field_label "
    id="field_label_product">


  <a 
      title="Bugs are categorised into Products and Components. Select a Classification to narrow down this list."
      class="field_help_link"
      href="describecomponents.cgi"
  >Product:</a>

</th>
  <td class="field_value "
      id="field_container_product" >CDT

</td>
    </tr>

    
    <tr class="bz_default_hidden"><th class="field_label "
    id="field_label_classification">


  <a 
      title="Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation."
      class="field_help_link"
      href="page.cgi?id=fields.html#classification"
  >Classification:</a>

</th>
  <td class="field_value "
      id="field_container_classification" >Tools

</td>
    </tr>
        
    
    
    <tr><th class="field_label "
    id="field_label_component">


  <a 
      title="Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list."
      class="field_help_link"
      href="describecomponents.cgi?product=CDT"
  >Component:</a>

</th>
  <td class="field_value "
      id="field_container_component" >cdt-debug-dsf-gdb

  (<a href="buglist.cgi?component=cdt-debug-dsf-gdb&amp;product=CDT&amp;bug_status=__open__"
      target="_blank">show other bugs</a>)
</td>
    </tr>
    <tr><th class="field_label "
    id="field_label_version">


  <a 
      title="The version field defines the version of the software the bug was found in."
      class="field_help_link"
      href="page.cgi?id=fields.html#version"
  >Version:</a>

</th>

      <td>0 DD 1.0 &#160; <a href="https://dev.eclipse.org/committers/bugs/bugz_manager.php"><img src="//dev.eclipse.org/small_icons/apps/accessories-text-editor.png" alt="Edit" title="Edit these values" /></a></td>
    </tr>
        
    
        
    <tr><th class="field_label "
    id="field_label_rep_platform">


  <a 
      title="The hardware platform the bug was observed on. Note: When searching, selecting the option &quot;All&quot; only finds bugs whose value for this field is literally the word &quot;All&quot;."
      class="field_help_link"
      href="page.cgi?id=fields.html#rep_platform"
  >Hardware:</a>

</th>
      <td class="field_value">PC
        Linux
      </td>
    </tr>
          <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
          
          <tr>
      <th class="field_label">
        <label  accesskey="i">
          <a href="page.cgi?id=fields.html#importance"><u>I</u>mportance</a></label>:
      </th>
      <td>P3
       enhancement<span id="votes_container">
    (<a href="page.cgi?id=voting/user.html&amp;bug_id=200897#vote_200897">vote</a>)
  </span>
      </td>
    </tr>

      <tr><th class="field_label "
    id="field_label_target_milestone">


  <a 
      title="The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it."
      class="field_help_link"
      href="page.cgi?id=fields.html#target_milestone"
  >Target Milestone:</a>

</th>
        <td>DD 1.0 &#160; <a href="https://dev.eclipse.org/committers/bugs/bugz_manager.php"><img src="//dev.eclipse.org/small_icons/apps/accessories-text-editor.png" alt="Edit" title="Edit these values" /></a></td>
      </tr>
          
          <tr><th class="field_label "
    id="field_label_assigned_to">


  <a 
      title="The person in charge of resolving the bug."
      class="field_help_link"
      href="page.cgi?id=fields.html#assigned_to"
  >Assignee:</a>

</th>
      <td><span class="vcard"><span class="fn">Marc Khouzam</span> <a href="http://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=marc.khouzam&#64;gmail.com" alt="CLA" title="Eclipse Contributor Agreement" /></a> <a href="https://eclipse.org/donate/"><img class="cla_dec" src="//www.eclipse.org/donate/web-api/friends_decorator.php?email=marc.khouzam&#64;gmail.com" alt="Friend" title="Friend of Eclipse" /></a>
</span>
      </td>
    </tr>

    <tr><th class="field_label "
    id="field_label_qa_contact">


  <a 
      title="The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved."
      class="field_help_link"
      href="page.cgi?id=fields.html#qa_contact"
  >QA Contact:</a>

</th>
      <td><span class="vcard">
</span>
      </td>
    </tr>
    <script type="text/javascript">
      assignToDefaultOnChange(['product', 'component'],
        'cdt-debug-dsf-gdb-inbox\x40eclipse.org',
        'jonah\x40kichwacoders.com');
    </script>
          <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
          <tr><th class="field_label "
    id="field_label_bug_file_loc">


  <a 
      title="Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen."
      class="field_help_link"
      href="page.cgi?id=fields.html#bug_file_loc"
  >URL:</a>

</th>
    <td>
      <span id="bz_url_input_area">
      </span>
    </td>
  </tr>

    <tr><th class="field_label "
    id="field_label_status_whiteboard">


  <a 
      title="Each bug has a free-form single line text entry box for adding tags and status information."
      class="field_help_link"
      href="page.cgi?id=fields.html#status_whiteboard"
  >Whiteboard:</a>

</th><td>  
  </td>
    </tr>

    <tr><th class="field_label "
    id="field_label_keywords">


  <a 
      title="You can add keywords from a defined list to bugs, in order to easily identify and group them."
      class="field_help_link"
      href="describekeywords.cgi"
  >Keywords:</a>

</th>
  <td class="field_value "
      id="field_container_keywords" >

</td>
    </tr>
          <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>

          
<tr><th class="field_label "
    id="field_label_dependson">


  <a 
      title="The bugs listed here must be resolved before this bug can be resolved."
      class="field_help_link"
      href="page.cgi?id=fields.html#dependson"
  >Depends on:</a>

</th>

  <td>
    <span id="dependson_input_area">
    </span>

  </td>
  </tr>
  
  <tr><th class="field_label "
    id="field_label_blocked">


  <a 
      title="This bug must be resolved before the bugs listed in this field can be resolved."
      class="field_help_link"
      href="page.cgi?id=fields.html#blocked"
  >Blocks:</a>

</th>

  <td>
    <span id="blocked_input_area">
    </span>
<a class="bz_bug_link 
          bz_status_CLOSED  bz_closed"
   title="CLOSED FIXED - [variables] Implement expression service using standard MI"
   href="show_bug.cgi?id=159696">159696</a> 
  </td>
  </tr>

    <tr>
      <th>&nbsp;</th>

      <td id="show_dependency_tree_or_graph">
        Show dependency <a href="showdependencytree.cgi?id=200897&amp;hide_resolved=1">tree</a>

      </td>
    </tr>
          
        </table>
      </td>
      <td>
        <div class="bz_column_spacer">&nbsp;</div>
      </td>
      
      <td id="bz_show_bug_column_2" class="bz_show_bug_column">
        <table>
        <tr>
    <th class="field_label">
      Reported:
    </th>
    <td>2007-08-23 01:53 EDT by <span class="vcard"><span class="fn">Pawel Piech</span> <a href="http://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=pawel.1.piech&#64;gmail.com" alt="CLA" title="Eclipse Contributor Agreement" /></a> <a href="https://eclipse.org/donate/"><img class="cla_dec" src="//www.eclipse.org/donate/web-api/friends_decorator.php?email=pawel.1.piech&#64;gmail.com" alt="Friend" title="Friend of Eclipse" /></a>
</span>
    </td>
  </tr>
  
  <tr>
    <th class="field_label">
      Modified:
    </th>
    <td>2014-01-29 20:20 EST
      (<a href="show_activity.cgi?id=200897">History</a>)
    </td>
  
  </tr>
<tr>
      <th class="field_label">
        <label  accesskey="a">
          CC List:
        </label>
      </th>
      <td>1 
          user
          <span id="cc_edit_area_showhide_container" class="bz_default_hidden">
            (<a href="#" id="cc_edit_area_showhide">show</a>)
          </span>
        <div id="cc_edit_area">
          <br>
            <select id="cc" multiple="multiple" size="5" >
                <option value="cdtdoug">cdtdoug</option>
            </select>
        </div>
          <script type="text/javascript">
            hideEditableField( 'cc_edit_area_showhide_container', 
                               'cc_edit_area', 
                               'cc_edit_area_showhide', 
                               '', 
                               '');  
          </script>
      </td>
    </tr>

<tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
<tr><th class="field_label "
    id="field_label_see_also">


  <a 
      title="This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields."
      class="field_help_link"
      href="page.cgi?id=fields.html#see_also"
  >See Also:</a>

</th>
  <td class="field_value "
      id="field_container_see_also" >

</td>
    </tr> 

<tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>



        </table>
      </td>
    </tr>
    <tr>
      <td colspan="3">
          <hr id="bz_top_half_spacer">
      </td>
    </tr>
  </table>

  <table id="bz_big_form_parts">
  <tr>
  <td>

    
<script type="text/javascript">
<!--
function toggle_display(link) {
    var table = document.getElementById("attachment_table");
    var view_all = document.getElementById("view_all");
    var hide_obsolete_url_parameter = "&hide_obsolete=1";
    // Store current height for scrolling later
    var originalHeight = table.offsetHeight;
    var rows = YAHOO.util.Dom.getElementsByClassName(
        'bz_tr_obsolete', 'tr', table);

    for (var i = 0; i < rows.length; i++) {
        bz_toggleClass(rows[i], 'bz_default_hidden');
    }

    if (YAHOO.util.Dom.hasClass(rows[0], 'bz_default_hidden')) {
        link.innerHTML = "Show Obsolete";
        view_all.href = view_all.href + hide_obsolete_url_parameter 
    }
    else {
        link.innerHTML = "Hide Obsolete";
        view_all.href = view_all.href.replace(hide_obsolete_url_parameter,"");
    }

    var newHeight = table.offsetHeight;
    // This scrolling makes the window appear to not move at all.
    window.scrollBy(0, newHeight - originalHeight);

    return false;
}
//-->
</script>

<br>
<table id="attachment_table">
  <tr id="a0">
    <th colspan="3" class="left">
      Attachments
    </th>
  </tr>


      <tr id="a1" class="bz_contenttype_text_plain bz_patch bz_tr_obsolete bz_default_hidden">
        <td>
            <a href="attachment.cgi?id=84352"
               title="View the content of the attachment">
          <b><span class="bz_obsolete">Patch which sorts parents to come after children in variable cache.</span></b></a>

          <span class="bz_attach_extra_info">
              (4.20 KB,
                patch)

            <br>
            <a href="#attach_84352"
               title="Go to the comment associated with the attachment">2007-12-03 15:03 EST</a>,

            <span class="vcard"><span class="fn">Pawel Piech</span> <a href="http://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=pawel.1.piech&#64;gmail.com" alt="CLA" title="Eclipse Contributor Agreement" /></a> <a href="https://eclipse.org/donate/"><img class="cla_dec" src="//www.eclipse.org/donate/web-api/friends_decorator.php?email=pawel.1.piech&#64;gmail.com" alt="Friend" title="Friend of Eclipse" /></a>
</span>
          </span>
        </td>

          <td class="bz_attach_flags">
              <i>no flags</i>
          </td>

        <td>
          <a href="attachment.cgi?id=84352&amp;action=edit">Details</a>
            | <a href="attachment.cgi?id=84352&amp;action=diff">Diff</a>
        </td>
      </tr>
      <tr id="a2" class="bz_contenttype_text_plain bz_patch bz_tr_obsolete bz_default_hidden">
        <td>
            <a href="attachment.cgi?id=84566"
               title="View the content of the attachment">
          <b><span class="bz_obsolete">Small fixes to previous patch</span></b></a>

          <span class="bz_attach_extra_info">
              (4.79 KB,
                patch)

            <br>
            <a href="#attach_84566"
               title="Go to the comment associated with the attachment">2007-12-05 15:42 EST</a>,

            <span class="vcard"><span class="fn">Marc Khouzam</span> <a href="http://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=marc.khouzam&#64;gmail.com" alt="CLA" title="Eclipse Contributor Agreement" /></a> <a href="https://eclipse.org/donate/"><img class="cla_dec" src="//www.eclipse.org/donate/web-api/friends_decorator.php?email=marc.khouzam&#64;gmail.com" alt="Friend" title="Friend of Eclipse" /></a>
</span>
          </span>
        </td>

          <td class="bz_attach_flags">
              <i>no flags</i>
          </td>

        <td>
          <a href="attachment.cgi?id=84566&amp;action=edit">Details</a>
            | <a href="attachment.cgi?id=84566&amp;action=diff">Diff</a>
        </td>
      </tr>
      <tr id="a3" class="bz_contenttype_text_plain bz_patch bz_tr_obsolete bz_default_hidden">
        <td>
            <a href="attachment.cgi?id=84591"
               title="View the content of the attachment">
          <b><span class="bz_obsolete">Patch with alternative put() override.</span></b></a>

          <span class="bz_attach_extra_info">
              (2.89 KB,
                patch)

            <br>
            <a href="#attach_84591"
               title="Go to the comment associated with the attachment">2007-12-05 23:02 EST</a>,

            <span class="vcard"><span class="fn">Pawel Piech</span> <a href="http://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=pawel.1.piech&#64;gmail.com" alt="CLA" title="Eclipse Contributor Agreement" /></a> <a href="https://eclipse.org/donate/"><img class="cla_dec" src="//www.eclipse.org/donate/web-api/friends_decorator.php?email=pawel.1.piech&#64;gmail.com" alt="Friend" title="Friend of Eclipse" /></a>
</span>
          </span>
        </td>

          <td class="bz_attach_flags">
              <i>no flags</i>
          </td>

        <td>
          <a href="attachment.cgi?id=84591&amp;action=edit">Details</a>
            | <a href="attachment.cgi?id=84591&amp;action=diff">Diff</a>
        </td>
      </tr>
      <tr id="a4" class="bz_contenttype_text_plain bz_patch">
        <td>
            <a href="attachment.cgi?id=84782"
               title="View the content of the attachment">
          <b>Final path for LRU</b></a>

          <span class="bz_attach_extra_info">
              (2.79 KB,
                patch)

            <br>
            <a href="#attach_84782"
               title="Go to the comment associated with the attachment">2007-12-07 15:59 EST</a>,

            <span class="vcard"><span class="fn">Marc Khouzam</span> <a href="http://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=marc.khouzam&#64;gmail.com" alt="CLA" title="Eclipse Contributor Agreement" /></a> <a href="https://eclipse.org/donate/"><img class="cla_dec" src="//www.eclipse.org/donate/web-api/friends_decorator.php?email=marc.khouzam&#64;gmail.com" alt="Friend" title="Friend of Eclipse" /></a>
</span>
          </span>
        </td>

          <td class="bz_attach_flags">
                  <span title="Doug Schaefer">cdtdoug</span>:
                iplog-
                <br>
          </td>

        <td>
          <a href="attachment.cgi?id=84782&amp;action=edit">Details</a>
            | <a href="attachment.cgi?id=84782&amp;action=diff">Diff</a>
        </td>
      </tr>
      <tr id="a5" class="bz_contenttype_text_plain bz_patch">
        <td>
            <a href="attachment.cgi?id=85399"
               title="View the content of the attachment">
          <b>Handling of children and relative expressions</b></a>

          <span class="bz_attach_extra_info">
              (51.96 KB,
                patch)

            <br>
            <a href="#attach_85399"
               title="Go to the comment associated with the attachment">2007-12-17 13:00 EST</a>,

            <span class="vcard"><span class="fn">Marc Khouzam</span> <a href="http://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=marc.khouzam&#64;gmail.com" alt="CLA" title="Eclipse Contributor Agreement" /></a> <a href="https://eclipse.org/donate/"><img class="cla_dec" src="//www.eclipse.org/donate/web-api/friends_decorator.php?email=marc.khouzam&#64;gmail.com" alt="Friend" title="Friend of Eclipse" /></a>
</span>
          </span>
        </td>

          <td class="bz_attach_flags">
                  <span title="Doug Schaefer">cdtdoug</span>:
                iplog-
                <br>
          </td>

        <td>
          <a href="attachment.cgi?id=85399&amp;action=edit">Details</a>
            | <a href="attachment.cgi?id=85399&amp;action=diff">Diff</a>
        </td>
      </tr>

  <tr class="bz_attach_footer">
    <td colspan="3">
        <span class="bz_attach_view_hide">
            <a href="#a0" onclick="return toggle_display(this);">Show
              Obsolete</a> (3)
            <a id="view_all" href="attachment.cgi?bugid=200897&amp;action=viewall&amp;hide_obsolete=1">View All</a>
        </span>
        <a href="attachment.cgi?bugid=200897&amp;action=enter">Add an attachment</a>
        (proposed patch, testcase, etc.)
    </td>
  </tr>
</table>
<br>
<div id="add_comment" class="bz_section_additional_comments">
      <table>
        <tr>
          <td>
            <fieldset>
              <legend>Note</legend>
              You need to
              <a href="show_bug.cgi?id=200897&amp;GoAheadAndLogIn=1">log in</a>
              before you can comment on or make changes to this bug.
            </fieldset>
          </td>
        </tr> 
      </table>
  </div>
  </td>
  <td>
  </td>
  </tr></table>

  
  <div id="comments"><script src="https://bugs.eclipse.org/bugs/js/comments.js?1463425338" type="text/javascript">
</script>

<script type="text/javascript">
<!--
  /* Adds the reply text to the 'comment' textarea */
  function replyToComment(id, real_id, name) {
      var prefix = "(In reply to " + name + " from comment #" + id + ")\n";
      var replytext = "";
        /* pre id="comment_name_N" */
        var text_elem = document.getElementById('comment_text_'+id);
        var text = getText(text_elem);
        replytext = prefix + wrapReplyText(text);


      /* <textarea id="comment"> */
      var textarea = document.getElementById('comment');
      if (textarea.value != replytext) {
          textarea.value += replytext;
      }

      textarea.focus();
  } 
//-->
</script>


<!-- This auto-sizes the comments and positions the collapse/expand links 
     to the right. -->
<table class="bz_comment_table">
<tr>
<td>
<div id="c0" class="bz_comment bz_first_comment">

      <div class="bz_first_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=200897#c0">Description</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Pawel Piech</span> <a href="http://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=pawel.1.piech&#64;gmail.com" alt="CLA" title="Eclipse Contributor Agreement" /></a> <a href="https://eclipse.org/donate/"><img class="cla_dec" src="//www.eclipse.org/donate/web-api/friends_decorator.php?email=pawel.1.piech&#64;gmail.com" alt="Friend" title="Friend of Eclipse" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2007-08-23 01:53:37 EDT
        </span>

      </div>




<pre class="bz_comment_text">Variable objects are typically created for a given expression using the -var-create command.  However they are also created automatically when children of a variable are retrieved.  These child variables are automatically deleted when the parent variable is deleted.

The MIVariableManager needs to track the children variables and take care not to delete a variable who's children are are in use.</pre>
    </div>

    <div id="c1" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=200897#c1">Comment 1</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Marc Khouzam</span> <a href="http://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=marc.khouzam&#64;gmail.com" alt="CLA" title="Eclipse Contributor Agreement" /></a> <a href="https://eclipse.org/donate/"><img class="cla_dec" src="//www.eclipse.org/donate/web-api/friends_decorator.php?email=marc.khouzam&#64;gmail.com" alt="Friend" title="Friend of Eclipse" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2007-11-27 09:51:34 EST
        </span>

      </div>




<pre class="bz_comment_text">The question of deleting variable objects is pretty complex due to the fact that deleting parent objects automatically deletes all children.

The first approach chosen in the GDB/MI implementation for DSF, for deletion of variable objects was to define a Maximum number of variable objects.  Once that maximum was reached, when a new var object was created, we would attempt to delete another var object, based on the LeastRecentlyUsed algorithm.  The main problem with this approach was that the LRU object may sometimes be the parent of objects, currently in use; this meant that we could not delete the parent, or we would delete all its children; so, not deleting the parent would then lead to having more variable objects that our established maximum.

Keeping the number of variable of objects to some maximum is probably more complicated than it is worth.

Another approach is to imitate CDT, which deletes variable objects when it is known that they are no longer needed.  Since GDB indicates that a variable object has gone out-of-scope, we can then know that it is safe to delete it, even if it has children (since all children are also out-of-scope.)

This approach has two main advantages:
1- makes managing children easier
2- only requests the deletion of parent objects, which should be more efficient than requesting the deletion of each individual child.

I suggest we take this approach to deal with deletion of var objects.

</pre>
    </div>

    <div id="c2" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=200897#c2">Comment 2</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Marc Khouzam</span> <a href="http://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=marc.khouzam&#64;gmail.com" alt="CLA" title="Eclipse Contributor Agreement" /></a> <a href="https://eclipse.org/donate/"><img class="cla_dec" src="//www.eclipse.org/donate/web-api/friends_decorator.php?email=marc.khouzam&#64;gmail.com" alt="Friend" title="Friend of Eclipse" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2007-11-30 15:11:44 EST
        </span>

      </div>




<pre class="bz_comment_text">Up to now, I have been trying to re-use variable objects.  What that meant is that if a variable object was created for a child, I stored it with the same name as if it had been requested directly from an expression.

For example: int z[1];
would need a variable object z and its children given by gdb would be z.0 and z.1 But that means that if there is a request for z[0], the child z.0 would not be used since it has a different name.  To remedy that, I attempted to always store names as they would look in expressions.  Like converting z.0 to z[0].

This is turning out to be very complicated for cases where children belong to parent classes.  E.g,
class bar { int z; };
class foo : bar {} f;

f.bar.z is the name GDB gives to child z.  However, from an expression perspective it should be f.z.  This causes a problem when the view requests f.bar.z (which is not a valid expression, but is the correct gdb qualified expression)

Furthermore, it is probably impossible in cases where children belong to parent classes AND are hidden by child classes children.
class bar { int z; };
class foo : bar { bool z;} f;

In this case bar::z is not accessible directly, but only through a cast.  This makes it extremely complicated when trying to convert from f.bar.z (gdb-name) to ((bar)f).z which would be the expression.

Finally, multiple expressions can be used to represent the same variable object.
For instance in the example above, z[1] or *(z+1) or (int)z[1] all represent the same thing. 

Because of such things, it seems to be that the front-end should not bother in matching different expression representing the same thing, but leave it to GDB.  Therefore, I will change my approach and keep the GDB-given children expressions as is.  More variable objects may be created, but I don't see any easy alternative.

</pre>
    </div>

    <div id="c3" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=200897#c3">Comment 3</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Pawel Piech</span> <a href="http://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=pawel.1.piech&#64;gmail.com" alt="CLA" title="Eclipse Contributor Agreement" /></a> <a href="https://eclipse.org/donate/"><img class="cla_dec" src="//www.eclipse.org/donate/web-api/friends_decorator.php?email=pawel.1.piech&#64;gmail.com" alt="Friend" title="Friend of Eclipse" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2007-11-30 15:38:00 EST
        </span>

      </div>




<pre class="bz_comment_text">(In reply to <a href="show_bug.cgi?id=200897#c2">comment #2</a>)
<span class="quote">&gt; Because of such things, it seems to be that the front-end should not bother in
&gt; matching different expression representing the same thing, but leave it to GDB.
&gt;  Therefore, I will change my approach and keep the GDB-given children
&gt; expressions as is.  More variable objects may be created, but I don't see any
&gt; easy alternative.</span >

I totally agree.</pre>
    </div>

    <div id="c4" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=200897#c4">Comment 4</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Marc Khouzam</span> <a href="http://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=marc.khouzam&#64;gmail.com" alt="CLA" title="Eclipse Contributor Agreement" /></a> <a href="https://eclipse.org/donate/"><img class="cla_dec" src="//www.eclipse.org/donate/web-api/friends_decorator.php?email=marc.khouzam&#64;gmail.com" alt="Friend" title="Friend of Eclipse" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2007-12-03 08:52:54 EST
        </span>

      </div>




<pre class="bz_comment_text">
(In reply to <a href="show_bug.cgi?id=200897#c2">comment #2</a>)
<span class="quote">&gt; Because of such things, it seems to be that the front-end should not bother in
&gt; matching different expression representing the same thing, but leave it to GDB.
&gt; Therefore, I will change my approach and keep the GDB-given children
&gt; expressions as is.  More variable objects may be created, but I don't see any
&gt; easy alternative.</span >

I originally tried to convert gdb-given children names into proper expressions to allow for variable object re-use.  As per <a href="show_bug.cgi?id=200897#c2">comment #2</a>, this turned out to be complicated and not worth the effort.  Or so I thought.  It turns out that there is a more important use case for this (see <a class="bz_bug_link 
          bz_status_CLOSED  bz_closed"
   title="CLOSED FIXED - [expressions] Getting address of array does not work when array child of parent class"
   href="show_bug.cgi?id=211687">bug 211687</a>).
In the case of getting the address of a child expression, we try to create a new expression starting with a &amp;.  For this to work the child expression must be a valid expression.  A simple example is that although gdb returns the child of array int z[2] as z.0 and z.1, to be able to get the address we cannot use &amp;(z.0) but must first convert to z[0] to then use &amp;(z[0]).  This is a simple example but it illustrates the situation which also applies to inherited members.

We won't address this bug here but will track it with <a class="bz_bug_link 
          bz_status_CLOSED  bz_closed"
   title="CLOSED FIXED - [expressions] Getting address of array does not work when array child of parent class"
   href="show_bug.cgi?id=211687">bug 211687</a>.
</pre>
    </div>

    <div id="c5" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=200897#c5">Comment 5</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Pawel Piech</span> <a href="http://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=pawel.1.piech&#64;gmail.com" alt="CLA" title="Eclipse Contributor Agreement" /></a> <a href="https://eclipse.org/donate/"><img class="cla_dec" src="//www.eclipse.org/donate/web-api/friends_decorator.php?email=pawel.1.piech&#64;gmail.com" alt="Friend" title="Friend of Eclipse" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2007-12-03 12:40:56 EST
        </span>

      </div>




<pre class="bz_comment_text">For a more reliable implementation of MIVariableObject's isPointer(), isArray(), isMethod(), isComplex(), we should copy over CDI's GDBTypeParser.  We could actually use it as is, but it's better to not create a dependency to CDI from DSF.</pre>
    </div>

    <div id="c6" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=200897#c6">Comment 6</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Marc Khouzam</span> <a href="http://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=marc.khouzam&#64;gmail.com" alt="CLA" title="Eclipse Contributor Agreement" /></a> <a href="https://eclipse.org/donate/"><img class="cla_dec" src="//www.eclipse.org/donate/web-api/friends_decorator.php?email=marc.khouzam&#64;gmail.com" alt="Friend" title="Friend of Eclipse" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2007-12-03 12:55:28 EST
        </span>

      </div>




<pre class="bz_comment_text">(In reply to <a href="show_bug.cgi?id=200897#c5">comment #5</a>)
<span class="quote">&gt; For a more reliable implementation of MIVariableObject's isPointer(),
&gt; isArray(), isMethod(), isComplex(), we should copy over CDI's GDBTypeParser. 
&gt; We could actually use it as is, but it's better to not create a dependency to
&gt; CDI from DSF.</span >

I had a quick glance and it seemed pretty complicated, but I guess it is the way to do it to make sure we cover all cases.  I will look into it in more detail.

</pre>
    </div>

    <div id="c7" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=200897#c7">Comment 7</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Marc Khouzam</span> <a href="http://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=marc.khouzam&#64;gmail.com" alt="CLA" title="Eclipse Contributor Agreement" /></a> <a href="https://eclipse.org/donate/"><img class="cla_dec" src="//www.eclipse.org/donate/web-api/friends_decorator.php?email=marc.khouzam&#64;gmail.com" alt="Friend" title="Friend of Eclipse" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2007-12-03 12:56:12 EST
        </span>

      </div>




<pre class="bz_comment_text">Getting back to the deletion of children.
To know that a variable object has gone out-of-scope, the command var-update must be done.  Currently, this command is only triggered by a request to get a value through getFormattedExpressionValue().  The problem is that if a view does not request the value of a varible object, we will never know it has gone out-of-scope and it will never be deleted.  This will actually happen all the time in the GDB/MI implementation of DSF, since, in the case of the variable view, we only request values for the variable that are still in-scope, as returned by stack-list-locals.

Therefore, we need a way to prevent variable objects from never being deleted.  Below are preliminary ideas that I wanted to keep track of.

Suggestions:

1- whenever a Suspended event is received by the ExpressionService, all existing variable objects will be issued the -var-update command, and any of them that have gone out-of-scope will be deleted.  This is pretty much the approach taken by CDT.  The problem with this solution is that -all- variable objects will be updated at every step of the program, even if they are not currently showing in the views.  To me, this does not lend itself well to the DSF approach to efficiency.

2- use the LeastRecentlyUsed algorithm to trigger a -var-update.  Here, instead of doing a var-update for every variable object at every step, we would only do one when we add a new variable object and have reached a certain number of var objects.  I'm thinking that if we keep the threshold of variable objects low, we can probably reach a pretty decent behavior.  The problem with this may again be with the creation of variable objects for children, which will may uselessly trigger our delete code.

3- use suggestion #2 above, but only apply the threshold of number of variable objects to parent variable objects.  This will avoid that creating children trigger our delete code.  Although this will also mean that the actual number of variable objects will vary greatly depending on the number of children, it will all balance itself because one a parent is deleted, it will remove all the children as well.

</pre>
    </div>

    <div id="c8" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=200897#c8">Comment 8</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Pawel Piech</span> <a href="http://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=pawel.1.piech&#64;gmail.com" alt="CLA" title="Eclipse Contributor Agreement" /></a> <a href="https://eclipse.org/donate/"><img class="cla_dec" src="//www.eclipse.org/donate/web-api/friends_decorator.php?email=pawel.1.piech&#64;gmail.com" alt="Friend" title="Friend of Eclipse" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2007-12-03 13:04:54 EST
        </span>

      </div>




<pre class="bz_comment_text">I don't understand why we need to delete the vars when they go out of scope?  </pre>
    </div>

    <div id="c9" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=200897#c9">Comment 9</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Marc Khouzam</span> <a href="http://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=marc.khouzam&#64;gmail.com" alt="CLA" title="Eclipse Contributor Agreement" /></a> <a href="https://eclipse.org/donate/"><img class="cla_dec" src="//www.eclipse.org/donate/web-api/friends_decorator.php?email=marc.khouzam&#64;gmail.com" alt="Friend" title="Friend of Eclipse" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2007-12-03 13:33:11 EST
        </span>

      </div>




<pre class="bz_comment_text">(In reply to <a href="show_bug.cgi?id=200897#c8">comment #8</a>)
<span class="quote">&gt; I don't understand why we need to delete the vars when they go out of scope?  </span >

We don't actually need to.  However, knowing when it is ok to delete a parent variable object seems difficult to me, since we would somehow have to know if any of the children are still useful.
If we use the &quot;out-of-scope&quot; concept, then we know that it is safe to delete a parent object and all its children.

I'm open to suggestions though...

</pre>
    </div>

    <div id="c10" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=200897#c10">Comment 10</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Pawel Piech</span> <a href="http://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=pawel.1.piech&#64;gmail.com" alt="CLA" title="Eclipse Contributor Agreement" /></a> <a href="https://eclipse.org/donate/"><img class="cla_dec" src="//www.eclipse.org/donate/web-api/friends_decorator.php?email=pawel.1.piech&#64;gmail.com" alt="Friend" title="Friend of Eclipse" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2007-12-03 15:03:50 EST
        </span>

      </div>




<pre class="bz_comment_text">Created <span class="bz_obsolete"><a href="attachment.cgi?id=84352&amp;action=diff" name="attach_84352" title="Patch which sorts parents to come after children in variable cache.">attachment 84352</a> <a href="attachment.cgi?id=84352&amp;action=edit" title="Patch which sorts parents to come after children in variable cache.">[details]</a></span>
Patch which sorts parents to come after children in variable cache.

(In reply to <a href="show_bug.cgi?id=200897#c9">comment #9</a>)
<span class="quote">&gt; We don't actually need to.  However, knowing when it is ok to delete a parent
&gt; variable object seems difficult to me, since we would somehow have to know if
&gt; any of the children are still useful.</span >

By &quot;useful&quot; I assume you mean expressions which have children which are being used.  If you're not careful you could end up removing a variable which is being accessed, by removing its parent.  This patch, which tries to sort the LRU variable cache so that parent variables would always come up for removal after all of their children, would guarantee that this doesn't happen... I think :-)</pre>
    </div>

    <div id="c11" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=200897#c11">Comment 11</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Marc Khouzam</span> <a href="http://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=marc.khouzam&#64;gmail.com" alt="CLA" title="Eclipse Contributor Agreement" /></a> <a href="https://eclipse.org/donate/"><img class="cla_dec" src="//www.eclipse.org/donate/web-api/friends_decorator.php?email=marc.khouzam&#64;gmail.com" alt="Friend" title="Friend of Eclipse" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2007-12-05 15:42:36 EST
        </span>

      </div>




<pre class="bz_comment_text">Created <span class="bz_obsolete"><a href="attachment.cgi?id=84566&amp;action=diff" name="attach_84566" title="Small fixes to previous patch">attachment 84566</a> <a href="attachment.cgi?id=84566&amp;action=edit" title="Small fixes to previous patch">[details]</a></span>
Small fixes to previous patch

Thanks for your patch!
I like the trick you used of overriding the get method and making sure to 'touch' all the parents to mark them accessed.  I also liked the entrySet().iterator().next() giving the oldest element.  I was looking for how to do that, but I hadn't found it.

I attached a slightly modified patch that completes yours in the way (I hope) you meant to do it.

The main change is that whenever we put() an element, we must touch (get()) all its ancestors.  We need this to make sure that the parents are always younger than the children.

With this approach, I would not need to worry about cleaning up children manually, after a parent is deleted.  That is much simpler.

I have a couple of questions about this solution though:
1- there is a theoretical risk that a get() operation, while going up the chain of parents, will remove the child we are actually trying to do get() on.  However, for this to happen, the MAX_VARIABLE_LIST would have to be smaller than a parent-child chain.  With a MAX of 1000, this really should never happen.  So, if you are comfortable with that, so am I.

2- in the case of a large array of say, 2000 elements, as soon as the user expands the array to show the children, we will add each of the 2000 to our LRU right away, even though only 2 or 3 of these children are visible.  In turn, this will start trying to remove elements from the LRU.  Although the parent array will be protected from deletion, it is highly likely that other elements currently showing in the view (not part of the array), will have their varObject deleted.  In fact, the first children of the array will also be deleted, even though they are just been put in view.  What this means is that if the user clicks on a deleted element, or if we step, the ExpressionService will need to recreate that element as a 'stand-alone' element.  This may prove to be tricky since the view may not have the proper expression to create this child directly. I might be able to work around this with <a class="bz_bug_link 
          bz_status_CLOSED  bz_closed"
   title="CLOSED FIXED - [expressions] Getting address of array does not work when array child of parent class"
   href="show_bug.cgi?id=211687">bug 211687</a> var-info-path-expression, but this would probably require the view to have knowledge of the proper expression path as returned by -var-info-path-expression, which will probably require adding this path to MIExpressionDMC, which will require issuing the command -var-info-path-expression for every child of the array, which is a large overhead that I was planning of avoiding (I will explain this further in <a class="bz_bug_link 
          bz_status_CLOSED  bz_closed"
   title="CLOSED FIXED - [expressions] Getting address of array does not work when array child of parent class"
   href="show_bug.cgi?id=211687">bug 211687</a> a little later)
This may be a big enough issue to look into the out-of-scope idea... but maybe I'm giving up too easily?

3- Each child varObj will be deleted explicitly.  So, for an array of 500 elements, there will be 501 requests to -var-delete.  But if we deleted the parent first (when out-of-scope), there would only be one request to -var-delete.
It is not clear what is more efficient here though.  A single request to -var-delete may require a lot of work from GDB in one shot, while many requests to -var-delete slightly spread over time may distribute the work over time.  Do you have an opinion about this?</pre>
    </div>

    <div id="c12" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=200897#c12">Comment 12</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Marc Khouzam</span> <a href="http://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=marc.khouzam&#64;gmail.com" alt="CLA" title="Eclipse Contributor Agreement" /></a> <a href="https://eclipse.org/donate/"><img class="cla_dec" src="//www.eclipse.org/donate/web-api/friends_decorator.php?email=marc.khouzam&#64;gmail.com" alt="Friend" title="Friend of Eclipse" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2007-12-05 15:46:00 EST
        </span>

      </div>




<pre class="bz_comment_text">Note that the second path is slightly corrupted as I modified it my hand to make it more readable.  But jist of it is ok, except for lines 451-480, which seem to have a new line added right before the &#64;Override.  Please disregard that line.</pre>
    </div>

    <div id="c13" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=200897#c13">Comment 13</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Marc Khouzam</span> <a href="http://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=marc.khouzam&#64;gmail.com" alt="CLA" title="Eclipse Contributor Agreement" /></a> <a href="https://eclipse.org/donate/"><img class="cla_dec" src="//www.eclipse.org/donate/web-api/friends_decorator.php?email=marc.khouzam&#64;gmail.com" alt="Friend" title="Friend of Eclipse" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2007-12-05 15:46:51 EST
        </span>

      </div>




<pre class="bz_comment_text">(In reply to <a href="show_bug.cgi?id=200897#c12">comment #12</a>)
<span class="quote">&gt; Note that the second path is slightly corrupted as I modified it by hand to
&gt; make it more readable.  But jist of it is ok, except for lines 451-480, which
&gt; seem to have a new line added right before the &#64;Override.  Please disregard
&gt; that line.
&gt; </span >

I meant second 'patch' not path, above.
</pre>
    </div>

    <div id="c14" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=200897#c14">Comment 14</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Pawel Piech</span> <a href="http://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=pawel.1.piech&#64;gmail.com" alt="CLA" title="Eclipse Contributor Agreement" /></a> <a href="https://eclipse.org/donate/"><img class="cla_dec" src="//www.eclipse.org/donate/web-api/friends_decorator.php?email=pawel.1.piech&#64;gmail.com" alt="Friend" title="Friend of Eclipse" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2007-12-05 23:01:39 EST
        </span>

      </div>




<pre class="bz_comment_text">(In reply to <a href="show_bug.cgi?id=200897#c11">comment #11</a>)

<span class="quote">&gt; Thanks for your patch!</span >
You're welcome :-)


<span class="quote">&gt; ...
&gt; I attached a slightly modified patch that completes yours in the way (I hope)
&gt; you meant to do it.</span >

Yes, I didn't actually debug the patch, so sorry for leaving the errors.


<span class="quote">&gt; The main change is that whenever we put() an element, we must touch (get()) all
&gt; its ancestors.  We need this to make sure that the parents are always younger
&gt; than the children.</span >

I thought I did that.  I must have changed it at the last minute and forgot to undo it... I was in a hurry and I got sloppy I guess.


<span class="quote">&gt; ...
&gt; 1- there is a theoretical risk that a get() operation, while going up the chain
&gt; of parents, will remove the child we are actually trying to do get() on. 
&gt; However, for this to happen, the MAX_VARIABLE_LIST would have to be smaller
&gt; than a parent-child chain.  With a MAX of 1000, this really should never
&gt; happen.  So, if you are comfortable with that, so am I.</span >

I remember now why I removed the access to parent in put.  I thought of another way of handling put.  Instead of using &quot;varBeingAccessed&quot;.  I was going to change removeEldestEntry to not delete anything (essentially remove it) and replace it with one that is called only on get.  Once again, I got sloppy in my hurry.  I'll attach the patch with this change.


<span class="quote">&gt; 2- in the case of a large array of say, 2000 elements...</span >
What about 100,000 elements? :-)

<span class="quote">&gt; I'm giving up too easily?</span >
Yes :-)

Using the -var-get-children for arrays will not scale.  What we could do instead is: in IExpressions.getSubExpressions() treat arrays as a special case and generate the IExpressionDMContext objects manually (by appending [&lt;index&gt;] to the parent expression).  And we'll live happily ever after...


<span class="quote">&gt; 3- Each child varObj will be deleted explicitly....</span >

Actually, I'm not even sure if you can delete a var which is a child.  If that's the case, you could simply do nothing when a child var is removed from the array, and simply wait until the parent comes up for deletion.  This could very well be much more efficient, though more memory intensive for GDB.
</pre>
    </div>

    <div id="c15" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=200897#c15">Comment 15</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Pawel Piech</span> <a href="http://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=pawel.1.piech&#64;gmail.com" alt="CLA" title="Eclipse Contributor Agreement" /></a> <a href="https://eclipse.org/donate/"><img class="cla_dec" src="//www.eclipse.org/donate/web-api/friends_decorator.php?email=pawel.1.piech&#64;gmail.com" alt="Friend" title="Friend of Eclipse" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2007-12-05 23:02:14 EST
        </span>

      </div>




<pre class="bz_comment_text">Created <span class="bz_obsolete"><a href="attachment.cgi?id=84591&amp;action=diff" name="attach_84591" title="Patch with alternative put() override.">attachment 84591</a> <a href="attachment.cgi?id=84591&amp;action=edit" title="Patch with alternative put() override.">[details]</a></span>
Patch with alternative put() override.</pre>
    </div>

    <div id="c16" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=200897#c16">Comment 16</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Marc Khouzam</span> <a href="http://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=marc.khouzam&#64;gmail.com" alt="CLA" title="Eclipse Contributor Agreement" /></a> <a href="https://eclipse.org/donate/"><img class="cla_dec" src="//www.eclipse.org/donate/web-api/friends_decorator.php?email=marc.khouzam&#64;gmail.com" alt="Friend" title="Friend of Eclipse" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2007-12-06 11:17:38 EST
        </span>

      </div>




<pre class="bz_comment_text">(In reply to <a href="show_bug.cgi?id=200897#c14">comment #14</a>) 

<span class="quote">&gt; Yes, I didn't actually debug the patch, so sorry for leaving the errors.</span >
Not a problem, I really should be doing some of the work :-)

The new solution is even better and more elegant.  There is a still theoretical risk that a get() or a put() (since it calls get()) operation, while doing recusive get() cals to go up the chain of parents, will remove the child we are actually trying to do get() or put() on.  I gather that does not bother you since a chain of parent-children will alway be shorter that our MAX_VARIABLE_LIST.

<span class="quote">&gt; Using the -var-get-children for arrays will not scale.  What we could do
&gt; instead is: in IExpressions.getSubExpressions() treat arrays as a special case
&gt; and generate the IExpressionDMContext objects manually (by appending [&lt;index&gt;]
&gt; to the parent expression).  And we'll live happily ever after...</span >

So GDB will not create children for arrays, but will only create the varObjects if the view requests to see details about a child specifically.  Very nice.

I believe we still have a problem with deleting children that could still be in-scope.  However, I believe this is a deeper problem that we should probably address anyway.  The problem is that a view cannot reconstruct a 'stand-alone' expression for a child, based on the information that it is currently given by the ExpressionService.  The reason for this is that the ExpressionService uses the GDB-given children path as an expression.  For example, a child will have an expression of f.bar.c instead of ((bar)f).c.  I should be able to fix this with the use of var-info-path-expression, especially if we don't use -var-list-children for arrays.  I will work on this and confirm that it is working properly.  

<span class="quote">&gt; Actually, I'm not even sure if you can delete a var which is a child.  If
&gt; that's the case, you could simply do nothing when a child var is removed from
&gt; the array, and simply wait until the parent comes up for deletion.  This could
&gt; very well be much more efficient, though more memory intensive for GDB.</span >

I had tried it and GDB allows you to delete cildren directly.
But since it is so easy to do, I'll put a check to only request GDB to delete
parents.  That will mean less requests to the backend.  We'll see how we do
about memory later, and it will be easy to remove this check if needed.

So, thanks for the great suggestions and patches and I will go on from here and keep you updated.</pre>
    </div>

    <div id="c17" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=200897#c17">Comment 17</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Pawel Piech</span> <a href="http://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=pawel.1.piech&#64;gmail.com" alt="CLA" title="Eclipse Contributor Agreement" /></a> <a href="https://eclipse.org/donate/"><img class="cla_dec" src="//www.eclipse.org/donate/web-api/friends_decorator.php?email=pawel.1.piech&#64;gmail.com" alt="Friend" title="Friend of Eclipse" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2007-12-06 13:04:39 EST
        </span>

      </div>




<pre class="bz_comment_text">(In reply to <a href="show_bug.cgi?id=200897#c16">comment #16</a>)
<span class="quote">&gt; ...  There is a still theoretical
&gt; risk that a get() or a put() (since it calls get()) operation, while doing
&gt; recusive get() cals to go up the chain of parents, will remove the child we are
&gt; actually trying to do get() or put() on.  ...</span >
Yes that's true.  Not a problem for put anymore, because with this patch we wouldn't remove on put, but on get, yes.  To fix that you could add to the get() implementation: 
    if (size() &gt; MAX_VARIABLE_LIST) {
        MIVariableObject eldest = entrySet().iterator().next();
        if (!eldest.getValue().equals(reVal)) {
            removeEldestEntryOnGet();
        }
    }


<span class="quote">&gt;... I will work on this and confirm that it is working properly.  </span >
We have to be able to have the correct string for the fully-qualified expressions.  Otherwise we will not be able to copy entries from variables to the expressions view.  If we can use the -var-expression-info-path, that's great, otherwise we'll have to calculate it like CDI does.

<span class="quote">&gt; I had tried it and GDB allows you to delete cildren directly.</span >
Interesting, so it's your call whether to remove it or not.
</pre>
    </div>

    <div id="c18" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=200897#c18">Comment 18</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Marc Khouzam</span> <a href="http://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=marc.khouzam&#64;gmail.com" alt="CLA" title="Eclipse Contributor Agreement" /></a> <a href="https://eclipse.org/donate/"><img class="cla_dec" src="//www.eclipse.org/donate/web-api/friends_decorator.php?email=marc.khouzam&#64;gmail.com" alt="Friend" title="Friend of Eclipse" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2007-12-06 13:46:42 EST
        </span>

      </div>




<pre class="bz_comment_text">(In reply to <a href="show_bug.cgi?id=200897#c17">comment #17</a>)
<span class="quote">&gt; Yes that's true.  Not a problem for put anymore, because with this patch we
&gt; wouldn't remove on put, but on get, yes. </span >

put() calls our overriden get(), so there may be deletes during a put also.
But since those delete will not be of any parents of the object we are putting, I don't see a problem with that.

<span class="quote">&gt; To fix that you could add to the
&gt; get() implementation: 
&gt;     if (size() &gt; MAX_VARIABLE_LIST) {
&gt;         MIVariableObject eldest = entrySet().iterator().next();
&gt;         if (!eldest.getValue().equals(reVal)) {
&gt;             removeEldestEntryOnGet();
&gt;         }
&gt;     }</span >

I had the same idea, but I then realized that any of the recursively-called get() can remove the child. Say you have a parent-child chain that looks like a-&gt;b-&gt;c (c being the child).  If we do a get(c), it will call get(b) which will call get(a); get(a) may do a remove on c.

Did you not mean to have multiple deletes on a single get()?  Maybe that is where the problem is?  If you want to do a single potential delete for a get() operation, when we can do this:

&#64;Override
public MIVariableObject get(Object key) {
  MIVariableObject retVal = touchAncestors(key);

  // If we're over our max size, attempt to remove eldest entry.  
  // The base class attempts to remove eldest entries when 
  // inserting values only.
  if (size() &gt; MAX_VARIABLE_LIST) {
    Map.Entry&lt;VariableObjectId, MIVariableObject&gt; eldest = 
                                       entrySet().iterator().next();
    if (!eldest.getValue().equals(retVal)) {
      if (eldest.getValue().currentState == MIVariableObject.VarState.READY) {
          remove(eldest.getKey());
      }
    }
  }
  return retVal;
}

private MIVariableObject touchAncestors(Object key) {
    MIVariableObject retVal = super.get(key);
    if (retVal != null &amp;&amp; retVal.getParent() != null) {
        touchAncestors(retVal.getParent().getInternalId());
    }
    return retVal;
}

If you did want to do a remove for each recursive call to get(), then we can add an argument to touchAncestors which will be the child element that should not be removed.

<span class="quote">&gt; We have to be able to have the correct string for the fully-qualified
&gt; expressions.  Otherwise we will not be able to copy entries from variables to
&gt; the expressions view.  If we can use the -var-expression-info-path, that's
&gt; great, otherwise we'll have to calculate it like CDI does.</span >

That's why I was saying I should better understand what the views do.  I don't fully understand how the views use the Context data that we return to them and how they massage that info to display things properly.  But I gather from what you are saying that the MIExpressionDMC.getExpression() must return an expression that can be used in -var-create.  I'll make sure that works ok.


</pre>
    </div>

    <div id="c19" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=200897#c19">Comment 19</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Pawel Piech</span> <a href="http://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=pawel.1.piech&#64;gmail.com" alt="CLA" title="Eclipse Contributor Agreement" /></a> <a href="https://eclipse.org/donate/"><img class="cla_dec" src="//www.eclipse.org/donate/web-api/friends_decorator.php?email=pawel.1.piech&#64;gmail.com" alt="Friend" title="Friend of Eclipse" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2007-12-06 15:25:48 EST
        </span>

      </div>




<pre class="bz_comment_text">Wow, I think this must be the longest bug discussion we've had so far :-)

Yeah, I think the touchAncestor() approach would be the safest, and no I don't think it's necessary to remove on recursive calls, it was just a side effect.  It would also be good to make touchAncestors() not recursive in case of a deep hierarchy.

BTW, the use case I can imagine for a deep hierarchy is recursively nested structures plus a view update policy which tries to descend down the variable hierarchy to some user-configurable depth.  We actually do plan to implement such an update policy, and although we haven't talked about how we're going to limit how much memory such an update policy would be allowed to use, most likely we'll have some user-configured setting.  If the user enters something huge (or at least bigger than our variables cache) then we could run into this bug.

</pre>
    </div>

    <div id="c20" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=200897#c20">Comment 20</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Marc Khouzam</span> <a href="http://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=marc.khouzam&#64;gmail.com" alt="CLA" title="Eclipse Contributor Agreement" /></a> <a href="https://eclipse.org/donate/"><img class="cla_dec" src="//www.eclipse.org/donate/web-api/friends_decorator.php?email=marc.khouzam&#64;gmail.com" alt="Friend" title="Friend of Eclipse" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2007-12-06 15:32:51 EST
        </span>

      </div>




<pre class="bz_comment_text">(In reply to <a href="show_bug.cgi?id=200897#c19">comment #19</a>)
<span class="quote">&gt; Wow, I think this must be the longest bug discussion we've had so far :-)</span >

These variable objects have give me the biggest headache I've had in years :-)
I can see why you guys don't use them in your product.
Which makes me repeat: Thanks for you help.

<span class="quote">&gt; Yeah, I think the touchAncestor() approach would be the safest, and no I don't
&gt; think it's necessary to remove on recursive calls, it was just a side effect. 
&gt; It would also be good to make touchAncestors() not recursive in case of a deep
&gt; hierarchy.
&gt; 
&gt; BTW, the use case I can imagine for a deep hierarchy is recursively nested
&gt; structures plus a view update policy which tries to descend down the variable
&gt; hierarchy to some user-configurable depth.  We actually do plan to implement
&gt; such an update policy, and although we haven't talked about how we're going to
&gt; limit how much memory such an update policy would be allowed to use, most
&gt; likely we'll have some user-configured setting.  If the user enters something
&gt; huge (or at least bigger than our variables cache) then we could run into this
&gt; bug.</span >

Wouldn't have thought of that myself, but I'll keep this in mind too, while finishing up this.

</pre>
    </div>

    <div id="c21" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=200897#c21">Comment 21</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Marc Khouzam</span> <a href="http://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=marc.khouzam&#64;gmail.com" alt="CLA" title="Eclipse Contributor Agreement" /></a> <a href="https://eclipse.org/donate/"><img class="cla_dec" src="//www.eclipse.org/donate/web-api/friends_decorator.php?email=marc.khouzam&#64;gmail.com" alt="Friend" title="Friend of Eclipse" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2007-12-07 15:59:28 EST
        </span>

      </div>




<pre class="bz_comment_text">Created <span class=""><a href="attachment.cgi?id=84782&amp;action=diff" name="attach_84782" title="Final path for LRU">attachment 84782</a> <a href="attachment.cgi?id=84782&amp;action=edit" title="Final path for LRU">[details]</a></span>
Final path for LRU

FYI, this is the final version of the LRU, with the not-recursive touchAncestors.
This should complete our efforts to deal with deletion of variable objects.

Note that the patch is not a real CVS patch but just made by hand for you to look over.

I will check it in sometime over the weekend (I can't check-in now because I have a bunch of other changes in the same file that I have to go over).

I still have work to do to get the proper expression returned to views and displayed properly.  I even broke CDT with one of my test cases :-)</pre>
    </div>

    <div id="c22" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=200897#c22">Comment 22</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Pawel Piech</span> <a href="http://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=pawel.1.piech&#64;gmail.com" alt="CLA" title="Eclipse Contributor Agreement" /></a> <a href="https://eclipse.org/donate/"><img class="cla_dec" src="//www.eclipse.org/donate/web-api/friends_decorator.php?email=pawel.1.piech&#64;gmail.com" alt="Friend" title="Friend of Eclipse" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2007-12-07 16:25:00 EST
        </span>

      </div>




<pre class="bz_comment_text">Looks good to me.</pre>
    </div>

    <div id="c23" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=200897#c23">Comment 23</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Marc Khouzam</span> <a href="http://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=marc.khouzam&#64;gmail.com" alt="CLA" title="Eclipse Contributor Agreement" /></a> <a href="https://eclipse.org/donate/"><img class="cla_dec" src="//www.eclipse.org/donate/web-api/friends_decorator.php?email=marc.khouzam&#64;gmail.com" alt="Friend" title="Friend of Eclipse" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2007-12-10 15:17:17 EST
        </span>

      </div>




<pre class="bz_comment_text">Hi Pawel,

another issue came up with respect to children.
After our discussions, I have fixed the ExpressionService, so that the MIExpressionDMC always contains the fully-qualified expression, even for children. 

Now, when the ExpressionService receives a request to getModelData(IExpressionDMContext), it returns an IExpressionDMData which has a method getName() which I understood to return the relative expression.

The problem is that the ExpressionService does not have a way of knowing what the relative expression is, in the context of the ExpressionDMC.  Say the given ExpressionDMC to getModelData() contains the expression &quot;f.z&quot;; if the request is made due to an expansion of parent &quot;f&quot; in the view, then the relative expression of &quot;f.z&quot; is &quot;z&quot;; however, if the user actually created an expression &quot;f.z&quot; directly, then the relative expression is &quot;f.z&quot;.

Currently, nothing in IExpressionDMC (or MIExpressionDMC) specifies if the requested expression is a child of another, or taken as a full expression.
To solve this, I was thinking of adding to MIExpressionDMC some knowledge about its potential parent.

My concern is that you had mentioned that we may &quot;copy entries from variables to the expressions view&quot;.  I'm not clear about this.  Does it mean we can take a child expression from the variables view and copy it into the expressions view?  If that is the case, the extra parent information I am thinking of adding, will not apply to this new copy.  How does this &quot;copying&quot; work?  And could we reset the parent information in case of a copy?

Thanks in advance


</pre>
    </div>

    <div id="c24" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=200897#c24">Comment 24</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Marc Khouzam</span> <a href="http://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=marc.khouzam&#64;gmail.com" alt="CLA" title="Eclipse Contributor Agreement" /></a> <a href="https://eclipse.org/donate/"><img class="cla_dec" src="//www.eclipse.org/donate/web-api/friends_decorator.php?email=marc.khouzam&#64;gmail.com" alt="Friend" title="Friend of Eclipse" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2007-12-10 15:55:48 EST
        </span>

      </div>




<pre class="bz_comment_text">(In reply to <a href="show_bug.cgi?id=200897#c23">comment #23</a>)

I remember now that the old IExpressionDMContext used to contain both the fully qualified expression and the relative expression, which may solve the problem I mentioned in <a href="show_bug.cgi?id=200897#c23">comment #23</a>).  This was changed in <a class="bz_bug_link 
          bz_status_CLOSED  bz_closed"
   title="CLOSED FIXED - [variables] IExpressionDMContext should contain only the fully qualified expression."
   href="show_bug.cgi?id=187718">bug 187718</a>, mostly due to comparison issues.

I am now thinking that we should have two createExpression(); one that accepts both a full expression and a relative one, and one that accepts only a single full expression, which will serve for both full and relative (although we could always simply request two expressions).

In most cases, createExpression() will be used with the full expression only.  The relative expression will only be set explicitly when we are doing a getChildren() call, which is within the ExpressionService, so should be easy to handle.

I have tried this, so I may be wrong.  I will give it a quick test to see how things workout.
</pre>
    </div>

    <div id="c25" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=200897#c25">Comment 25</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Pawel Piech</span> <a href="http://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=pawel.1.piech&#64;gmail.com" alt="CLA" title="Eclipse Contributor Agreement" /></a> <a href="https://eclipse.org/donate/"><img class="cla_dec" src="//www.eclipse.org/donate/web-api/friends_decorator.php?email=pawel.1.piech&#64;gmail.com" alt="Friend" title="Friend of Eclipse" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2007-12-10 16:02:09 EST
        </span>

      </div>




<pre class="bz_comment_text">(In reply to <a href="show_bug.cgi?id=200897#c23">comment #23</a>)
<span class="quote">&gt; ... To solve this, I was thinking of adding to MIExpressionDMC some knowledge about
&gt; its potential parent.</span >
For the expressions to work correctly between expressions and variable view, a
context created as a child of an expression has be be equal to the same
expression created using a fully-qualified string.  In other words to
expression DMCs have to be equal to each other if their fully qualified
expressions are equal.  So adding to the parent information to the DMC would
not work.  We actually tried this before, when the DMC had both the relative
and the fully qualified expression in it.

Could we use -var-info-expression to get the relative expression?  If not,
could we calculate it?</pre>
    </div>

    <div id="c26" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=200897#c26">Comment 26</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Marc Khouzam</span> <a href="http://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=marc.khouzam&#64;gmail.com" alt="CLA" title="Eclipse Contributor Agreement" /></a> <a href="https://eclipse.org/donate/"><img class="cla_dec" src="//www.eclipse.org/donate/web-api/friends_decorator.php?email=marc.khouzam&#64;gmail.com" alt="Friend" title="Friend of Eclipse" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2007-12-10 16:12:43 EST
        </span>

      </div>




<pre class="bz_comment_text">(In reply to <a href="show_bug.cgi?id=200897#c25">comment #25</a>)
<span class="quote">&gt; In other words two
&gt; expression DMCs have to be equal to each other if their fully qualified
&gt; expressions are equal.  </span >

We could fix this in the equals() method by ignoring the relative expression.  But I maybe there are other side-effects to that...

<span class="quote">&gt; Could we use -var-info-expression to get the relative expression?  If not,
&gt; could we calculate it?</span >

The problem here is that -var-info-expression returns the relative expression based on how the variable object was created.  That means that if we use -var-list-children to create a bunch of varObjs and then the LRU deletes some of them, and then we re-create a new one based on the full expression, the -var-info-expression won't give us the proper relative expression anymore.  Furthermore, even if the delete was ok, we would have a problem if the user created a expression like &quot;f.z&quot; in the expression view, because the ExpressionService would re-use the varObj it had from the variable view, and would give a relative path of &quot;z&quot; instead of &quot;f.z&quot; for the expression view.

To be able to calculate the relative expression ourselves, I think we need to know if the IExpressionDMC points to a child expression, or a parent expression (although the full expression is still the same in both cases &quot;f.z&quot;.)
Which brings back the idea of having the relative expression inside the ExpressionContext.

</pre>
    </div>

    <div id="c27" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=200897#c27">Comment 27</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Pawel Piech</span> <a href="http://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=pawel.1.piech&#64;gmail.com" alt="CLA" title="Eclipse Contributor Agreement" /></a> <a href="https://eclipse.org/donate/"><img class="cla_dec" src="//www.eclipse.org/donate/web-api/friends_decorator.php?email=pawel.1.piech&#64;gmail.com" alt="Friend" title="Friend of Eclipse" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2007-12-10 18:38:51 EST
        </span>

      </div>




<pre class="bz_comment_text">(In reply to <a href="show_bug.cgi?id=200897#c26">comment #26</a>)
<span class="quote">&gt; We could fix this in the equals() method by ignoring the relative expression. 
&gt; But I maybe there are other side-effects to that...</span >
Unfortunately, yes it would have other side effects.  We've seen this with Wind River's implementation of the IExpression service, where essentially the display of variable names was inconsistent.

<span class="quote">&gt; The problem here is that -var-info-expression returns the relative expression
&gt; based on how the variable object was created. ...</span >
Sigh, then I guess we got screwed by the var objects once again.

<span class="quote">&gt; ...
&gt; To be able to calculate the relative expression ourselves, I think we need to
&gt; know if the IExpressionDMC points to a child expression, or a parent expression
&gt; (although the full expression is still the same in both cases &quot;f.z&quot;.)
&gt; Which brings back the idea of having the relative expression inside the
&gt; ExpressionContext.</span >

MIVariableManager also maintains information whether a given variable is a child of another variable or not.  Would this be equivalent of storing this information in the DMC?

But the bottom line is that if the client calls createExpression() with something like a.b.c.d, the corresponding IExpressionDMData.getName() should still return &quot;d&quot;.  Since GDB doesn't have a -get-var-name command, the only way to achieve a consistent result would be to always calculate the name from the full expression using a consistent algorithm regardless of whether the given expression is a child expression or not.
</pre>
    </div>

    <div id="c28" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=200897#c28">Comment 28</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Marc Khouzam</span> <a href="http://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=marc.khouzam&#64;gmail.com" alt="CLA" title="Eclipse Contributor Agreement" /></a> <a href="https://eclipse.org/donate/"><img class="cla_dec" src="//www.eclipse.org/donate/web-api/friends_decorator.php?email=marc.khouzam&#64;gmail.com" alt="Friend" title="Friend of Eclipse" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2007-12-10 22:14:00 EST
        </span>

      </div>




<pre class="bz_comment_text">(In reply to <a href="show_bug.cgi?id=200897#c27">comment #27</a>)

<span class="quote">&gt; ... with something like a.b.c.d, the corresponding IExpressionDMData.getName()
&gt; should still return &quot;d&quot;.</span >

With what I understand, I'm not sure I agree with this.  So, I gather, I'm misunderstanding something.

Let me describe in detail the problem I'm worried about, to make sure we are on the same page.  Sorry for the lengthiness.

Say you have
class foo {
   int z;
} f;

When the user looks at the variables view, you will see &quot;f&quot; with the little expandable arrow before it.  When you expand the arrow, it will trigger the view to do a getSubExpressions() call to retrieve a list of children in the form of IExpressionDMContext (one in this case), which will have this new IExpressionDMContext.getExpression() return &quot;f.z&quot;.  However, the view wants to show something like:
 f
   z
and not
 f
   f.z
right?
It achieves this by doing a getModelData and calling getName() to get the relative expression of the new IExpressionDMC.  All this is fine.

The problem is that at this point, if the user opens the expressions view and adds a Watch Expression that is &quot;f.z&quot;, it will create the exact same IExpressionDMContext with expression &quot;f.z&quot;.  The expressions view behaves like the variables view and does a getModelData() and then a getName().  In this case though, getName() should not return &quot;z&quot; but should return &quot;f.z&quot;.

Maybe the problem indicates that the IExpressionDMC of the variables view of this example should not be the same as the one we create for the expressions view.  Even though both context are about an expression &quot;f.z&quot;, the first is an expression that is a child of another (&quot;z&quot; after expanding &quot;f&quot;) in the variables view, while the second (&quot;f.z&quot; directly) is a full expression in the expressions view.

At least that is my latest understanding of the views and their use of the services.  Is there a mistake in my train of thought?



</pre>
    </div>

    <div id="c29" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=200897#c29">Comment 29</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Pawel Piech</span> <a href="http://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=pawel.1.piech&#64;gmail.com" alt="CLA" title="Eclipse Contributor Agreement" /></a> <a href="https://eclipse.org/donate/"><img class="cla_dec" src="//www.eclipse.org/donate/web-api/friends_decorator.php?email=pawel.1.piech&#64;gmail.com" alt="Friend" title="Friend of Eclipse" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2007-12-11 00:34:08 EST
        </span>

      </div>




<pre class="bz_comment_text">(In reply to <a href="show_bug.cgi?id=200897#c28">comment #28</a>)
<span class="quote">&gt;...  The expressions view behaves like
&gt; the variables view and does a getModelData() and then a getName().  In this
&gt; case though, getName() should not return &quot;z&quot; but should return &quot;f.z&quot;.</span >

The Expressions view has an additional column, called &quot;Expression&quot; which for the top-level node shows the user-entered expression (not the result of getName()) and is editable.  For any sub-nodes, the Expression column shows the same value as the Name column.  The Name column is hidden by default, but it can also be shown per user request.


There was another option that we used in the past as far as keeping track of the expression parent-child relationship.  ExpressionDMC constructor used to accept another ExpressionDMC as a parent.  The problem was that parent contexts are used in calculating hashCode() and equals(), so if the user went to the expression view and modified &quot;f.z&quot;, then &quot;z&quot; would not get updated in the variables view.  One way or another, if we want the above to work, we need to be able to calculate the full path and the &quot;name&quot; for every expression context in a consistent way.  GDB surely has this information, it's just making too many assumptions about what the client does and doesn't need.</pre>
    </div>

    <div id="c30" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=200897#c30">Comment 30</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Marc Khouzam</span> <a href="http://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=marc.khouzam&#64;gmail.com" alt="CLA" title="Eclipse Contributor Agreement" /></a> <a href="https://eclipse.org/donate/"><img class="cla_dec" src="//www.eclipse.org/donate/web-api/friends_decorator.php?email=marc.khouzam&#64;gmail.com" alt="Friend" title="Friend of Eclipse" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2007-12-11 15:50:12 EST
        </span>

      </div>




<pre class="bz_comment_text">(In reply to <a href="show_bug.cgi?id=200897#c29">comment #29</a>)

<span class="quote">&gt; The Expressions view has an additional column, called &quot;Expression&quot; which for
&gt; the top-level node shows the user-entered expression (not the result of
&gt; getName()) and is editable.  </span >

This was not working.  <a class="bz_bug_link 
          bz_status_CLOSED  bz_closed"
   title="CLOSED FIXED - [expressions] VariableLayoutNode does not show top-level node of expression column properly"
   href="show_bug.cgi?id=212612">Bug 212612</a> has been opened and fixed about this problem.

After the weekly meeting, we re-opened 187718 to keep track of the issue of comparing IExpressionDMContext.

Also, we have agreed that we will try to do an algorithm to determine the relative expression of a full expression, since GDB variable objects does not provide it properly.</pre>
    </div>

    <div id="c31" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=200897#c31">Comment 31</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Marc Khouzam</span> <a href="http://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=marc.khouzam&#64;gmail.com" alt="CLA" title="Eclipse Contributor Agreement" /></a> <a href="https://eclipse.org/donate/"><img class="cla_dec" src="//www.eclipse.org/donate/web-api/friends_decorator.php?email=marc.khouzam&#64;gmail.com" alt="Friend" title="Friend of Eclipse" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2007-12-14 10:23:49 EST
        </span>

      </div>




<pre class="bz_comment_text">(In reply to <a href="show_bug.cgi?id=200897#c30">comment #30</a>)
<span class="quote">&gt; we have agreed that we will try to do an algorithm to determine the
&gt; relative expression of a full expression,</span >

I have done more design and testing and here are the latest results:

First, as mentioned before, there is no GDB command to get the relative-expression from a variable object that was created directly.  For such objects (created by something like var-create - * f.z) the command var-info-expression returns the expression used for creation (f.z)

So, we thought we could parse the string returned by -var-info-path-expression ourselves to extract the child.

It turns out that taking a fully-qualified expression from GDB and extracting the relative expression is complex.  The reason for this is that expressions can be manually created by the user; and GDB keeps the same expression to build the full expression, even for the children.  What that means is that a full expression, as returned by GDB does not have a simple-well-defined format.  Basically, an expression can have any valid C format, with extra casts, extra parentheses, multiple spaces, etc.
We could seen expressions like ((((foo)   f).z) + (a)) and worse.

To me, parsing such strings in the frontend, gets into compiler syntax and, although possible, is probably not a good idea and not worth the effort.

So, here is my latest thoughts.  When creating an expression directly, we are not able to get the relative expression, however, I wonder if we need it?  In the expressions view, the expression created directly (top-level expressions) use the full expression for the display, except in the Name column.  In the variables view, the expressions are created by GDB since they come from -stack-list-locals and thefore, the getName() works.

The times where we really need a relative expression is when we are listing a child that was created by expanding a parent.  In such cases, we do have the relative expression, because we created the child with -var-list-children, and in that case, GDB gives us the proper relative expression.

Therefore, I suggest that for manually created expression, the relative expression be the same as the full expression, while for children, the relative expression would always be taken from the output of -var-list-children.

The complexity that remains is to decide where we obtain the relative expression  after the child has been created.  The simplest idea is to usse -var-info-expression with the child variable object.  Of course, this can be improved by simply storing the relative expression in that same variable object.

The problem with this is that our LRU deletion algorithm can delete a variable object for an expression that still exists.  What that means is that we may request a relative expression for a varObject that no longer exists, and therefore we would create a new varObject; this new varObject would not be created with var-list-chidlren, and therefore we would not have the relative expression anymore.  So, using the varObjects we store in teh frontend, is not possible to retrieve the relative expression.

What we can do instead is keep a map of &lt;varObjectUniqueId, relativeExpression&gt; as a separate data structure.  The problem here is that deleting elements of that structure becomes difficult since we cannot use the same LRU algorithm.  This structure could become a memory issue if we don't delete some elements eventually.

The one object that remains as long as an expression can still be requested, is the IExpressionDMContext.  I think the simplest solution is therefore to put back the getRelativeExpression() method in IExpressionDMContext (<a class="bz_bug_link 
          bz_status_CLOSED  bz_closed"
   title="CLOSED FIXED - [variables] IExpressionDMContext should contain only the fully qualified expression."
   href="show_bug.cgi?id=187718">bug 187718</a>)

If we do this, we must be aware of the two side-effects:
1- IExpressionDMData.getName() will return the full expression in the case of expression that were created directly (not by expanding a parent)
2- comparing IExpressionDMContext will consider two similar full expression different if one of them was created as a child and the other directly.  This is probably a problem we cannot get around anyway (see <a class="bz_bug_link 
          bz_status_CLOSED  bz_closed"
   title="CLOSED FIXED - [variables] IExpressionDMContext should contain only the fully qualified expression."
   href="show_bug.cgi?id=187718">bug 187718</a>) because there can be different full-expression that actually represent the same memory location (e.g., &quot;i&quot; and &quot;(int)i&quot;)

I prototyped this solution, and it seems to work well within the variables and expressions view.

What do you say?

P.S. as a side-note, if we go with this, I believe the Name column and the Expression column of the expressionsView, will always be the same.  Maybe there is not justification to have both?



</pre>
    </div>

    <div id="c32" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=200897#c32">Comment 32</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Marc Khouzam</span> <a href="http://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=marc.khouzam&#64;gmail.com" alt="CLA" title="Eclipse Contributor Agreement" /></a> <a href="https://eclipse.org/donate/"><img class="cla_dec" src="//www.eclipse.org/donate/web-api/friends_decorator.php?email=marc.khouzam&#64;gmail.com" alt="Friend" title="Friend of Eclipse" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2007-12-14 12:02:17 EST
        </span>

      </div>




<pre class="bz_comment_text">(In reply to <a href="show_bug.cgi?id=200897#c31">comment #31</a>)
Another side-effect of this solution is the display of array elements.  When doing -var-list-children of an array, GDB returns relative expressions that are just the index (0, 1 etc).

so, we must create the relative expression ourselves.  We have two choices:
using just [1] or expr[1]
we would get either
f.a
   [0]
   [1]

or

f.a
   f.a[0]
   f.a[1]

As you can see, if we just use the index, it works well, but is not very descriptive (especially if the top of the array is not in the view).
Keeping the full expression is more descriptive, but keeps the full expression as the new relative expression.  In this case, there is no way to know the relative expression of the parent (as explained in the previous comment.)
Personally, I prefer keeping the expression with the array index and I think it is acceptable to use the full expression in the case it was created by the user.

Your opinion?

</pre>
    </div>

    <div id="c33" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=200897#c33">Comment 33</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Pawel Piech</span> <a href="http://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=pawel.1.piech&#64;gmail.com" alt="CLA" title="Eclipse Contributor Agreement" /></a> <a href="https://eclipse.org/donate/"><img class="cla_dec" src="//www.eclipse.org/donate/web-api/friends_decorator.php?email=pawel.1.piech&#64;gmail.com" alt="Friend" title="Friend of Eclipse" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2007-12-14 12:30:00 EST
        </span>

      </div>




<pre class="bz_comment_text">(In reply to <a href="show_bug.cgi?id=200897#c31">comment #31</a>)
<span class="quote">&gt; I prototyped this solution, and it seems to work well within the variables and
&gt; expressions view.
&gt; 
&gt; What do you say?</span >
I think it's a decent compromise.  But how do you calculate the relative expression name when creating the child contexts?  Do you call -var-info-expression at that point?  Come to think of it, do you also call -var-info-expression-path for each child index when it's created? 
</pre>
    </div>

    <div id="c34" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=200897#c34">Comment 34</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Pawel Piech</span> <a href="http://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=pawel.1.piech&#64;gmail.com" alt="CLA" title="Eclipse Contributor Agreement" /></a> <a href="https://eclipse.org/donate/"><img class="cla_dec" src="//www.eclipse.org/donate/web-api/friends_decorator.php?email=pawel.1.piech&#64;gmail.com" alt="Friend" title="Friend of Eclipse" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2007-12-14 12:30:43 EST
        </span>

      </div>




<pre class="bz_comment_text">(In reply to <a href="show_bug.cgi?id=200897#c32">comment #32</a>)
<span class="quote">&gt; (In reply to <a href="show_bug.cgi?id=200897#c31">comment #31</a>)
&gt; Personally, I prefer keeping the expression with the array index and I think it
&gt; is acceptable to use the full expression in the case it was created by the
&gt; user.
&gt; 
&gt; Your opinion?</span >

I agree.

</pre>
    </div>

    <div id="c35" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=200897#c35">Comment 35</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Pawel Piech</span> <a href="http://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=pawel.1.piech&#64;gmail.com" alt="CLA" title="Eclipse Contributor Agreement" /></a> <a href="https://eclipse.org/donate/"><img class="cla_dec" src="//www.eclipse.org/donate/web-api/friends_decorator.php?email=pawel.1.piech&#64;gmail.com" alt="Friend" title="Friend of Eclipse" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2007-12-14 12:56:54 EST
        </span>

      </div>




<pre class="bz_comment_text">(In reply to <a href="show_bug.cgi?id=200897#c31">comment #31</a>)
<span class="quote">&gt; It turns out that taking a fully-qualified expression from GDB and extracting
&gt; the relative expression is complex.  The reason for this is that expressions
&gt; can be manually created by the user; and GDB keeps the same expression to build
&gt; the full expression, even for the children.  What that means is that a full
&gt; expression, as returned by GDB does not have a simple-well-defined format. 
&gt; Basically, an expression can have any valid C format, with extra casts, extra
&gt; parentheses, multiple spaces, etc.
&gt; We could seen expressions like ((((foo)   f).z) + (a)) and worse.
&gt; 
&gt; To me, parsing such strings in the frontend, gets into compiler syntax and,
&gt; although possible, is probably not a good idea and not worth the effort.</span >

I agree that this could be a rabbit hole of a task to try to get it perfect.  At the same time, maybe getting it right most of the time (but consistent) would be good enough.  After all, if the user types in a complex expression like above, there is no way to determine the name, so it should just be the whole expression.

What if the code to calculate the name looked something like this:


int curIdx =  expr.lentgh() - 1;
int nameStart = curIdx;
char[] exprChars = expr.getChars();
boolean wasDigit = false;
boolean wasSpace = false;
while (curIdx &gt;= 0) {
    char[] curChar = exprChars[curIdx];

    if (wasSpace) {
        if (Character.isSpaceChar(curChar)) {
            curIdx--;
            continue;
        } 
        if (curChar == '&gt;' &amp;&amp; cudIdx &gt; 0 &amp;&amp; exprChars[curIdx-1] == '-') {
            break;
        }
    }
    if (Character.isLetter(curChar) || '_' == curChar) {
        nameIdx--;
        curIdx--;
        continue;
    }
    if (Character.isDigit(curChar)) {
        wasDigit = true;
        nameIdx--;
        curIdx--;
        continue;
    }
    if (curChar == '&gt;' &amp;&amp; cudIdx &gt; 0 &amp;&amp; exprChars[curIdx-1] == '-') {
        break;
    }
    if (curChar == '.') {
        break;
    }    
}

if (!wasDigit &amp;&amp; nameIdx &lt; (expr.length() - 1)) {
    name = expr.substring(nameIdx);
} else {
    name = expr;
}


I'm sure there's a more elegant way to do this using regexp, but I'm not very good with those.</pre>
    </div>

    <div id="c36" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=200897#c36">Comment 36</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Pawel Piech</span> <a href="http://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=pawel.1.piech&#64;gmail.com" alt="CLA" title="Eclipse Contributor Agreement" /></a> <a href="https://eclipse.org/donate/"><img class="cla_dec" src="//www.eclipse.org/donate/web-api/friends_decorator.php?email=pawel.1.piech&#64;gmail.com" alt="Friend" title="Friend of Eclipse" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2007-12-14 13:05:29 EST
        </span>

      </div>




<pre class="bz_comment_text">OK, that was rather sloppy, let me try again:

int nameIdx = curIdx;
char[] exprChars = expr.getChars();
boolean wasDigit = false;
boolean wasSpace = false;
for (int curIdx = nameIdx; curIdx &gt;= 0; curIdx--) {
    char[] curChar = exprChars[curIdx];
    if (wasSpace) {
        // If encountered a space, only look for &quot;-&gt;&quot;, if not found, give up.
        if (Character.isSpaceChar(curChar)) {
            continue;
        } 
        if (curChar == '&gt;' &amp;&amp; cudIdx &gt; 0 &amp;&amp; exprChars[curIdx-1] == '-') {
            break;
        }
        nameStart = expr.length();
        break;
    }
    if (Character.isSpaceChar(curChar)) {
        wasSpace = true;
        wasDigit = false;
        continue;
    } 
    if (Character.isLetter(curChar) || '_' == curChar) {
        wasDigit = false;
        nameIdx--;
        continue;
    }
    if (Character.isDigit(curChar)) {
        wasDigit = true;
        nameIdx--;
        continue;
    }
    if (curChar == '&gt;' &amp;&amp; cudIdx &gt; 0 &amp;&amp; exprChars[curIdx-1] == '-') {
        // Check for &quot;-&gt;&quot;.  If found, stop searching.
        break;
    }
    if (curChar == '.') {
        // If &quot;.&quot; found, stop searching.
        break;
    }    
    // If we got this far, we have a complex expression, give up.
    nameStart = expr.length();
    break;
}

if (!wasDigit &amp;&amp; nameIdx &lt; (expr.length() - 1)) {
    name = expr.substring(nameIdx);
} else {
    name = expr;
}</pre>
    </div>

    <div id="c37" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=200897#c37">Comment 37</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Marc Khouzam</span> <a href="http://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=marc.khouzam&#64;gmail.com" alt="CLA" title="Eclipse Contributor Agreement" /></a> <a href="https://eclipse.org/donate/"><img class="cla_dec" src="//www.eclipse.org/donate/web-api/friends_decorator.php?email=marc.khouzam&#64;gmail.com" alt="Friend" title="Friend of Eclipse" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2007-12-14 14:32:01 EST
        </span>

      </div>




<pre class="bz_comment_text">(In reply to <a href="show_bug.cgi?id=200897#c33">comment #33</a>)
<span class="quote">&gt; But how do you calculate the relative
&gt; expression name when creating the child contexts?  Do you call
&gt; -var-info-expression at that point?  Come to think of it, do you also call
&gt; -var-info-expression-path for each child index when it's created? </span >

For children of arrays, which we create ourselves (no var-list-children), I add &quot;[index]&quot; to the full expression and to the relative expression taken from the parent expression context (the one we are requesting the children of.)

For children of non-arrays, I get the full expression by calling -var-info-path-expression for each child (but I will make sure this is still necessary with the current suggested solution.)
And I get the relative expression directly from the result of -var-list-children
 

P.S. I will have a look at your algo now. 

</pre>
    </div>

    <div id="c38" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=200897#c38">Comment 38</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Marc Khouzam</span> <a href="http://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=marc.khouzam&#64;gmail.com" alt="CLA" title="Eclipse Contributor Agreement" /></a> <a href="https://eclipse.org/donate/"><img class="cla_dec" src="//www.eclipse.org/donate/web-api/friends_decorator.php?email=marc.khouzam&#64;gmail.com" alt="Friend" title="Friend of Eclipse" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2007-12-14 14:49:53 EST
        </span>

      </div>




<pre class="bz_comment_text">(In reply to <a href="show_bug.cgi?id=200897#c36">comment #36</a>)

I should have given you one of the examples that caused me problems right away.

Types:
class bar { int b; }
class foo : bar { int a; } f;
int i;

Expressions:
(int) i
(bar) f

those are both valid GDB expressions, but to be able to know that the relative expression of the first one is &quot;i&quot; while for the second it is &quot;bar&quot;, requires us to start comparing types to know if we are dealing with a basic type or not.  Of course, we can probably do that, but it illustrates that we are pretty much guaranteed to miss some scenarios and we'll have to keep on fixing this algo.

If you feel it is worth doing, I will do my best, but in my opinion, I think we will have a lesser quality product by not having an algo we can trust.

What you don't like is the fact that we can't compare IExpressionContexts properly anymore if we have the relative expression in it?  Or are there other reasons?

And about comparing IExpressionContexts, can we ignore the fact that we currently probably have a bug in the views when changing an expression like
&quot;(int) i&quot; and not refreshing &quot;i&quot;, or should we fix the views?

</pre>
    </div>

    <div id="c39" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=200897#c39">Comment 39</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Pawel Piech</span> <a href="http://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=pawel.1.piech&#64;gmail.com" alt="CLA" title="Eclipse Contributor Agreement" /></a> <a href="https://eclipse.org/donate/"><img class="cla_dec" src="//www.eclipse.org/donate/web-api/friends_decorator.php?email=pawel.1.piech&#64;gmail.com" alt="Friend" title="Friend of Eclipse" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2007-12-14 15:03:48 EST
        </span>

      </div>




<pre class="bz_comment_text">(In reply to <a href="show_bug.cgi?id=200897#c38">comment #38</a>)
<span class="quote">&gt; If you feel it is worth doing, I will do my best, but in my opinion, I think we
&gt; will have a lesser quality product by not having an algo we can trust.</span >
I haven't programmed in C/C++ in almost a decade so I was just grossly oversimplifying the problem.  I agree that if we'd have to keep adjusting this algorithm, it's really not a good solution.

I think we've beat this one to death, let's just go with your proposal and move on :-)</pre>
    </div>

    <div id="c40" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=200897#c40">Comment 40</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Marc Khouzam</span> <a href="http://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=marc.khouzam&#64;gmail.com" alt="CLA" title="Eclipse Contributor Agreement" /></a> <a href="https://eclipse.org/donate/"><img class="cla_dec" src="//www.eclipse.org/donate/web-api/friends_decorator.php?email=marc.khouzam&#64;gmail.com" alt="Friend" title="Friend of Eclipse" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2007-12-14 15:10:43 EST
        </span>

      </div>




<pre class="bz_comment_text">(In reply to <a href="show_bug.cgi?id=200897#c39">comment #39</a>)

<span class="quote">&gt; I think we've beat this one to death, let's just go with your proposal and move
&gt; on :-)</span >

:-)

So, I change IExpressionDMContext to have the method getRelativeExpression()?
What do we do about the views? 

</pre>
    </div>

    <div id="c41" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=200897#c41">Comment 41</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Pawel Piech</span> <a href="http://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=pawel.1.piech&#64;gmail.com" alt="CLA" title="Eclipse Contributor Agreement" /></a> <a href="https://eclipse.org/donate/"><img class="cla_dec" src="//www.eclipse.org/donate/web-api/friends_decorator.php?email=pawel.1.piech&#64;gmail.com" alt="Friend" title="Friend of Eclipse" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2007-12-14 15:25:30 EST
        </span>

      </div>




<pre class="bz_comment_text">(In reply to <a href="show_bug.cgi?id=200897#c40">comment #40</a>)
<span class="quote">&gt; What do we do about the views? </span >
Let's leave the IExpressionDMData.getName() in place, and have the views still use it.  There are other back ends which are capable of calculating the name, and this will be more accurate than the relative expression.

The thing we'll have to change in the views is updating the whole view when we get an &quot;expression changed event&quot;.  Can you open a new bug for this?

</pre>
    </div>

    <div id="c42" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=200897#c42">Comment 42</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Marc Khouzam</span> <a href="http://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=marc.khouzam&#64;gmail.com" alt="CLA" title="Eclipse Contributor Agreement" /></a> <a href="https://eclipse.org/donate/"><img class="cla_dec" src="//www.eclipse.org/donate/web-api/friends_decorator.php?email=marc.khouzam&#64;gmail.com" alt="Friend" title="Friend of Eclipse" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2007-12-17 11:21:41 EST
        </span>

      </div>




<pre class="bz_comment_text">Hi Pawel,

In IExpressions, I was thinking of having two createExpression methods:
 
IExpressionDMContext createExpression(IDMContext ctx, String expression);

IExpressionDMContext createExpression(IDMContext ctx, String expression, String relativeExpression);

It would allow most services that use the Expression service to be unchanged by still using the single expression form.  While the ExpressionService itself would use the second form since it is the only one that creates children, and therefore, knows about the relative expression (and needs to use it.)

It made me think that since it is only the GDB ExpressionService that uses the extended IExpressionDMC (with relative expression) that maybe we should not put the relative expression in IExpressions, but in MIExperssionDMC only.  Same for the second createExpression() method above.

Thanks in advance for your input.</pre>
    </div>

    <div id="c43" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=200897#c43">Comment 43</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Pawel Piech</span> <a href="http://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=pawel.1.piech&#64;gmail.com" alt="CLA" title="Eclipse Contributor Agreement" /></a> <a href="https://eclipse.org/donate/"><img class="cla_dec" src="//www.eclipse.org/donate/web-api/friends_decorator.php?email=pawel.1.piech&#64;gmail.com" alt="Friend" title="Friend of Eclipse" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2007-12-17 12:20:36 EST
        </span>

      </div>




<pre class="bz_comment_text">(In reply to <a href="show_bug.cgi?id=200897#c42">comment #42</a>)
<span class="quote">&gt; It made me think that since it is only the GDB ExpressionService that uses the
&gt; extended IExpressionDMC (with relative expression) that maybe we should not put
&gt; the relative expression in IExpressions, but in MIExperssionDMC only.  Same for
&gt; the second createExpression() method above.</span >
I like that idea!  One reason I was resisting having the relative expression in the DMC was changing the IExpressionDMC interface again.  But if it's just MIExpressionDMC that has the getRelativeExpression() then it wouldn't be a problem :-)
</pre>
    </div>

    <div id="c44" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=200897#c44">Comment 44</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Marc Khouzam</span> <a href="http://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=marc.khouzam&#64;gmail.com" alt="CLA" title="Eclipse Contributor Agreement" /></a> <a href="https://eclipse.org/donate/"><img class="cla_dec" src="//www.eclipse.org/donate/web-api/friends_decorator.php?email=marc.khouzam&#64;gmail.com" alt="Friend" title="Friend of Eclipse" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2007-12-17 13:00:11 EST
        </span>

      </div>




<pre class="bz_comment_text">Created <span class=""><a href="attachment.cgi?id=85399&amp;action=diff" name="attach_85399" title="Handling of children and relative expressions">attachment 85399</a> <a href="attachment.cgi?id=85399&amp;action=edit" title="Handling of children and relative expressions">[details]</a></span>
Handling of children and relative expressions

This is the code I will submit now.  It incorporates the many discussions we have had.  From my latest testing, the handling of children is very good (better than CDT even).

I welcome any more comments if you feel inclined to look into this some more, although I fully understand if you have had your fill :-)</pre>
    </div>

    <div id="c45" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=200897#c45">Comment 45</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Marc Khouzam</span> <a href="http://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=marc.khouzam&#64;gmail.com" alt="CLA" title="Eclipse Contributor Agreement" /></a> <a href="https://eclipse.org/donate/"><img class="cla_dec" src="//www.eclipse.org/donate/web-api/friends_decorator.php?email=marc.khouzam&#64;gmail.com" alt="Friend" title="Friend of Eclipse" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2008-01-14 09:59:32 EST
        </span>

      </div>




<pre class="bz_comment_text">This bug is fully fixed with the latest patch submitted to <a class="bz_bug_link 
          bz_status_CLOSED  bz_closed"
   title="CLOSED FIXED - [variables] Implement expression service using standard MI"
   href="show_bug.cgi?id=159696">bug 159696</a></pre>
    </div>

    <div id="c46" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=200897#c46">Comment 46</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Pawel Piech</span> <a href="http://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=pawel.1.piech&#64;gmail.com" alt="CLA" title="Eclipse Contributor Agreement" /></a> <a href="https://eclipse.org/donate/"><img class="cla_dec" src="//www.eclipse.org/donate/web-api/friends_decorator.php?email=pawel.1.piech&#64;gmail.com" alt="Friend" title="Friend of Eclipse" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2008-08-13 13:06:59 EDT
        </span>

      </div>




<pre class="bz_comment_text">Closing out 1.0 bugs.</pre>
    </div>


  

</td>
<td>
</td>
</tr></table>
  </div>
        

</form>

<hr>
<ul class="related_actions">
    <li><a href="show_bug.cgi?format=multiple&amp;id=200897">Format For Printing</a></li>
    <li>&nbsp;-&nbsp;<a href="show_bug.cgi?ctype=xml&amp;id=200897">XML</a></li>
    <li>&nbsp;-&nbsp;<a href="enter_bug.cgi?cloned_bug_id=200897">Clone This Bug</a></li>
    
    <li>&nbsp;-&nbsp;<a href="#">Top of page </a></li>
    </ul>

<br>
</div>

    <div id="footer">
      <div class="intro"></div>
<ul id="useful-links">
  <li id="links-actions"><ul class="links">
  <li><a href="./">Home</a></li>
  <li><span class="separator">| </span><a href="enter_bug.cgi">New</a></li>
  <li><span class="separator">| </span><a href="describecomponents.cgi">Browse</a></li>
  <li><span class="separator">| </span><a href="query.cgi">Search</a></li>

  <li class="form">
    <span class="separator">| </span>
    <form action="buglist.cgi" method="get"
        onsubmit="if (this.quicksearch.value == '')
                  { alert('Please enter one or more search terms first.');
                    return false; } return true;">
    <input type="hidden" id="no_redirect_bottom" name="no_redirect" value="0">
    <script type="text/javascript">
      if (history && history.replaceState) {
        var no_redirect = document.getElementById("no_redirect_bottom");
        no_redirect.value = 1;
      }
    </script>
    <input class="txt" type="text" id="quicksearch_bottom" name="quicksearch" 
           title="Quick Search" value="">
    <input class="btn" type="submit" value="Search" 
           id="find_bottom"></form>
  <a href="page.cgi?id=quicksearch.html" title="Quicksearch Help">[?]</a></li>

  <li><span class="separator">| </span><a href="report.cgi">Reports</a></li>

  <li>
      <span class="separator">| </span>
        <a href="request.cgi">Requests</a></li>


  <li>
        <span class="separator">| </span>
        <a href="https://bugzilla.readthedocs.org/en/5.0/using/understanding.html" target="_blank">Help</a>
      </li>
    

    <li id="mini_login_container_bottom">
  <span class="separator">| </span>
  <a id="login_link_bottom" href="show_bug.cgi?id=200897&amp;GoAheadAndLogIn=1"
     onclick="return show_mini_login_form('_bottom')">Log In</a>

  <form action="show_bug.cgi?id=200897" method="POST"
        class="mini_login bz_default_hidden"
        id="mini_login_bottom">
    <input id="Bugzilla_login_bottom" required
           name="Bugzilla_login" class="bz_login"
        placeholder="Login">
    <input class="bz_password" name="Bugzilla_password" type="password"
           id="Bugzilla_password_bottom" required
           placeholder="Password">
    <input type="hidden" name="Bugzilla_login_token"
           value="">
    <input type="submit" name="GoAheadAndLogIn" value="Log in"
            id="log_in_bottom">
    <a href="#" onclick="return hide_mini_login_form('_bottom')">[x]</a>
  </form>
</li>
  <span class="separator">| </span>
  <li><a href="http://www.eclipse.org/legal/termsofuse.php">Terms of Use</a></li>
  <span class="separator">| </span>
  <li><a href="http://www.eclipse.org/legal/copyright.php">Copyright Agent</a></li>
</ul>
  </li>

  




  
</ul>

      <div class="outro"></div>
    </div>

  </body>
</html>
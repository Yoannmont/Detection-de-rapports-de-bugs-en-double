<!DOCTYPE html>
<html lang="en">
  <head>
    <title>86503 &ndash; [typing] Copy/paste text into an external editor produces blue background</title>

      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<link href="https://bugs.eclipse.org/bugs/data/assets/03c4bb46b12126a79867f9a9f5323634.css?1593441374" rel="stylesheet" type="text/css">



    
<script type="text/javascript" src="https://bugs.eclipse.org/bugs/data/assets/a7c2f3a028f17a9aa60f56dc9d6e732d.js?1593441374"></script>

    <script type="text/javascript">
    <!--
        YAHOO.namespace('bugzilla');
        YAHOO.util.Event.addListener = function (el, sType, fn, obj, overrideContext) {
               if ( ("onpagehide" in window || YAHOO.env.ua.gecko) && sType === "unload") { sType = "pagehide"; };
               var capture = ((sType == "focusin" || sType == "focusout") && !YAHOO.env.ua.ie) ? true : false;
               return this._addListener(el, this._getType(sType), fn, obj, overrideContext, capture);
         };
        if ( "onpagehide" in window || YAHOO.env.ua.gecko) {
            YAHOO.util.Event._simpleRemove(window, "unload", 
                                           YAHOO.util.Event._unload);
        }
        
        function unhide_language_selector() { 
            YAHOO.util.Dom.removeClass(
                'lang_links_container', 'bz_default_hidden'
            ); 
        } 
        YAHOO.util.Event.onDOMReady(unhide_language_selector);

        
        var BUGZILLA = {
            param: {
                cookiepath: '\/bugs',
                maxusermatches: 10
            },
            constant: {
                COMMENT_COLS: 80
            },
            string: {
                

                attach_desc_required:
                    "You must enter a Description for this attachment.",
                component_required:
                    "You must select a Component for this bug.",
                description_required:
                    "You must enter a Description for this bug.",
                short_desc_required:
                    "You must enter a Summary for this bug.",
                version_required:
                    "You must select a Version for this bug."
            }
              , api_token: ''
        };

    if (history && history.replaceState) {
      if(!document.location.href.match(/show_bug\.cgi/)) {
        history.replaceState( null,
                             "86503 – [typing] Copy\/paste text into an external editor produces blue background",
                             "show_bug.cgi?id=86503" );
        document.title = "86503 – [typing] Copy\/paste text into an external editor produces blue background";
      }
      if (document.location.href.match(/show_bug\.cgi\?.*list_id=/)) {
        var href = document.location.href;
        href = href.replace(/[\?&]+list_id=(\d+|cookie)/, '');
        history.replaceState(null, "86503 – [typing] Copy\/paste text into an external editor produces blue background", href);
      }
    }
    YAHOO.util.Event.onDOMReady(function() {
      initDirtyFieldTracking();

    });
    // -->
    </script>
<script type="text/javascript" src="https://bugs.eclipse.org/bugs/data/assets/daf5e0fb6826e6a35280e622913f0c4a.js?1593441374"></script>

    

    
    <link rel="search" type="application/opensearchdescription+xml"
                       title="Bugzilla" href="./search_plugin.cgi">
    <link rel="shortcut icon" href="images/favicon.ico">
  </head>

  <body 
        class="bugs-eclipse-org-bugs
                 bz_bug
                 bz_status_CLOSED
                 bz_product_Platform
                 bz_component_Text
                 bz_bug_86503 yui-skin-sam">

  <div id="header"><!-- 1.0@bugzilla.org -->





<!--  START OF SOLSTICE HEADER -->
 <link rel="stylesheet" type="text/css" href="https://www.eclipse.org/eclipse.org-common/themes/solstice/public/stylesheets/vendor/cookieconsent/cookieconsent.min.css" />
 <script src="https://www.eclipse.org/eclipse.org-common/themes/solstice/public/javascript/vendor/cookieconsent/default.min.js"></script>
 <style type="text/css">
    @import url('https://www.eclipse.org/eclipse.org-common/themes/solstice/public/stylesheets/barebone.min.css')
    </style>
    <script
      src="https://www.eclipse.org/eclipse.org-common/themes/solstice/public/javascript/barebone.min.js">
    </script><header role="banner" class="barebone-layout thin-header padding-top-5 padding-bottom-5"  id="header-wrapper">
  <div class="container-fluid reset">
    <div class="row-fluid" id="header-row">
            <div class="col-sm-8 col-md-6 col-lg-4" id="header-left">
        <div class="wrapper-logo-default"><a href="https://www.eclipse.org/"><img class="logo-eclipse-default img-responsive hidden-xs" alt="logo" src="https://bugs.eclipse.org/eclipse.org-common/themes/solstice/public/images/logo/eclipse-426x100.png"/></a></div>
      </div>            <div class="col-sm-16 col-md-18 col-lg-20" id="main-menu-wrapper">
  <div class="navbar yamm" id="main-menu">
    <div id="navbar-collapse-1" class="navbar-collapse collapse">
      <ul class="nav navbar-nav navbar-right">
        <li class="visible-thin"><a href="https://www.eclipse.org/downloads/" target="_self">Download</a></li><li><a href="https://www.eclipse.org/users/" target="_self">Getting Started</a></li><li><a href="https://www.eclipse.org/membership/" target="_self">Members</a></li><li><a href="https://www.eclipse.org/projects/" target="_self">Projects</a></li>                  <li class="dropdown visible-xs"><a href="#" data-toggle="dropdown" class="dropdown-toggle">Community <b class="caret"></b></a><ul class="dropdown-menu"><li><a href="http://marketplace.eclipse.org">Marketplace</a></li><li><a href="http://events.eclipse.org">Events</a></li><li><a href="http://www.planeteclipse.org/">Planet Eclipse</a></li><li><a href="https://www.eclipse.org/community/eclipse_newsletter/">Newsletter</a></li><li><a href="https://www.youtube.com/user/EclipseFdn">Videos</a></li></ul></li><li class="dropdown visible-xs"><a href="#" data-toggle="dropdown" class="dropdown-toggle">Participate <b class="caret"></b></a><ul class="dropdown-menu"><li><a href="https://bugs.eclipse.org/bugs/">Report a Bug</a></li><li><a href="https://www.eclipse.org/forums/">Forums</a></li><li><a href="https://www.eclipse.org/mail/">Mailing Lists</a></li><li><a href="https://wiki.eclipse.org/">Wiki</a></li><li><a href="https://wiki.eclipse.org/IRC">IRC</a></li><li><a href="https://www.eclipse.org/contribute/">How to Contribute</a></li></ul></li><li class="dropdown visible-xs"><a href="#" data-toggle="dropdown" class="dropdown-toggle">Working Groups <b class="caret"></b></a><ul class="dropdown-menu"><li><a href="http://wiki.eclipse.org/Auto_IWG">Automotive</a></li><li><a href="http://iot.eclipse.org">Internet of Things</a></li><li><a href="http://locationtech.org">LocationTech</a></li><li><a href="http://lts.eclipse.org">Long-Term Support</a></li><li><a href="http://polarsys.org">PolarSys</a></li><li><a href="http://science.eclipse.org">Science</a></li><li><a href="http://www.openmdm.org">OpenMDM</a></li></ul></li>          <!-- More -->
          <li class="dropdown eclipse-more hidden-xs">
            <a data-toggle="dropdown" class="dropdown-toggle">More<b class="caret"></b></a>
            <ul class="dropdown-menu">
              <li>
                <!-- Content container to add padding -->
                <div class="yamm-content">
                  <div class="row">
                    <ul class="col-sm-8 list-unstyled"><li><p><strong>Community</strong></p></li><li><a href="http://marketplace.eclipse.org">Marketplace</a></li><li><a href="http://events.eclipse.org">Events</a></li><li><a href="http://www.planeteclipse.org/">Planet Eclipse</a></li><li><a href="https://www.eclipse.org/community/eclipse_newsletter/">Newsletter</a></li><li><a href="https://www.youtube.com/user/EclipseFdn">Videos</a></li></ul><ul class="col-sm-8 list-unstyled"><li><p><strong>Participate</strong></p></li><li><a href="https://bugs.eclipse.org/bugs/">Report a Bug</a></li><li><a href="https://www.eclipse.org/forums/">Forums</a></li><li><a href="https://www.eclipse.org/mail/">Mailing Lists</a></li><li><a href="https://wiki.eclipse.org/">Wiki</a></li><li><a href="https://wiki.eclipse.org/IRC">IRC</a></li><li><a href="https://www.eclipse.org/contribute/">How to Contribute</a></li></ul><ul class="col-sm-8 list-unstyled"><li><p><strong>Working Groups</strong></p></li><li><a href="http://wiki.eclipse.org/Auto_IWG">Automotive</a></li><li><a href="http://iot.eclipse.org">Internet of Things</a></li><li><a href="http://locationtech.org">LocationTech</a></li><li><a href="http://lts.eclipse.org">Long-Term Support</a></li><li><a href="http://polarsys.org">PolarSys</a></li><li><a href="http://science.eclipse.org">Science</a></li><li><a href="http://www.openmdm.org">OpenMDM</a></li></ul>                  </div>
                </div>
              </li>
            </ul>
          </li>
              </ul>
    </div>
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar-collapse-1">
      <span class="sr-only">Toggle navigation</span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      </button>
      <div class="wrapper-logo-mobile"><a class="navbar-brand visible-xs" href="https://www.eclipse.org/"><img class="logo-eclipse-default-mobile img-responsive" alt="logo" src="https://bugs.eclipse.org/eclipse.org-common/themes/solstice/public/images/logo/eclipse-800x188.png"/></a></div>    </div>
  </div>
</div>
    </div>
  </div>
</header>
<!--  END OF SOLSTICE HEADER -->

    <div id="titles">
      <span id="title">Bugzilla &ndash; Bug&nbsp;86503</span>

        <span id="subtitle" class="subheader">[typing] Copy/paste text into an external editor produces blue background</span>

        <span id="information" class="header_addl_info">Last modified: 2018-08-29 10:11:09 EDT</span>
    </div>


    <div id="common_links"><ul class="links">
  <li><a href="./">Home</a></li>
  <li><span class="separator">| </span><a href="enter_bug.cgi">New</a></li>
  <li><span class="separator">| </span><a href="describecomponents.cgi">Browse</a></li>
  <li><span class="separator">| </span><a href="query.cgi">Search</a></li>

  <li class="form">
    <span class="separator">| </span>
    <form action="buglist.cgi" method="get"
        onsubmit="if (this.quicksearch.value == '')
                  { alert('Please enter one or more search terms first.');
                    return false; } return true;">
    <input type="hidden" id="no_redirect_top" name="no_redirect" value="0">
    <script type="text/javascript">
      if (history && history.replaceState) {
        var no_redirect = document.getElementById("no_redirect_top");
        no_redirect.value = 1;
      }
    </script>
    <input class="txt" type="text" id="quicksearch_top" name="quicksearch" 
           title="Quick Search" value="">
    <input class="btn" type="submit" value="Search" 
           id="find_top"></form>
  <a href="page.cgi?id=quicksearch.html" title="Quicksearch Help">[?]</a></li>

  <li><span class="separator">| </span><a href="report.cgi">Reports</a></li>

  <li>
      <span class="separator">| </span>
        <a href="request.cgi">Requests</a></li>


  <li>
        <span class="separator">| </span>
        <a href="https://bugzilla.readthedocs.org/en/5.0/using/understanding.html" target="_blank">Help</a>
      </li>
    

    <li id="mini_login_container_top">
  <span class="separator">| </span>
  <a id="login_link_top" href="show_bug.cgi?id=86503&amp;GoAheadAndLogIn=1"
     onclick="return show_mini_login_form('_top')">Log In</a>

  <form action="show_bug.cgi?id=86503" method="POST"
        class="mini_login bz_default_hidden"
        id="mini_login_top">
    <input id="Bugzilla_login_top" required
           name="Bugzilla_login" class="bz_login"
        placeholder="Login">
    <input class="bz_password" name="Bugzilla_password" type="password"
           id="Bugzilla_password_top" required
           placeholder="Password">
    <input type="hidden" name="Bugzilla_login_token"
           value="">
    <input type="submit" name="GoAheadAndLogIn" value="Log in"
            id="log_in_top">
    <a href="#" onclick="return hide_mini_login_form('_top')">[x]</a>
  </form>
</li>
  <span class="separator">| </span>
  <li><a href="http://www.eclipse.org/legal/termsofuse.php">Terms of Use</a></li>
  <span class="separator">| </span>
  <li><a href="http://www.eclipse.org/legal/copyright.php">Copyright Agent</a></li>
</ul>
    </div>
  </div>

  <div id="bugzilla-body">


<script type="text/javascript">
<!--

//-->
</script>

<form name="changeform" id="changeform" method="post" action="process_bug.cgi">

  <input type="hidden" name="delta_ts" value="2018-08-29 10:11:09">
  <input type="hidden" name="id" value="86503">
  <input type="hidden" name="token" value="1629873491-6Q1qIRP_jKP5MXCXvXPMXent0ey-UXCZPgpGXLdwZJY">
<div class="bz_short_desc_container edit_form">
     <a href="show_bug.cgi?id=86503"><b>Bug&nbsp;86503</b></a> <span id="summary_container" class="bz_default_hidden">
      - <span id="short_desc_nonedit_display">[typing] Copy/paste text into an external editor produces blue background</span>
     </span>

    <div id="summary_input"><span class="field_label "
    id="field_label_short_desc">


  <a 
      title="The bug summary is a short sentence which succinctly describes what the bug is about."
      class="field_help_link"
      href="page.cgi?id=fields.html#short_desc"
  >Summary:</a>

</span>[typing] Copy/paste text into an external editor produces blue background
    </div>
  </div>
  <script type="text/javascript">
    hideEditableField('summary_container',
                      'summary_input',
                      'summary_edit_action',
                      'short_desc',
                      '[typing] Copy\/paste text into an external editor produces blue background' );
  </script>
  <table class="edit_form">
    <tr>
      
      <td id="bz_show_bug_column_1" class="bz_show_bug_column">     
        <table>
          <tr>
    <th class="field_label">
      <a href="page.cgi?id=fields.html#bug_status">Status</a>:
    </th>
    <td id="bz_field_status">
      <span id="static_bug_status">CLOSED
          DUPLICATE
            of <a class="bz_bug_link 
          bz_status_VERIFIED  bz_closed"
   title="VERIFIED FIXED - RTFWriter ignores background color"
   href="show_bug.cgi?id=529241">bug 529241</a>
      </span>
    </td>
  </tr>
<tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
<tr><th class="field_label "
    id="field_label_alias">


  <a 
      title="A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla."
      class="field_help_link"
      href="page.cgi?id=fields.html#alias"
  >Alias:</a>

</th>
    <td>
        None
    </td>
  </tr>
<tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
<tr><th class="field_label "
    id="field_label_product">


  <a 
      title="Bugs are categorised into Products and Components. Select a Classification to narrow down this list."
      class="field_help_link"
      href="describecomponents.cgi"
  >Product:</a>

</th>
  <td class="field_value "
      id="field_container_product" >Platform

</td>
    </tr>

    
    <tr class="bz_default_hidden"><th class="field_label "
    id="field_label_classification">


  <a 
      title="Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation."
      class="field_help_link"
      href="page.cgi?id=fields.html#classification"
  >Classification:</a>

</th>
  <td class="field_value "
      id="field_container_classification" >Eclipse Project

</td>
    </tr>
        
    
    
    <tr><th class="field_label "
    id="field_label_component">


  <a 
      title="Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list."
      class="field_help_link"
      href="describecomponents.cgi?product=Platform"
  >Component:</a>

</th>
  <td class="field_value "
      id="field_container_component" >Text

  (<a href="buglist.cgi?component=Text&amp;product=Platform&amp;bug_status=__open__"
      target="_blank">show other bugs</a>)
</td>
    </tr>
    <tr><th class="field_label "
    id="field_label_version">


  <a 
      title="The version field defines the version of the software the bug was found in."
      class="field_help_link"
      href="page.cgi?id=fields.html#version"
  >Version:</a>

</th>

      <td>3.1 &#160; <a href="https://dev.eclipse.org/committers/bugs/bugz_manager.php"><img src="//dev.eclipse.org/small_icons/apps/accessories-text-editor.png" alt="Edit" title="Edit these values" /></a></td>
    </tr>
        
    
        
    <tr><th class="field_label "
    id="field_label_rep_platform">


  <a 
      title="The hardware platform the bug was observed on. Note: When searching, selecting the option &quot;All&quot; only finds bugs whose value for this field is literally the word &quot;All&quot;."
      class="field_help_link"
      href="page.cgi?id=fields.html#rep_platform"
  >Hardware:</a>

</th>
      <td class="field_value">PC
        Windows XP
      </td>
    </tr>
          <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
          
          <tr>
      <th class="field_label">
        <label  accesskey="i">
          <a href="page.cgi?id=fields.html#importance"><u>I</u>mportance</a></label>:
      </th>
      <td>P3
       minor<span id="votes_container">
      with
      <a href="page.cgi?id=voting/bug.html&amp;bug_id=86503">13 
            votes</a>
    (<a href="page.cgi?id=voting/user.html&amp;bug_id=86503#vote_86503">vote</a>)
  </span>
      </td>
    </tr>

      <tr><th class="field_label "
    id="field_label_target_milestone">


  <a 
      title="The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it."
      class="field_help_link"
      href="page.cgi?id=fields.html#target_milestone"
  >Target Milestone:</a>

</th>
        <td>--- &#160; <a href="https://dev.eclipse.org/committers/bugs/bugz_manager.php"><img src="//dev.eclipse.org/small_icons/apps/accessories-text-editor.png" alt="Edit" title="Edit these values" /></a></td>
      </tr>
          
          <tr><th class="field_label "
    id="field_label_assigned_to">


  <a 
      title="The person in charge of resolving the bug."
      class="field_help_link"
      href="page.cgi?id=fields.html#assigned_to"
  >Assignee:</a>

</th>
      <td><span class="vcard"><span class="fn">Platform-Text-Inbox</span> <a href="http://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=platform-text-inbox&#64;eclipse.org" alt="CLA" title="Eclipse Contributor Agreement" /></a> <a href="https://eclipse.org/donate/"><img class="cla_dec" src="//www.eclipse.org/donate/web-api/friends_decorator.php?email=platform-text-inbox&#64;eclipse.org" alt="Friend" title="Friend of Eclipse" /></a>
</span>
      </td>
    </tr>

    <tr><th class="field_label "
    id="field_label_qa_contact">


  <a 
      title="The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved."
      class="field_help_link"
      href="page.cgi?id=fields.html#qa_contact"
  >QA Contact:</a>

</th>
      <td><span class="vcard">
</span>
      </td>
    </tr>
    <script type="text/javascript">
      assignToDefaultOnChange(['product', 'component'],
        'platform-text-inbox\x40eclipse.org',
        '');
    </script>
          <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
          <tr><th class="field_label "
    id="field_label_bug_file_loc">


  <a 
      title="Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen."
      class="field_help_link"
      href="page.cgi?id=fields.html#bug_file_loc"
  >URL:</a>

</th>
    <td>
      <span id="bz_url_input_area">
      </span>
    </td>
  </tr>

    <tr><th class="field_label "
    id="field_label_status_whiteboard">


  <a 
      title="Each bug has a free-form single line text entry box for adding tags and status information."
      class="field_help_link"
      href="page.cgi?id=fields.html#status_whiteboard"
  >Whiteboard:</a>

</th><td>  
  </td>
    </tr>

    <tr><th class="field_label "
    id="field_label_keywords">


  <a 
      title="You can add keywords from a defined list to bugs, in order to easily identify and group them."
      class="field_help_link"
      href="describekeywords.cgi"
  >Keywords:</a>

</th>
  <td class="field_value "
      id="field_container_keywords" >

</td>
    </tr>
          <tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>

          <tr>
    <th class="field_label">
      <label>Duplicates (7)</label>:
    </th>
    <td class="field_value">
      <span id="duplicates"><a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - Copying a single line from text editor to Outlook results in blue background"
   href="show_bug.cgi?id=160915">160915</a> <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - Copy / paste to MS word keeps selection background after paste"
   href="show_bug.cgi?id=227560">227560</a> <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - [projection] Clipboard Copy &amp; Paste: Selection highlighting background is pasted"
   href="show_bug.cgi?id=254951">254951</a> <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - [typing] text copied from a single line pastes with the wrong background color"
   href="show_bug.cgi?id=282727">282727</a> <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - Highlight text, Copy/Paste, pastes with wrong background color"
   href="show_bug.cgi?id=286166">286166</a> <a class="bz_bug_link 
          bz_status_CLOSED  bz_closed"
   title="CLOSED DUPLICATE - Copy line and paste to MS Word (or Word Pad) works strange: adds background color of selection"
   href="show_bug.cgi?id=398855">398855</a> <a class="bz_bug_link 
          bz_status_CLOSED  bz_closed"
   title="CLOSED DUPLICATE - Single line copy copies unnecessary attributes"
   href="show_bug.cgi?id=471215">471215</a> 
      </span>
      (<a href="buglist.cgi?bug_id=160915,227560,254951,282727,286166,398855,471215">view as bug list</a>)
    </td>
  </tr>
<tr><th class="field_label "
    id="field_label_dependson">


  <a 
      title="The bugs listed here must be resolved before this bug can be resolved."
      class="field_help_link"
      href="page.cgi?id=fields.html#dependson"
  >Depends on:</a>

</th>

  <td>
    <span id="dependson_input_area">
    </span>
<a class="bz_bug_link 
          bz_status_NEW "
   title="NEW - [StyledText] Allow to control StyledText's RTF copy"
   href="show_bug.cgi?id=255013">255013</a> 
  </td>
  </tr>
  
  <tr><th class="field_label "
    id="field_label_blocked">


  <a 
      title="This bug must be resolved before the bugs listed in this field can be resolved."
      class="field_help_link"
      href="page.cgi?id=fields.html#blocked"
  >Blocks:</a>

</th>

  <td>
    <span id="blocked_input_area">
    </span>

  </td>
  </tr>

    <tr>
      <th>&nbsp;</th>

      <td id="show_dependency_tree_or_graph">
        Show dependency <a href="showdependencytree.cgi?id=86503&amp;hide_resolved=1">tree</a>

      </td>
    </tr>
          
        </table>
      </td>
      <td>
        <div class="bz_column_spacer">&nbsp;</div>
      </td>
      
      <td id="bz_show_bug_column_2" class="bz_show_bug_column">
        <table>
        <tr>
    <th class="field_label">
      Reported:
    </th>
    <td>2005-02-24 12:43 EST by <span class="vcard"><span class="fn">Konstantin Kolinko</span> <a href="http://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=Konstantin.Kolinko&#64;siemens.com" alt="CLA" title="Eclipse Contributor Agreement" /></a> <a href="https://eclipse.org/donate/"><img class="cla_dec" src="//www.eclipse.org/donate/web-api/friends_decorator.php?email=Konstantin.Kolinko&#64;siemens.com" alt="Friend" title="Friend of Eclipse" /></a>
</span>
    </td>
  </tr>
  
  <tr>
    <th class="field_label">
      Modified:
    </th>
    <td>2018-08-29 10:11 EDT
      (<a href="show_activity.cgi?id=86503">History</a>)
    </td>
  
  </tr>
<tr>
      <th class="field_label">
        <label  accesskey="a">
          CC List:
        </label>
      </th>
      <td>19 
          users
          <span id="cc_edit_area_showhide_container" class="bz_default_hidden">
            (<a href="#" id="cc_edit_area_showhide">show</a>)
          </span>
        <div id="cc_edit_area">
          <br>
            <select id="cc" multiple="multiple" size="5" >
                <option value="alexey.sharykin">alexey.sharykin</option>
                <option value="andrejohn.mas">andrejohn.mas</option>
                <option value="christian.georgi">christian.georgi</option>
                <option value="daniel_megert">daniel_megert</option>
                <option value="david.balazic">david.balazic</option>
                <option value="dsegall">dsegall</option>
                <option value="gautier.desaintmartinlacaze">gautier.desaintmartinlacaze</option>
                <option value="gunnar">gunnar</option>
                <option value="jonah">jonah</option>
                <option value="Lars.Vogel">Lars.Vogel</option>
                <option value="majmal">majmal</option>
                <option value="mike">mike</option>
                <option value="niraj.modi">niraj.modi</option>
                <option value="philippe.faes">philippe.faes</option>
                <option value="quartz12h">quartz12h</option>
                <option value="sellis">sellis</option>
                <option value="steffen">steffen</option>
                <option value="thomas.wolf">thomas.wolf</option>
                <option value="tobias.melcher">tobias.melcher</option>
            </select>
        </div>
          <script type="text/javascript">
            hideEditableField( 'cc_edit_area_showhide_container', 
                               'cc_edit_area', 
                               'cc_edit_area_showhide', 
                               '', 
                               '');  
          </script>
      </td>
    </tr>

<tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>
<tr><th class="field_label "
    id="field_label_see_also">


  <a 
      title="This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields."
      class="field_help_link"
      href="page.cgi?id=fields.html#see_also"
  >See Also:</a>

</th>
  <td class="field_value "
      id="field_container_see_also" ><ul class="bug_urls">
          <li><img src="//dev.eclipse.org/images/gerrit-16x16.gif"> <a href="https://git.eclipse.org/r/73129">
        Gerrit Change</a>
          </li>
          <li><img src="//dev.eclipse.org/images/gerrit-16x16.gif"> <a href="https://git.eclipse.org/r/112728">
        Gerrit Change</a>
          </li>
          <li><img src="//dev.eclipse.org/images/gerrit-16x16.gif"> <a href="https://git.eclipse.org/r/112799">
        Gerrit Change</a>
          </li></ul>

</td>
    </tr> 

<tr>
    <td colspan="2" class="bz_section_spacer"></td>
  </tr>



        </table>
      </td>
    </tr>
    <tr>
      <td colspan="3">
          <hr id="bz_top_half_spacer">
      </td>
    </tr>
  </table>

  <table id="bz_big_form_parts">
  <tr>
  <td>

    
<script type="text/javascript">
<!--
function toggle_display(link) {
    var table = document.getElementById("attachment_table");
    var view_all = document.getElementById("view_all");
    var hide_obsolete_url_parameter = "&hide_obsolete=1";
    // Store current height for scrolling later
    var originalHeight = table.offsetHeight;
    var rows = YAHOO.util.Dom.getElementsByClassName(
        'bz_tr_obsolete', 'tr', table);

    for (var i = 0; i < rows.length; i++) {
        bz_toggleClass(rows[i], 'bz_default_hidden');
    }

    if (YAHOO.util.Dom.hasClass(rows[0], 'bz_default_hidden')) {
        link.innerHTML = "Show Obsolete";
        view_all.href = view_all.href + hide_obsolete_url_parameter 
    }
    else {
        link.innerHTML = "Hide Obsolete";
        view_all.href = view_all.href.replace(hide_obsolete_url_parameter,"");
    }

    var newHeight = table.offsetHeight;
    // This scrolling makes the window appear to not move at all.
    window.scrollBy(0, newHeight - originalHeight);

    return false;
}
//-->
</script>

<br>
<table id="attachment_table">
  <tr id="a0">
    <th colspan="3" class="left">
      Attachments
    </th>
  </tr>


      <tr id="a1" class="bz_contenttype_image_png">
        <td>
            <a href="attachment.cgi?id=271760"
               title="View the content of the attachment">
          <b>Screenshot of Word document showing the effect</b></a>

          <span class="bz_attach_extra_info">
              (152.86 KB,
                image/png)

            <br>
            <a href="#attach_271760"
               title="Go to the comment associated with the attachment">2017-12-04 10:26 EST</a>,

            <span class="vcard"><span class="fn">Thomas Wolf</span> <a href="http://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=thomas.wolf&#64;paranor.ch" alt="CLA" title="Eclipse Contributor Agreement" /></a> <a href="https://eclipse.org/donate/"><img class="cla_dec" src="//www.eclipse.org/donate/web-api/friends_decorator.php?email=thomas.wolf&#64;paranor.ch" alt="Friend" title="Friend of Eclipse" /></a>
</span>
          </span>
        </td>

          <td class="bz_attach_flags">
              <i>no flags</i>
          </td>

        <td>
          <a href="attachment.cgi?id=271760&amp;action=edit">Details</a>
        </td>
      </tr>

  <tr class="bz_attach_footer">
    <td colspan="3">
        <span class="bz_attach_view_hide">
            <a id="view_all" href="attachment.cgi?bugid=86503&amp;action=viewall">View All</a>
        </span>
        <a href="attachment.cgi?bugid=86503&amp;action=enter">Add an attachment</a>
        (proposed patch, testcase, etc.)
    </td>
  </tr>
</table>
<br>
<div id="add_comment" class="bz_section_additional_comments">
      <table>
        <tr>
          <td>
            <fieldset>
              <legend>Note</legend>
              You need to
              <a href="show_bug.cgi?id=86503&amp;GoAheadAndLogIn=1">log in</a>
              before you can comment on or make changes to this bug.
            </fieldset>
          </td>
        </tr> 
      </table>
  </div>
  </td>
  <td>
  </td>
  </tr></table>

  
  <div id="comments"><script src="https://bugs.eclipse.org/bugs/js/comments.js?1463425338" type="text/javascript">
</script>

<script type="text/javascript">
<!--
  /* Adds the reply text to the 'comment' textarea */
  function replyToComment(id, real_id, name) {
      var prefix = "(In reply to " + name + " from comment #" + id + ")\n";
      var replytext = "";
        /* pre id="comment_name_N" */
        var text_elem = document.getElementById('comment_text_'+id);
        var text = getText(text_elem);
        replytext = prefix + wrapReplyText(text);


      /* <textarea id="comment"> */
      var textarea = document.getElementById('comment');
      if (textarea.value != replytext) {
          textarea.value += replytext;
      }

      textarea.focus();
  } 
//-->
</script>


<!-- This auto-sizes the comments and positions the collapse/expand links 
     to the right. -->
<table class="bz_comment_table">
<tr>
<td>
<div id="c0" class="bz_comment bz_first_comment">

      <div class="bz_first_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=86503#c0">Description</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Konstantin Kolinko</span> <a href="http://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=Konstantin.Kolinko&#64;siemens.com" alt="CLA" title="Eclipse Contributor Agreement" /></a> <a href="https://eclipse.org/donate/"><img class="cla_dec" src="//www.eclipse.org/donate/web-api/friends_decorator.php?email=Konstantin.Kolinko&#64;siemens.com" alt="Friend" title="Friend of Eclipse" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2005-02-24 12:43:10 EST
        </span>

      </div>




<pre class="bz_comment_text">Ñopying a piece of text from a file edited in Eclipse to an external editor, 
adds blue background to the copied text.

Steps to reproduce:
--------------------
1. Start Eclipse
2. Open an external file for editing. It can be a plain text file, or an XML 
file. Not tested with other types.
3. Make sure that &quot;Highlight current line&quot; is turned on in the editor's 
properties.

4. Select a piece of text, like a single word. All the selected text must be 
on the same line.
5. Copy the text to the clipboard.

6. Start Windows Wordpad Editor.
7. Paste the copied text.
8. You will see that the pasted text will have light-blue background.

The background color in the same as used to &quot;Highlight current line&quot; in the 
editor.

9. Start Microsoft Word.
10. Paste the copied text, or choose &quot;Paste Special...&quot;, format: &quot;Formatted 
text (RTF)&quot;.
11. You will see that the pasted text will have dark-blue background. I do not 
know, why.

Evaluation
-----------

The problems seems to be related to the option &quot;Highlight current line&quot;.

The bug does not reproduce if this option is turned off, or if you select 
several lines of text.

Environment
------------
Eclipse versions: 3.1M4, 3.1M5a
Windows XP SP2
Microsoft Office Word 2003 SP1 (11.6359.6400)

Workaround
------------
Turn off &quot;Highlight current line&quot; in the options of the editor.</pre>
    </div>

    <div id="c1" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=86503#c1">Comment 1</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Dani Megert</span> <a href="http://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=daniel_megert&#64;ch.ibm.com" alt="CLA" title="Eclipse Contributor Agreement" /></a> <a href="https://eclipse.org/donate/"><img class="cla_dec" src="//www.eclipse.org/donate/web-api/friends_decorator.php?email=daniel_megert&#64;ch.ibm.com" alt="Friend" title="Friend of Eclipse" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2006-08-22 04:44:49 EDT
        </span>

      </div>




<pre class="bz_comment_text">Can be reproduced using R3.2 and 3.3 M1.</pre>
    </div>

    <div id="c2" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=86503#c2">Comment 2</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Dani Megert</span> <a href="http://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=daniel_megert&#64;ch.ibm.com" alt="CLA" title="Eclipse Contributor Agreement" /></a> <a href="https://eclipse.org/donate/"><img class="cla_dec" src="//www.eclipse.org/donate/web-api/friends_decorator.php?email=daniel_megert&#64;ch.ibm.com" alt="Friend" title="Friend of Eclipse" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2006-10-18 03:37:46 EDT
        </span>

      </div>




<pre class="bz_comment_text">*** <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - Copying a single line from text editor to Outlook results in blue background"
   href="show_bug.cgi?id=160915">Bug 160915</a> has been marked as a duplicate of this bug. ***</pre>
    </div>

    <div id="c3" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=86503#c3">Comment 3</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Dani Megert</span> <a href="http://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=daniel_megert&#64;ch.ibm.com" alt="CLA" title="Eclipse Contributor Agreement" /></a> <a href="https://eclipse.org/donate/"><img class="cla_dec" src="//www.eclipse.org/donate/web-api/friends_decorator.php?email=daniel_megert&#64;ch.ibm.com" alt="Friend" title="Friend of Eclipse" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2008-04-17 12:35:18 EDT
        </span>

      </div>




<pre class="bz_comment_text">*** <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - Copy / paste to MS word keeps selection background after paste"
   href="show_bug.cgi?id=227560">Bug 227560</a> has been marked as a duplicate of this bug. ***</pre>
    </div>

    <div id="c4" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=86503#c4">Comment 4</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Dani Megert</span> <a href="http://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=daniel_megert&#64;ch.ibm.com" alt="CLA" title="Eclipse Contributor Agreement" /></a> <a href="https://eclipse.org/donate/"><img class="cla_dec" src="//www.eclipse.org/donate/web-api/friends_decorator.php?email=daniel_megert&#64;ch.ibm.com" alt="Friend" title="Friend of Eclipse" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2008-11-12 02:48:12 EST
        </span>

      </div>




<pre class="bz_comment_text">*** <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - [projection] Clipboard Copy &amp; Paste: Selection highlighting background is pasted"
   href="show_bug.cgi?id=254951">Bug 254951</a> has been marked as a duplicate of this bug. ***</pre>
    </div>

    <div id="c5" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=86503#c5">Comment 5</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Dani Megert</span> <a href="http://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=daniel_megert&#64;ch.ibm.com" alt="CLA" title="Eclipse Contributor Agreement" /></a> <a href="https://eclipse.org/donate/"><img class="cla_dec" src="//www.eclipse.org/donate/web-api/friends_decorator.php?email=daniel_megert&#64;ch.ibm.com" alt="Friend" title="Friend of Eclipse" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2008-11-12 06:16:50 EST
        </span>

      </div>




<pre class="bz_comment_text">In order to fix this we would need control over the copy operation, e.g. telling to ignore LineBackgroundListener. I filed <a class="bz_bug_link 
          bz_status_NEW "
   title="NEW - [StyledText] Allow to control StyledText's RTF copy"
   href="show_bug.cgi?id=255013">bug 255013</a> to request that.</pre>
    </div>

    <div id="c6" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=86503#c6">Comment 6</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Dani Megert</span> <a href="http://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=daniel_megert&#64;ch.ibm.com" alt="CLA" title="Eclipse Contributor Agreement" /></a> <a href="https://eclipse.org/donate/"><img class="cla_dec" src="//www.eclipse.org/donate/web-api/friends_decorator.php?email=daniel_megert&#64;ch.ibm.com" alt="Friend" title="Friend of Eclipse" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2009-07-08 02:22:58 EDT
        </span>

      </div>




<pre class="bz_comment_text">*** <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - [typing] text copied from a single line pastes with the wrong background color"
   href="show_bug.cgi?id=282727">Bug 282727</a> has been marked as a duplicate of this bug. ***</pre>
    </div>

    <div id="c7" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=86503#c7">Comment 7</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Dani Megert</span> <a href="http://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=daniel_megert&#64;ch.ibm.com" alt="CLA" title="Eclipse Contributor Agreement" /></a> <a href="https://eclipse.org/donate/"><img class="cla_dec" src="//www.eclipse.org/donate/web-api/friends_decorator.php?email=daniel_megert&#64;ch.ibm.com" alt="Friend" title="Friend of Eclipse" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2009-08-11 03:03:41 EDT
        </span>

      </div>




<pre class="bz_comment_text">*** <a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - Highlight text, Copy/Paste, pastes with wrong background color"
   href="show_bug.cgi?id=286166">Bug 286166</a> has been marked as a duplicate of this bug. ***</pre>
    </div>

    <div id="c8" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=86503#c8">Comment 8</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Dani Megert</span> <a href="http://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=daniel_megert&#64;ch.ibm.com" alt="CLA" title="Eclipse Contributor Agreement" /></a> <a href="https://eclipse.org/donate/"><img class="cla_dec" src="//www.eclipse.org/donate/web-api/friends_decorator.php?email=daniel_megert&#64;ch.ibm.com" alt="Friend" title="Friend of Eclipse" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2011-08-10 03:21:09 EDT
        </span>

      </div>




<pre class="bz_comment_text">*** <a class="bz_bug_link 
          bz_status_ASSIGNED "
   title="ASSIGNED - [misc] add option to disable styled-text when copy/paste clipboard"
   href="show_bug.cgi?id=45969">Bug 45969</a> has been marked as a duplicate of this bug. ***</pre>
    </div>

    <div id="c9" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=86503#c9">Comment 9</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Anton Leherbauer</span> <a href="http://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=aleherb+eclipse&#64;gmail.com" alt="CLA" title="Eclipse Contributor Agreement" /></a> <a href="https://eclipse.org/donate/"><img class="cla_dec" src="//www.eclipse.org/donate/web-api/friends_decorator.php?email=aleherb+eclipse&#64;gmail.com" alt="Friend" title="Friend of Eclipse" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2013-01-23 02:29:36 EST
        </span>

      </div>




<pre class="bz_comment_text">*** <a class="bz_bug_link 
          bz_status_CLOSED  bz_closed"
   title="CLOSED DUPLICATE - Copy line and paste to MS Word (or Word Pad) works strange: adds background color of selection"
   href="show_bug.cgi?id=398855">Bug 398855</a> has been marked as a duplicate of this bug. ***</pre>
    </div>

    <div id="c10" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=86503#c10">Comment 10</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Dani Megert</span> <a href="http://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=daniel_megert&#64;ch.ibm.com" alt="CLA" title="Eclipse Contributor Agreement" /></a> <a href="https://eclipse.org/donate/"><img class="cla_dec" src="//www.eclipse.org/donate/web-api/friends_decorator.php?email=daniel_megert&#64;ch.ibm.com" alt="Friend" title="Friend of Eclipse" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2015-07-21 08:49:58 EDT
        </span>

      </div>




<pre class="bz_comment_text">*** <a class="bz_bug_link 
          bz_status_CLOSED  bz_closed"
   title="CLOSED DUPLICATE - Single line copy copies unnecessary attributes"
   href="show_bug.cgi?id=471215">Bug 471215</a> has been marked as a duplicate of this bug. ***</pre>
    </div>

    <div id="c11" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=86503#c11">Comment 11</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Eclipse Genie</span> <a href="http://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=genie&#64;eclipse.org" alt="CLA" title="Eclipse Contributor Agreement" /></a> <a href="https://eclipse.org/donate/"><img class="cla_dec" src="//www.eclipse.org/donate/web-api/friends_decorator.php?email=genie&#64;eclipse.org" alt="Friend" title="Friend of Eclipse" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2016-05-19 04:12:57 EDT
        </span>

      </div>




<pre class="bz_comment_text">New Gerrit change created: <a href="https://git.eclipse.org/r/73129">https://git.eclipse.org/r/73129</a></pre>
    </div>

    <div id="c12" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=86503#c12">Comment 12</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Tobias Melcher</span> <a href="http://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=tobias.melcher&#64;sap.com" alt="CLA" title="Eclipse Contributor Agreement" /></a> <a href="https://eclipse.org/donate/"><img class="cla_dec" src="//www.eclipse.org/donate/web-api/friends_decorator.php?email=tobias.melcher&#64;sap.com" alt="Friend" title="Friend of Eclipse" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2016-05-19 04:23:08 EDT
        </span>

      </div>




<pre class="bz_comment_text">Problem occurs when you copy exactly one line without a line break. StyledText.RTFWriter#writeLine calls

event = getLineBackgroundData(lineOffset, line);
if (event != null &amp;&amp; event.lineBackground != null) 
   lineBackground = event.lineBackground;

org.eclipse.jface.text.CursorLinePainter#lineGetBackground is called as listener of ST.LineGetBackground event which then sets event.lineBackground via following code:

if (event.lineOffset &lt;= caret &amp;&amp; caret &lt;= event.lineOffset + length &amp;&amp; !hasMultiLineSelection(textWidget))
	event.lineBackground= fHighlightColor;

With <a href="https://git.eclipse.org/r/#/c/73129/">https://git.eclipse.org/r/#/c/73129/</a> , I propose to delete the getLineBackgroundData call in RTFWriter#writeLine. The problem reported in this bug then disappears. 
Is this getLineBackgroundData needed in RTFWriter? If yes, could you please give an example for which scenario this is needed?

Thanks and best regards,
Tobias</pre>
    </div>

    <div id="c13" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=86503#c13">Comment 13</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Dani Megert</span> <a href="http://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=daniel_megert&#64;ch.ibm.com" alt="CLA" title="Eclipse Contributor Agreement" /></a> <a href="https://eclipse.org/donate/"><img class="cla_dec" src="//www.eclipse.org/donate/web-api/friends_decorator.php?email=daniel_megert&#64;ch.ibm.com" alt="Friend" title="Friend of Eclipse" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2016-05-19 05:20:55 EDT
        </span>

      </div>




<pre class="bz_comment_text">(In reply to Tobias Melcher from <a href="show_bug.cgi?id=86503#c12">comment #12</a>)
<span class="quote">&gt; Problem occurs when you copy exactly one line without a line break.
&gt; StyledText.RTFWriter#writeLine calls
&gt; 
&gt; event = getLineBackgroundData(lineOffset, line);
&gt; if (event != null &amp;&amp; event.lineBackground != null) 
&gt;    lineBackground = event.lineBackground;
&gt; 
&gt; org.eclipse.jface.text.CursorLinePainter#lineGetBackground is called as
&gt; listener of ST.LineGetBackground event which then sets event.lineBackground
&gt; via following code:
&gt; 
&gt; if (event.lineOffset &lt;= caret &amp;&amp; caret &lt;= event.lineOffset + length &amp;&amp;
&gt; !hasMultiLineSelection(textWidget))
&gt; 	event.lineBackground= fHighlightColor;
&gt; 
&gt; With <a href="https://git.eclipse.org/r/#/c/73129/">https://git.eclipse.org/r/#/c/73129/</a> , I propose to delete the
&gt; getLineBackgroundData call in RTFWriter#writeLine. The problem reported in
&gt; this bug then disappears. 
&gt; Is this getLineBackgroundData needed in RTFWriter? If yes, could you please
&gt; give an example for which scenario this is needed?
&gt; 
&gt; Thanks and best regards,
&gt; Tobias</span >

This would be a change request for SWT. They have to review it and make sure RTF copying is not affected. I suggest to file a separate bug against SWT.</pre>
    </div>

    <div id="c14" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=86503#c14">Comment 14</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Gunnar Wagenknecht</span> <a href="http://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=gunnar&#64;wagenknecht.org" alt="CLA" title="Eclipse Contributor Agreement" /></a> <a href="https://eclipse.org/donate/"><img class="cla_dec" src="//www.eclipse.org/donate/web-api/friends_decorator.php?email=gunnar&#64;wagenknecht.org" alt="Friend" title="Friend of Eclipse" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2016-10-29 16:07:33 EDT
        </span>

      </div>




<pre class="bz_comment_text">I think it's arguable whether copying the highlight background color is wanted or not. There might be users liking that feature, especially when pasting multiple lines with that one specifically highlighted. Personally, I would copy as screenshot, though.

I also think that users not wanting any formatting while pasting are used to &quot;paste as text&quot; functionality offered these days in all modern editors.

However, I am concerned that the proposed changed removes background color copying altogether, i.e. disabling a feature users might use. I'm not sure this is something we should do, given that there is are workaround (such as &quot;paste as text&quot;).</pre>
    </div>

    <div id="c15" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=86503#c15">Comment 15</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Tobias Melcher</span> <a href="http://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=tobias.melcher&#64;sap.com" alt="CLA" title="Eclipse Contributor Agreement" /></a> <a href="https://eclipse.org/donate/"><img class="cla_dec" src="//www.eclipse.org/donate/web-api/friends_decorator.php?email=tobias.melcher&#64;sap.com" alt="Friend" title="Friend of Eclipse" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2016-10-30 10:17:29 EDT
        </span>

      </div>




<pre class="bz_comment_text">(In reply to Gunnar Wagenknecht from <a href="show_bug.cgi?id=86503#c14">comment #14</a>)
<span class="quote">&gt; I think it's arguable whether copying the highlight background color is
&gt; wanted or not. There might be users liking that feature, especially when
&gt; pasting multiple lines with that one specifically highlighted. Personally, I
&gt; would copy as screenshot, though.
&gt; 
&gt; I also think that users not wanting any formatting while pasting are used to
&gt; &quot;paste as text&quot; functionality offered these days in all modern editors.
&gt; 
&gt; However, I am concerned that the proposed changed removes background color
&gt; copying altogether, i.e. disabling a feature users might use. I'm not sure
&gt; this is something we should do, given that there is are workaround (such as
&gt; &quot;paste as text&quot;).</span >

I agree, removing the background color completely is not the right way.
From my point of view, the current behavior is not acceptable. Copy and paste a single line without a line break is inserting the blue background selection color in RTF. The blue background is not inserted when multiple lines including a line break are copied. This behavior is inconsistent.
So, therefore I vote, that the blue background selection color is not added when pasting a single line.</pre>
    </div>

    <div id="c16" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=86503#c16">Comment 16</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Thomas Wolf</span> <a href="http://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=thomas.wolf&#64;paranor.ch" alt="CLA" title="Eclipse Contributor Agreement" /></a> <a href="https://eclipse.org/donate/"><img class="cla_dec" src="//www.eclipse.org/donate/web-api/friends_decorator.php?email=thomas.wolf&#64;paranor.ch" alt="Friend" title="Friend of Eclipse" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2017-12-01 09:20:47 EST
        </span>

      </div>




<pre class="bz_comment_text">(In reply to Tobias Melcher from <a href="show_bug.cgi?id=86503#c15">comment #15</a>)
<span class="quote">&gt; (In reply to Gunnar Wagenknecht from <a href="show_bug.cgi?id=86503#c14">comment #14</a>)
&gt; &gt; I think it's arguable whether copying the highlight background color is
&gt; &gt; wanted or not. There might be users liking that feature, especially when
&gt; &gt; pasting multiple lines with that one specifically highlighted. Personally, I
&gt; &gt; would copy as screenshot, though.
&gt; &gt; 
&gt; &gt; I also think that users not wanting any formatting while pasting are used to
&gt; &gt; &quot;paste as text&quot; functionality offered these days in all modern editors.
&gt; &gt; 
&gt; &gt; However, I am concerned that the proposed changed removes background color
&gt; &gt; copying altogether, i.e. disabling a feature users might use. I'm not sure
&gt; &gt; this is something we should do, given that there is are workaround (such as
&gt; &gt; &quot;paste as text&quot;).
&gt; 
&gt; I agree, removing the background color completely is not the right way.
&gt; From my point of view, the current behavior is not acceptable. Copy and
&gt; paste a single line without a line break is inserting the blue background
&gt; selection color in RTF. The blue background is not inserted when multiple
&gt; lines including a line break are copied. This behavior is inconsistent.
&gt; So, therefore I vote, that the blue background selection color is not added
&gt; when pasting a single line.</span >

Wait a sec. Select some text (multiple lines) in a diff shown by Egit, including some removed and added lines. For instance, in the history view, bottom-left panel, or in the commit viewer, diff page. EGit shows removed lines with a red-ish background, and add lines with a green-ish background. Now paste into Word. On my Mac (with an old Word-for-Mac-2011) I get the red and green backgrounds copied nicely (though Word displays a different shade of red and green: fully saturated). It seems to me that with your change, I wouldn't get these backgrounds anymore. (They are added through the same mechanism as the &quot;current line background&quot;.)

The blue color is not added when you select multiple lines because that blue you see in Eclipse is the selection highlight, not the &quot;current line background&quot;. When you select multiple lines, there is no &quot;current line&quot; and consequently no current line background anywhere.

You do get the blue background when you select only part of the line because as long as start and end of the selection are on the same line, there is a &quot;current&quot; line, and it thus has the &quot;current line background&quot;.</pre>
    </div>

    <div id="c17" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=86503#c17">Comment 17</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Tobias Melcher</span> <a href="http://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=tobias.melcher&#64;sap.com" alt="CLA" title="Eclipse Contributor Agreement" /></a> <a href="https://eclipse.org/donate/"><img class="cla_dec" src="//www.eclipse.org/donate/web-api/friends_decorator.php?email=tobias.melcher&#64;sap.com" alt="Friend" title="Friend of Eclipse" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2017-12-01 12:17:32 EST
        </span>

      </div>




<pre class="bz_comment_text">Agreed. I propose to disable the logic of CursorLinePainter when copy to RTF logic is executed. We then still have the EGit background colors, but not the annoying blue background color.
Unfortunately, this now gets quite ugly because StyledText (as part of SWT plugin) doesn't know anything about CursorLinePainter because it is part of jface.text.</pre>
    </div>

    <div id="c18" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=86503#c18">Comment 18</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Tobias Melcher</span> <a href="http://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=tobias.melcher&#64;sap.com" alt="CLA" title="Eclipse Contributor Agreement" /></a> <a href="https://eclipse.org/donate/"><img class="cla_dec" src="//www.eclipse.org/donate/web-api/friends_decorator.php?email=tobias.melcher&#64;sap.com" alt="Friend" title="Friend of Eclipse" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2017-12-01 12:22:57 EST
        </span>

      </div>




<pre class="bz_comment_text">(In reply to Gunnar Wagenknecht from <a href="show_bug.cgi?id=86503#c14">comment #14</a>)
<span class="quote">&gt; I think it's arguable whether copying the highlight background color is
&gt; wanted or not. There might be users liking that feature, especially when
&gt; pasting multiple lines with that one specifically highlighted. Personally, I
&gt; would copy as screenshot, though.</span >

If you paste multiple selected lines today, now background color is pasted. There then no one specifically highlighted line :-)</pre>
    </div>

    <div id="c19" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=86503#c19">Comment 19</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Thomas Wolf</span> <a href="http://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=thomas.wolf&#64;paranor.ch" alt="CLA" title="Eclipse Contributor Agreement" /></a> <a href="https://eclipse.org/donate/"><img class="cla_dec" src="//www.eclipse.org/donate/web-api/friends_decorator.php?email=thomas.wolf&#64;paranor.ch" alt="Friend" title="Friend of Eclipse" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2017-12-01 12:48:19 EST
        </span>

      </div>




<pre class="bz_comment_text">(In reply to Tobias Melcher from <a href="show_bug.cgi?id=86503#c18">comment #18</a>)
<span class="quote">&gt; (In reply to Gunnar Wagenknecht from <a href="show_bug.cgi?id=86503#c14">comment #14</a>)
&gt; &gt; I think it's arguable whether copying the highlight background color is
&gt; &gt; wanted or not. There might be users liking that feature, especially when
&gt; &gt; pasting multiple lines with that one specifically highlighted. Personally, I
&gt; &gt; would copy as screenshot, though.
&gt; 
&gt; If you paste multiple selected lines today, now background color is pasted.
&gt; There then no one specifically highlighted line :-)</span >

That's not true. See the EGit example in <a href="show_bug.cgi?id=86503#c16">comment 16</a>. It's just that the CurrentLinePainter only adds the blue &quot;current line background&quot; if the selection is wholly on one line. If the viewer adds other backgrounds, they _are_copied, also when you select multiple lines.

One could avoid having the current line background being pasted by changing the behavior of the CurrentLinePainter: it could highlight the current line only if selection_start == selection_end. When there is a selection, the selection is marked anyway, and the user knows where it is. By contrast, when there's only a caret position, the caret may be hard to see and a &quot;current line background&quot; helps.

Since one does have to select something to copy-paste, this would avoid the blue background on RTF paste, as for multi-line selections, but still give all other backgrounds a viewer might use.

As for Word using saturated colors: RTF has only RGB color support, so if an Eclipse background uses RGBA, it should be converted to RGB (blend with viewer background).</pre>
    </div>

    <div id="c20" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=86503#c20">Comment 20</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Eclipse Genie</span> <a href="http://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=genie&#64;eclipse.org" alt="CLA" title="Eclipse Contributor Agreement" /></a> <a href="https://eclipse.org/donate/"><img class="cla_dec" src="//www.eclipse.org/donate/web-api/friends_decorator.php?email=genie&#64;eclipse.org" alt="Friend" title="Friend of Eclipse" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2017-12-01 13:16:32 EST
        </span>

      </div>




<pre class="bz_comment_text">New Gerrit change created: <a href="https://git.eclipse.org/r/112728">https://git.eclipse.org/r/112728</a></pre>
    </div>

    <div id="c21" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=86503#c21">Comment 21</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Tobias Melcher</span> <a href="http://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=tobias.melcher&#64;sap.com" alt="CLA" title="Eclipse Contributor Agreement" /></a> <a href="https://eclipse.org/donate/"><img class="cla_dec" src="//www.eclipse.org/donate/web-api/friends_decorator.php?email=tobias.melcher&#64;sap.com" alt="Friend" title="Friend of Eclipse" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2017-12-01 13:20:28 EST
        </span>

      </div>




<pre class="bz_comment_text">Could you please review change 112728? CursorLinePainter is now disabled during copy to clipboard run. Will this be fine?</pre>
    </div>

    <div id="c22" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=86503#c22">Comment 22</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Tobias Melcher</span> <a href="http://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=tobias.melcher&#64;sap.com" alt="CLA" title="Eclipse Contributor Agreement" /></a> <a href="https://eclipse.org/donate/"><img class="cla_dec" src="//www.eclipse.org/donate/web-api/friends_decorator.php?email=tobias.melcher&#64;sap.com" alt="Friend" title="Friend of Eclipse" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2017-12-02 17:42:54 EST
        </span>

      </div>




<pre class="bz_comment_text">StyledText#RTFWriter is using \\highlight to specify background color.
Based on
<a href="http://www.biblioscape.com/rtf15_spec.htm#Heading45">http://www.biblioscape.com/rtf15_spec.htm#Heading45</a>
the highlight background colors are predefined and cannot be configured. 

So, using \\highlight is not a good idea. \cb should be better used. 
But based on <a href="https://stackoverflow.com/questions/3513758/how-can-i-change-the-background-color-of-specific-characters-in-a-rtf-document">https://stackoverflow.com/questions/3513758/how-can-i-change-the-background-color-of-specific-characters-in-a-rtf-document</a>, \cb is not implemented by Microsoft, one should use \chshdng0\chcbpatN instead.

I locally modified RTFWriter#writeStyledLine (see code below) and replaced \\highlight with \chshdng0\chcbpatN and problem is now really solved without the need to disable CursorLinePainter.

Could someone please take over the code and push it to gerrit? Setting up a locally buildable and testable SWT plugin project is too complex for me. Thanks.

	void writeStyledLine(String line, int lineOffset, int ranges[], StyleRange[] styles, Color lineBackground, int indent, int alignment, boolean justify) {
		int lineLength = line.length();
		int startOffset = getStart();
		int writeOffset = startOffset - lineOffset;
		if (writeOffset &gt;= lineLength) return;
		int lineIndex = Math.max(0, writeOffset);

		write(&quot;\\fi&quot;);
		write(indent);
		switch (alignment) {
			case SWT.LEFT: write(&quot;\\ql&quot;); break;
			case SWT.CENTER: write(&quot;\\qc&quot;); break;
			case SWT.RIGHT: write(&quot;\\qr&quot;); break;
		}
		if (justify) write(&quot;\\qj&quot;);
		write(&quot; &quot;);

		int endOffset = startOffset + super.getCharCount();
		int lineEndOffset = Math.min(lineLength, endOffset - lineOffset);
		for (int i = 0; i &lt; styles.length; i++) {
			StyleRange style = styles[i];
			int start, end;
			if (ranges != null) {
				start = ranges[i &lt;&lt; 1] - lineOffset;
				end = start + ranges[(i &lt;&lt; 1) + 1];
			} else {
				start = style.start - lineOffset;
				end = start + style.length;
			}
			// skip over partial first line
			if (end &lt; writeOffset) {
				continue;
			}
			// style starts beyond line end or RTF write end
			if (start &gt;= lineEndOffset) {
				break;
			}
			// write any unstyled text
			if (lineIndex &lt; start) {
				// copy to start of style
				// style starting beyond end of write range or end of line
				// is guarded against above.
				write(line, lineIndex, start);
				lineIndex = start;
			}
			// write styled text
			write(&quot;{&quot;);
			int colorIndex = getColorIndex(style.background, DEFAULT_BACKGROUND);
			if (colorIndex != DEFAULT_BACKGROUND) {
				write(&quot;\\chshdng0\\chcbpat&quot;);
				write(colorIndex);
			}else {
				if (lineBackground != null) {
					write(&quot;\\cb&quot;);
					write(&quot;\\chshdng0\\chcbpat&quot;);
					write(getColorIndex(lineBackground, DEFAULT_BACKGROUND));
					//write(&quot; &quot;);
				}
			}
			write(&quot;\\cf&quot;);
			write(getColorIndex(style.foreground, DEFAULT_FOREGROUND));
			
			int fontStyle = style.fontStyle;
			Font font = style.font;
			if (font != null) {
				int fontIndex = getFontIndex(font);
				write(&quot;\\f&quot;);
				write(fontIndex);
				FontData fontData = font.getFontData()[0];
				write(&quot;\\fs&quot;);
				write(fontData.getHeight() * 2);
				fontStyle = fontData.getStyle();
			}
			if ((fontStyle &amp; SWT.BOLD) != 0) {
				write(&quot;\\b&quot;);
			}
			if ((fontStyle &amp; SWT.ITALIC) != 0) {
				write(&quot;\\i&quot;);
			}
			if (style.underline) {
				write(&quot;\\ul&quot;);
			}
			if (style.strikeout) {
				write(&quot;\\strike&quot;);
			}
			write(&quot; &quot;);
			// copy to end of style or end of write range or end of line
			int copyEnd = Math.min(end, lineEndOffset);
			// guard against invalid styles and let style processing continue
			copyEnd = Math.max(copyEnd, lineIndex);
			write(line, lineIndex, copyEnd);
			if ((fontStyle &amp; SWT.BOLD) != 0) {
				write(&quot;\\b0&quot;);
			}
			if ((style.fontStyle &amp; SWT.ITALIC) != 0) {
				write(&quot;\\i0&quot;);
			}
			if (style.underline) {
				write(&quot;\\ul0&quot;);
			}
			if (style.strikeout) {
				write(&quot;\\strike0&quot;);
			}
			write(&quot;}&quot;);
			lineIndex = copyEnd;
		}
		// write unstyled text at the end of the line
		if (lineIndex &lt; lineEndOffset) {
			write(line, lineIndex, lineEndOffset);
		}
	}</pre>
    </div>

    <div id="c23" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=86503#c23">Comment 23</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Thomas Wolf</span> <a href="http://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=thomas.wolf&#64;paranor.ch" alt="CLA" title="Eclipse Contributor Agreement" /></a> <a href="https://eclipse.org/donate/"><img class="cla_dec" src="//www.eclipse.org/donate/web-api/friends_decorator.php?email=thomas.wolf&#64;paranor.ch" alt="Friend" title="Friend of Eclipse" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2017-12-03 05:00:25 EST
        </span>

      </div>




<pre class="bz_comment_text">You may be onto something here.

The latest RTF specification I was able to find is 1.9.1 (Word 2007).[1] I have not found any change history for the RTF specification.

The 1.9.1 spec indicates in Appendix B when which control words were introduced:

\highlight   Word 95
\chcbpat     Word 97

\chshdng is missing from the list completely, although it's mentioned elsewhere in the document. And indeed they say to use \cshdng0\chcbpatN instead of \cbN.

And while the RTF 1.5 spec says that \highlightN accepts only pre-defined colors (1 &lt;= N &lt;= 16); the 1.9.1 spec doesn't say so anymore.

However, that explains why I even sometimes got a *yellow* background in windows instead of the &quot;current line background&quot; when pasting into Word-for-Mac-2011. So that seems still to be the case. Would also explain why the highlight colors are  fully saturated. (I was wrong about the RGBA guess above.)

But with your code I don't understand two things:

1. Why move the default line background into the loop?
2. Why write a \cb (even without color index!) for the default line background?

[1] <a href="https://www.microsoft.com/en-us/download/details.aspx?id=10725">https://www.microsoft.com/en-us/download/details.aspx?id=10725</a></pre>
    </div>

    <div id="c24" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=86503#c24">Comment 24</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Thomas Wolf</span> <a href="http://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=thomas.wolf&#64;paranor.ch" alt="CLA" title="Eclipse Contributor Agreement" /></a> <a href="https://eclipse.org/donate/"><img class="cla_dec" src="//www.eclipse.org/donate/web-api/friends_decorator.php?email=thomas.wolf&#64;paranor.ch" alt="Friend" title="Friend of Eclipse" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2017-12-03 09:15:54 EST
        </span>

      </div>




<pre class="bz_comment_text">(In reply to Thomas Wolf from <a href="show_bug.cgi?id=86503#c23">comment #23</a>)
<span class="quote">&gt; \chshdng is missing from the list completely</span >

Found it; looked in the wrong place. Also introduced in Word 97.

<span class="quote">&gt; However, that explains why I even sometimes got a *yellow* background in
&gt; windows instead of the &quot;current line background&quot;</span >

s/windows/Word/</pre>
    </div>

    <div id="c25" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=86503#c25">Comment 25</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Eclipse Genie</span> <a href="http://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=genie&#64;eclipse.org" alt="CLA" title="Eclipse Contributor Agreement" /></a> <a href="https://eclipse.org/donate/"><img class="cla_dec" src="//www.eclipse.org/donate/web-api/friends_decorator.php?email=genie&#64;eclipse.org" alt="Friend" title="Friend of Eclipse" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2017-12-04 04:59:57 EST
        </span>

      </div>




<pre class="bz_comment_text">New Gerrit change created: <a href="https://git.eclipse.org/r/112799">https://git.eclipse.org/r/112799</a></pre>
    </div>

    <div id="c26" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=86503#c26">Comment 26</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Tobias Melcher</span> <a href="http://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=tobias.melcher&#64;sap.com" alt="CLA" title="Eclipse Contributor Agreement" /></a> <a href="https://eclipse.org/donate/"><img class="cla_dec" src="//www.eclipse.org/donate/web-api/friends_decorator.php?email=tobias.melcher&#64;sap.com" alt="Friend" title="Friend of Eclipse" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2017-12-04 05:07:43 EST
        </span>

      </div>




<pre class="bz_comment_text">(In reply to Thomas Wolf from <a href="show_bug.cgi?id=86503#c23">comment #23</a>)
<span class="quote">&gt; But with your code I don't understand two things:
&gt; 
&gt; 1. Why move the default line background into the loop?
&gt; 2. Why write a \cb (even without color index!) for the default line
&gt; background?</span >
I first tried to replace \highlight with \cb and it was not working. There I moved it into the loop; but with no effect. Take a look at <a href="https://git.eclipse.org/r/#/c/112799/">https://git.eclipse.org/r/#/c/112799/</a> which replaces \highlight with \chshdng0\chcbpat. This should be now clean.</pre>
    </div>

    <div id="c27" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=86503#c27">Comment 27</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Thomas Wolf</span> <a href="http://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=thomas.wolf&#64;paranor.ch" alt="CLA" title="Eclipse Contributor Agreement" /></a> <a href="https://eclipse.org/donate/"><img class="cla_dec" src="//www.eclipse.org/donate/web-api/friends_decorator.php?email=thomas.wolf&#64;paranor.ch" alt="Friend" title="Friend of Eclipse" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2017-12-04 06:23:04 EST
        </span>

      </div>




<pre class="bz_comment_text">Looks good to me. Fixes the wrong colors being shown in Word on copy-paste from Eclipse.

IMO this is good enough to consider this bug as fixed (once the change gets accepted). If a user really doesn't want the backgrounds, he can use &quot;paste plain text only&quot; like Gunnar had suggested. But at least he now gets the correct background colors.</pre>
    </div>

    <div id="c28" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=86503#c28">Comment 28</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Steffen Brüntjen</span> <a href="http://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=steffen&#64;kontraphon.de" alt="CLA" title="Eclipse Contributor Agreement" /></a> <a href="https://eclipse.org/donate/"><img class="cla_dec" src="//www.eclipse.org/donate/web-api/friends_decorator.php?email=steffen&#64;kontraphon.de" alt="Friend" title="Friend of Eclipse" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2017-12-04 06:47:00 EST
        </span>

      </div>




<pre class="bz_comment_text">(In reply to Thomas Wolf from <a href="show_bug.cgi?id=86503#c27">comment #27</a>)

<span class="quote">&gt; IMO this is good enough to consider this bug as fixed (once the change gets
&gt; accepted).</span >

Seriously? This bug is about blue background colors being added to the pasted text, and so are 6 out of 7 bug duplicates! I guess noone here really cares about color fine tuning. The only other duplicate which addresses a different problem (<a class="bz_bug_link 
          bz_status_RESOLVED  bz_closed"
   title="RESOLVED DUPLICATE - [projection] Clipboard Copy &amp; Paste: Selection highlighting background is pasted"
   href="show_bug.cgi?id=254951">Bug 254951</a>) is about colors from &quot;Mark occurences&quot;.</pre>
    </div>

    <div id="c29" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=86503#c29">Comment 29</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Thomas Wolf</span> <a href="http://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=thomas.wolf&#64;paranor.ch" alt="CLA" title="Eclipse Contributor Agreement" /></a> <a href="https://eclipse.org/donate/"><img class="cla_dec" src="//www.eclipse.org/donate/web-api/friends_decorator.php?email=thomas.wolf&#64;paranor.ch" alt="Friend" title="Friend of Eclipse" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2017-12-04 06:56:42 EST
        </span>

      </div>




<pre class="bz_comment_text">(In reply to Steffen Brüntjen from <a href="show_bug.cgi?id=86503#c28">comment #28</a>)
<span class="quote">&gt; 
&gt; Seriously?</span >

In my opinion: yes, seriously. If you set Eclipse to highlight the current line, the current line has a (normally light blue) background. Why in heaven's name should it not be copied, but other backgrounds should? (Note that many of the duplicates are about the selection color, but it's actually the current line highlighting, not the selection highlight. The selection highlight is not included in the RTF paste.)

If one really does want to exclude that current line highlight, maybe the approach from <a href="show_bug.cgi?id=86503#c19">comment 19</a> could be done. That would also remove the current highlight in Eclipse when there is a non-empty selection on a single line, and what is shown in Eclipse would still be consistent with what gets pasted into Word.

But asking for a paste result that is inconsistent with what Eclipse actually has IMO makes no sense at all.</pre>
    </div>

    <div id="c30" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=86503#c30">Comment 30</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Steffen Brüntjen</span> <a href="http://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=steffen&#64;kontraphon.de" alt="CLA" title="Eclipse Contributor Agreement" /></a> <a href="https://eclipse.org/donate/"><img class="cla_dec" src="//www.eclipse.org/donate/web-api/friends_decorator.php?email=steffen&#64;kontraphon.de" alt="Friend" title="Friend of Eclipse" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2017-12-04 09:19:27 EST
        </span>

      </div>




<pre class="bz_comment_text">Sorry, I didn't grasp that the color does not come from in-line text selection. I guess as soon as text is readable when pasted to Outlook, everyone will be very happy!</pre>
    </div>

    <div id="c31" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=86503#c31">Comment 31</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Thomas Wolf</span> <a href="http://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=thomas.wolf&#64;paranor.ch" alt="CLA" title="Eclipse Contributor Agreement" /></a> <a href="https://eclipse.org/donate/"><img class="cla_dec" src="//www.eclipse.org/donate/web-api/friends_decorator.php?email=thomas.wolf&#64;paranor.ch" alt="Friend" title="Friend of Eclipse" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2017-12-04 10:26:18 EST
        </span>

      </div>




<pre class="bz_comment_text">Created <span class=""><a href="attachment.cgi?id=271760" name="attach_271760" title="Screenshot of Word document showing the effect">attachment 271760</a> <a href="attachment.cgi?id=271760&amp;action=edit" title="Screenshot of Word document showing the effect">[details]</a></span>
Screenshot of Word document showing the effect

Just to clarify what this is about: screenshot of a Word (Word-for-Mac-2011) document showing a copy-paste from an EGit diff viewer in Eclipse before and after Tobias' fix.</pre>
    </div>

    <div id="c32" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=86503#c32">Comment 32</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Niraj Modi</span> <a href="http://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=niraj.modi&#64;in.ibm.com" alt="CLA" title="Eclipse Contributor Agreement" /></a> <a href="https://eclipse.org/donate/"><img class="cla_dec" src="//www.eclipse.org/donate/web-api/friends_decorator.php?email=niraj.modi&#64;in.ibm.com" alt="Friend" title="Friend of Eclipse" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2018-02-16 04:51:56 EST
        </span>

      </div>




<pre class="bz_comment_text">

*** This bug has been marked as a duplicate of <a class="bz_bug_link 
          bz_status_VERIFIED  bz_closed"
   title="VERIFIED FIXED - RTFWriter ignores background color"
   href="show_bug.cgi?id=529241">bug 529241</a> ***</pre>
    </div>

    <div id="c33" class="bz_comment">

      <div class="bz_comment_head">


        <span class="bz_comment_number">
          <a 
             href="show_bug.cgi?id=86503#c33">Comment 33</a>
        </span>

        <span class="bz_comment_user">
          <span class="vcard"><span class="fn">Steffen Brüntjen</span> <a href="http://wiki.eclipse.org/ECA"><img class="cla_dec" src="https://accounts.eclipse.org/user/eca/badge?mail=steffen&#64;kontraphon.de" alt="CLA" title="Eclipse Contributor Agreement" /></a> <a href="https://eclipse.org/donate/"><img class="cla_dec" src="//www.eclipse.org/donate/web-api/friends_decorator.php?email=steffen&#64;kontraphon.de" alt="Friend" title="Friend of Eclipse" /></a>
</span>
        </span>

        <span class="bz_comment_user_images">
        </span>

        <span class="bz_comment_time">
          2018-08-29 10:11:09 EDT
        </span>

      </div>




<pre class="bz_comment_text">Have there been some recent changes that now add a gray background color to parts of the pasted text? It looks like it's coming from 'mark occurrences' now :-(

It's even worse now since I can not remove the color in Outlook. I am able to set background to red or yellow, but when I choose &quot;no color&quot; (there's no entry &quot;white&quot;), it becomes gray again.

Anyone else with this problem?</pre>
    </div>


  

</td>
<td>
</td>
</tr></table>
  </div>
        

</form>

<hr>
<ul class="related_actions">
    <li><a href="show_bug.cgi?format=multiple&amp;id=86503">Format For Printing</a></li>
    <li>&nbsp;-&nbsp;<a href="show_bug.cgi?ctype=xml&amp;id=86503">XML</a></li>
    <li>&nbsp;-&nbsp;<a href="enter_bug.cgi?cloned_bug_id=86503">Clone This Bug</a></li>
    
    <li>&nbsp;-&nbsp;<a href="#">Top of page </a></li>
    </ul>

<br>
</div>

    <div id="footer">
      <div class="intro"></div>
<ul id="useful-links">
  <li id="links-actions"><ul class="links">
  <li><a href="./">Home</a></li>
  <li><span class="separator">| </span><a href="enter_bug.cgi">New</a></li>
  <li><span class="separator">| </span><a href="describecomponents.cgi">Browse</a></li>
  <li><span class="separator">| </span><a href="query.cgi">Search</a></li>

  <li class="form">
    <span class="separator">| </span>
    <form action="buglist.cgi" method="get"
        onsubmit="if (this.quicksearch.value == '')
                  { alert('Please enter one or more search terms first.');
                    return false; } return true;">
    <input type="hidden" id="no_redirect_bottom" name="no_redirect" value="0">
    <script type="text/javascript">
      if (history && history.replaceState) {
        var no_redirect = document.getElementById("no_redirect_bottom");
        no_redirect.value = 1;
      }
    </script>
    <input class="txt" type="text" id="quicksearch_bottom" name="quicksearch" 
           title="Quick Search" value="">
    <input class="btn" type="submit" value="Search" 
           id="find_bottom"></form>
  <a href="page.cgi?id=quicksearch.html" title="Quicksearch Help">[?]</a></li>

  <li><span class="separator">| </span><a href="report.cgi">Reports</a></li>

  <li>
      <span class="separator">| </span>
        <a href="request.cgi">Requests</a></li>


  <li>
        <span class="separator">| </span>
        <a href="https://bugzilla.readthedocs.org/en/5.0/using/understanding.html" target="_blank">Help</a>
      </li>
    

    <li id="mini_login_container_bottom">
  <span class="separator">| </span>
  <a id="login_link_bottom" href="show_bug.cgi?id=86503&amp;GoAheadAndLogIn=1"
     onclick="return show_mini_login_form('_bottom')">Log In</a>

  <form action="show_bug.cgi?id=86503" method="POST"
        class="mini_login bz_default_hidden"
        id="mini_login_bottom">
    <input id="Bugzilla_login_bottom" required
           name="Bugzilla_login" class="bz_login"
        placeholder="Login">
    <input class="bz_password" name="Bugzilla_password" type="password"
           id="Bugzilla_password_bottom" required
           placeholder="Password">
    <input type="hidden" name="Bugzilla_login_token"
           value="">
    <input type="submit" name="GoAheadAndLogIn" value="Log in"
            id="log_in_bottom">
    <a href="#" onclick="return hide_mini_login_form('_bottom')">[x]</a>
  </form>
</li>
  <span class="separator">| </span>
  <li><a href="http://www.eclipse.org/legal/termsofuse.php">Terms of Use</a></li>
  <span class="separator">| </span>
  <li><a href="http://www.eclipse.org/legal/copyright.php">Copyright Agent</a></li>
</ul>
  </li>

  




  
</ul>

      <div class="outro"></div>
    </div>

  </body>
</html>